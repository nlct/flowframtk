
\usepackage{fontspec}
\setmainfont{Linux Libertine O}
\usepackage{verbatim}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage[section]{placeins}
\usepackage{shapepar}
\usepackage{pgf}
\usepgflibrary{decorations.text}
\usepackage[outline,textpath]{flowframtkutils}

\PassOptionsToPackage{prefix}{glossaries-extra}
\usepackage
 [
    novref,
    fnsymleft,
%   debug=showwrgloss
 ]{texjavahelp}

\hypersetup{colorlinks,linkcolor=blue}

\renewcommand\TeXJavaHelpExtraAssignFields{
  description =[o] \TITLE { long } + ". " + description 
   [ entrytype->original = "abbreviation" ],
  category = "term"
   [ entrytype->original = "index" & description <> \NULL ],
}

\newcommand{\sharedimagesdir}{../sharedimages}
\newcommand{\tool}[1]{\gls{menu.tools.#1} tool}
\newcommand{\texttool}{\tool{textarea}}
\newcommand{\mathstool}{\tool{math}}
\newcommand{\textmode}{\glslink{menu.tools.textarea}{text mode}}
\newcommand{\mathsmode}{%
 \glslink{menu.tools.math}{\manmsg{maths} mode}%
 \glsadd{index.maths-mode}%
}
\newcommand{\selectmode}{\glslink{menu.tools.select}{select mode}}
\newcommand{\select}{\hyperref[sec:selectobjects]{select}}
\newcommand{\selects}{\hyperref[sec:selectobjects]{selects}}
\newcommand{\selected}{\hyperref[sec:selectobjects]{selected}}
\newcommand{\selection}{\hyperref[sec:selectobjects]{selection}}
\newcommand{\gridlock}{\hyperref[mi:gridlock]{grid lock}}
\newcommand{\editpathmode}{\hyperref[sec:editpath]{edit path mode}}
\newcommand{\textattr}[1]{\gls{index.text-attribute.#1}}
\newcommand{\textattrpl}[1]{\glspl{index.text-attribute.#1}}
\newcommand{\pathattr}[1]{\gls{index.path-attribute.#1}}
\newcommand{\pathattrpl}[1]{\glspl{index.path-attribute.#1}}
\newcommand{\affinetrans}[1]{\gls{affine-transformation.#1}}

\newcommand{\filefn}[1]{\menuitem{file.#1}}
\newcommand{\editfn}[1]{\menuitem{edit.#1}}
\newcommand{\transformfn}[1]{\menuitem{transform.#1}}

% Needs to be fairly simple for the HelpSet HTML files:
\newcommand{\degrees}[1]{#1\textdegree}

\newcommand{\pagestyleref}[1]{\opt{page-style.#1}}
\newcommand{\framelabelref}[1]{\opt{frame-label.#1}}
\newcommand{\setframeopt}[1]{\opt{settypeframe.#1}}
\newcommand{\setframeoptval}[2]{\optval{settypeframe.#1}{#2}}

\newcommand*{\radialcoords}[2]{$(#1:#2)$}
\newcommand*{\radiusmark}{\ensuremath{r}}
\newcommand*{\anglemark}{\ensuremath{\theta}}

\newcommand*{\typedef}[1]{\inlineglsdef{ajdr-format.#1}}
\newcommand*{\type}[1]{\gls{ajdr-format.#1}}
\newcommand*{\typepl}[1]{\glspl{ajdr-format.#1}}

\tjhnewtitledbox{versionbox}{JDR version}{teal}

\NewDocumentEnvironment{jdrversion}{m+b}%
{\begin{versionbox}[title={JDR #1}]#2\end{versionbox}}
{}

\NewDocumentEnvironment{syntaxline}{b}{\par\noindent#1\par\noindent}{\ignorespacesafterend}

\subtitle{\bigskip\includeimg{title}\bigskip}

\InputIfFileExists{version}{}{}

\GlsXtrLoadResources[src={flowframtk,shared,\langbibsrcs},
 \TeXJavaHelpSymbolResourceOptions
]

\GlsXtrLoadResources[src={flowframtk,shared,\langbibsrcs},
 \TeXJavaHelpGlsResourceOptions
]

\providecommand{\FlowframTk}{FlowframTk}

\title{User Manual for \FlowframTk}
\author{Nicola L.C. Talbot\\\href{https://www.dickimaw-books.com/}{\nolinkurl{dickimaw-books.com}}}

\begin{document}
\maketitle

\FlowframTk\ is licensed under the terms of the GNU General Public License
(\url{http://gnu.org/licenses/gpl.html"}).
See \sectionref{sec:licence}.

DOCUMENTATION IS PROVIDED \qt{AS IS} AND ALL EXPRESS OR IMPLIED
CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING ANY
IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
PURPOSE OR NON-INFRINGEMENT, ARE DISCLAIMED, EXCEPT TO THE EXTENT THAT
SUCH DISCLAIMERS ARE HELD TO BE LEGALLY INVALID.

This document is a user manual for \FlowframTk. For information about
JDRView or jdrutils, see \filefmt{jdrview.pdf} or
\filefmt{jdrutils.pdf}, respectively.

\IfTeXParserLib
  {%
    This manual is also available as a PDF document, \filefmt{flowframtk.pdf}. 
  }
  {}

The latest version of \FlowframTk\ can be downloaded from
\url{https://ctan.org/pkg/flowframtk}.
Older versions can be downloaded from
\url{http://www.dickimaw-books.com/software/flowframtk/}.
The source code is in the GitHub repository
\url{https://github.com/nlct/flowframtk}.

Occasionally the canvas doesn't get redrawn correctly. To force a
redraw, use \accelerator{menu.debug.revalidate}.

\frontmatter
\tableofcontents
%\listoffigures

\mainmatter
\chapter{Introduction}
\label{sec:introduction}

\FlowframTk\ (formerly \gls{JpgfDraw})
is a \gls{vectorgraphics} application written in \gls{Java}, with a 
\gls{gui}.  The main purpose of \FlowframTk\ is to generate \LaTeX\ packages or 
classes that use the \sty{flowfram} package, and to generate
\sty{pgf} picture drawing code. As a side-effect, it can also be
used to generate \gls{parshape} and (\sty{shapepar} package) \gls{shapepar} or 
\gls{Shapepar} specifications. In order to run the application you 
must have the \gls{jre} installed.

In \FlowframTk, you can:

\begin{itemize}
  \item construct shapes using line, move and cubic BÃ©zier segments
(\sectionref{sec:newobjects});

  \item edit paths by modifying the defining \glspl{controlpt}
  (\sectionref{sec:editpath});

  \item transforming paths with \glsxtrfull{cag} (\sectionref{sec:cag}).

  \item incorporate text (\sectionref{sec:newtext}) and 
  bitmap images (\sectionref{sec:insertbitmap})
  for annotating and background effects;

  \item combine text and a path to form a text-along-path
  effect (\sectionref{sec:textpath});

  \item apply replicas to a shape to form patterns
  (\sectionref{sec:patterns});

  \item extract the parameter's for \TeX's \gls{parshape} command and for 
  the \gls{shapepar} (or \gls{Shapepar}) command defined in the
  \sty{shapepar} package;

  \item construct frames for use with the \sty{flowfram} package
  (\sectionref{sec:flowframe}).
\end{itemize}

Pictures can be saved as (\sectionref{sec:saveimage}) or loaded
(\sectionref{sec:loadimage}) from \FlowframTk's native \gls{JDR}
(binary) or \gls{AJR} (ASCII) file formats. Additionally, images can be
exported (\sectionref{sec:exportimage}) as:

\begin{itemize}
    \item a \LaTeX\ file containing a \env{pgfpicture} environment
    for inclusion in a \LaTeX\ document;

    \item a single-paged complete \LaTeX\ document containing the image
    (either just encapsulating the image or with the page set to the
    same size as the \gls{canvas});

    \item a \LaTeX\ package or class that loads the \sty{flowfram} package;

    \item a PNG file;

    \item a PostScript file;

    \item \pgls{svg} file.
\end{itemize}

Note that the export to PS/PDF/\glsxtrshort{svg} functions use external
processes, such as \app{latex} and \app{dvips}.
\strong{You can't import back from the files you can export to.}

The low-level \sty{pgf} basic layer commands are used during
exports to \LaTeX\ files. These commands aren't particularly easy to
read but are faster to compile than the higher-level commands that
require extra processing to parse the syntax and perform additional
calculations. The primary purpose of \FlowframTk\ is to provide a
graphical interface that can generate complicated code that's hard
to write manually.

\FlowframTk\ was tested with version 3.0.0 of the \sty{pgf}
package, version 1.16 of the \sty{flowfram} package and version
2.2 of the \sty{shapepar} package. Files created by \FlowframTk\
may not work with earlier versions of those packages. Note that some
DVI viewers may not understand PGF specials. I strongly recommend
that you read the user manuals for those packages.


Notation: a \gls{primaryclick} is a single click with the
\gls{primary-mouse-button}. This is typically the left button for a
right-handed mouse (or left side of a trackpad), but may be the
right button for a left-handed mouse. A \gls{menuclick} is a click
with the \gls{context-menu} mouse button. This button depends on your
configuration, but is typically the right button for a right-handed
two-button mouse (and vice-versa for a left-handed two-button mouse). 
If the button isn't mentioned, a~\gls{click} can
be assumed to mean a~\gls{primaryclick}.

\chapter{Installation}
\label{sec:install}

Ensure that you have the \gls{jre} installed.
This can be downloaded from \url{http://java.sun.com/j2se/}.
You must ensure that you use at least Java~8, as \FlowframTk\
does not work with earlier versions.

To install, download the installer
\metafilefmt{flowframtk-}{appversion}{-installer.jar}
(where \meta{appversion} is the application version) and run it. 
This can be done from a terminal or command prompt using:

\begin{terminal}
java -jar flowframtk-\meta{appversion}-installer.jar
\end{terminal}

Depending on the setup of your operating system, you may also be
able to \gls{doubleclick} on the \ext{jar} file to run it.


\chapter{Accessibility}
\label{sec:access}

Most of \FlowframTk's mouse functions can be emulated using the
keyboard. Keyboard accelerators and
their menu mnemonic equivalents are listed in \tableref{tab:access}.

\begin{information}
Some functions will also try to move the pointer (such as
\menu{navigate.find}). This is done via the \emph{\gls{robot}}.
However note that some platforms or environments do not allow applications
to move the pointer, so keyboard functions that move the pointer are
not guaranteed to work on every system
\end{information}

Many of the accelerators may be changed using the \dialog{accelerators}
tab in the \dialog{configui} window (see
\sectionref{sec:configureuidialog}).  \accelerator{menubarfocus}
switches the focus to the menu bar. The return \keys{\keyref{return}}
key will usually be equivalent to the \widget{okay} button
except when the focus is with a component that interprets
\keys{\keyref{return}} for some other purpose (such as
a~\gls+{dropdown}), in which case you need to use \accelerator{okay}.

Within editable text fields, you can use \keys{\keyref{ctrl}+A} to
select all the text, or shift \keys{\keyref{shift}} followed by
the left \keys{\keyref{left}} or right \keys{\keyref{right}} arrow
key to select a portion of the text. If some of the text has been
selected, you can use \keys{\keyref{ctrl}+C} or
\keys{\keyref{ctrl}+X} to copy or cut the text onto the clipboard,
and you can use \keys{\keyref{ctrl}+V} to paste text from the
clipboard into the text field.

\begin{warning}
Note that a few of the accelerators previously used by \gls{JpgfDraw} have
been changed in \FlowframTk, as they caused a conflict. For example,
\keys{\keyref{escape}} cancels a displayed menu, so if you use it to
dismiss a menu while you had a \gls{path} under construction, the
entire path could be discarded, which is undesirable. Therefore the
abandon path accelerator is now \accelerator{tools.abandon}. The
\accelerator{help.manual} key is now only for the main manual help
button. The help buttons in dialog windows and the preamble editor
are activated with \accelerator{help} and the help button in the
status bar is activated with \accelerator{contexthelp} (otherwise
the main help button, preamble editor help button and status bar
help button would conflict).
\end{warning}

\seealsorefs{sec:configureuidialog,sec:selectobjects,sec:newobjects,sec:accesstutorial}

\begin{longtable}{lp{0.5\textwidth}p{0.2\textwidth}}
\caption{Keyboard Accelerators and Menu Mnemonics\label{tab:access}}\\
\bfseries Accelerator & \bfseries Function & \bfseries Mnemonic \\
\endfirsthead
\caption*{Keyboard Accelerators and Menu Mnemonics (Continued)}\\
\bfseries Accelerator & \bfseries Function & \bfseries Mnemonic \\
\endhead
\multicolumn{3}{l}{\fnsymtext{2}{Functions that move the pointer.}}\\\endfoot
\keys{\keyref{return}} (return) &
Finish current \gls{path}/\gls{textarea} & 
\mnemonictrail{tools.finish}\tabularnewline
& 
\emph{or} select \widget{okay} button in dialog boxes &
\mnemonic{okay}\tabularnewline
%
& 
\emph{or} select \widget{close} button in dialog boxes &
\mnemonic{close}\tabularnewline
%
\accelerator{okay} &
Select \widget{okay} button in dialog boxes &
\mnemonic{okay}\tabularnewline
%
\accelerator{tools.abandon} &
Abandon current \gls{path} &
\mnemonictrail{tools.abandon}\tabularnewline
%
\keys{\keyref{escape}} &
Select \widget{cancel} button in dialog boxes &
\mnemonic{cancel}\tabularnewline
%
 & 
\emph{or} close displayed menu &
\tabularnewline
%
\accelerator{editpath.delete_control} & 
Delete selected \gls{controlpt} &
\accelerator{popup} \mnemonic{editpath.delete_control}
\tabularnewline
%
\accelerator{delete_last} (backspace) &
Delete last segment (path construction mode) &
\tabularnewline
%
\keys{\keyref{insert}} &
Add \gls{controlpt} &
\accelerator{popup} \mnemonic{editpath.add_control}
\tabularnewline
&
\emph{or} display symbol dialog box &
\accelerator{popup} \mnemonic{textarea.insert_symbol}
\tabularnewline
%
\accelerator{focusnext} &
Move focus to next focusable component &
\tabularnewline
%
\accelerator{focusselect} (space) &
Select component with current focus &
\tabularnewline
\midrule
%
\keys{\keyref{pageup}} &
Scroll up by one screen full &
\tabularnewline
%
\keys{\keyref{pagedown}} &
Scroll down by one screen full &
\tabularnewline
%
\keys{\keyref{ctrl}+\keyref{pagedown}} &
If in a tabbed pane: &
\tabularnewline
&
\leftquadpar{Move to the next tab} &
\tabularnewline
&
Otherwise: &
\tabularnewline
&
\leftquadpar{Scroll right by one screen full} &
\tabularnewline
%
\keys{\keyref{ctrl}+\keyref{pageup}} &
If in a tabbed pane: &
\tabularnewline
&
\leftquadpar{Move to the previous tab} &
\tabularnewline
 &
 Otherwise: &
\tabularnewline
&
\leftquadpar{Scroll left by one screen full} &
\tabularnewline
%
Arrow Keys &
If \gls{primary-mouse-button} is pressed: &
\tabularnewline
 &
 \leftquadpar{\fnsym{2}Move mouse by one pixel in given direction} &
\tabularnewline
 &
Otherwise: &
\tabularnewline
 &
\leftquadpar{Scroll by one tick mark in given direction} &
\tabularnewline
%
\keys{\keyref{home}} &
Scroll to the top of the \gls{canvas} &
\tabularnewline
%
\keys{\keyref{end}} &
Scroll to the bottom of the \gls{canvas} &
\tabularnewline
%
\keys{\keyref{ctrl}+\keyref{home}} &
Scroll leftmost &
\tabularnewline
%
\keys{\keyref{ctrl}+\keyref{end}} &
Scroll rightmost &
\tabularnewline
\midrule
%
\accelerator{help.manual} &
Display Handbook &
\mnemonictrail{help.manual}
\tabularnewline
\accelerator{settings.grid.show} &
Show/hide \gls{grid} &
\mnemonictrail{settings.grid.show}
\tabularnewline
\accelerator{popup} &
Show \gls{context-menu} (if available) &
\tabularnewline
%
\accelerator{construct_click} &
Emulate \gls{primaryclick} in \gls{construction} &
\tabularnewline
%
\accelerator{navigate.goto} &
 \fnsym{2}Go to coordinate &
\mnemonictrail{navigate.goto}
\tabularnewline
%
\keys{\actualkey{F6}} &
Select mode: &
\tabularnewline
 &
 \leftquadpar{Deselect the \glsdisp{backobject}{backmost} selected 
  \gls{object}, and select next object in the \gls{stack}} &
\mnemonictrail{navigate.skip}
\tabularnewline
&
Edit mode: &
\tabularnewline
&
\leftquadpar{Select next \gls{controlpt}} &
\accelerator{popup} \mnemonic{editpath.next_control}
\tabularnewline
%
\keys{\actualkey{F7}} &
Select mode: &
\tabularnewline
 &
\leftquadpar{Move selected \gls{object}} &
\mnemonictrail{edit.moveby}
\tabularnewline
 &
 Edit mode: &
\tabularnewline
 &
\leftquadpar{Move selected \gls{controlpt}} &
\accelerator{popup} \mnemonic{editpath.coordinates}
\tabularnewline
%
\accelerator{edit.undo} &
Undo &
\mnemonictrail{edit.undo} \tabularnewline
%
\accelerator{edit.redo} &
Redo &
\mnemonictrail{edit.redo}
\tabularnewline
%
\accelerator{menubarfocus} &
Switch focus to menu bar &
\tabularnewline
%
\accelerator{menu.debug.revalidate} &
Repaint canvas &
\tabularnewline
%
\accelerator{contexthelp} &
Display current tool help (status bar help button) &
\tabularnewline
%
\accelerator{menu.debug.dumpall} &
Saves all images to the \gls{config_dir} &
\tabularnewline
%
\accelerator{help} &
Display subject help (help buttons in dialog windows or preamble
editor) &
\tabularnewline
\accelerator{settings.grid.lock} &
Lock/unlock grid &
\mnemonictrail{settings.grid.lock}
\tabularnewline
%
\accelerator{navigate.select} &
Select next \gls{object} in the \gls{stack} (from the
\gls{front}), and deselect all others &
\mnemonictrail{navigate.select} \tabularnewline
%
\keys{\actualkey{F6}} &
Select mode: &
\tabularnewline
&
\leftquadpar{Add next \gls{object} in the \gls{stack}
     (from the \gls{front}) to selection} &
\mnemonictrail{navigate.add_next}
\tabularnewline
 &
Edit mode: &
\tabularnewline
%
 &
\leftquadpar{Select previous \gls{controlpt}} &
\accelerator{popup} \mnemonic{editpath.prev_control}
\tabularnewline
%
\accelerator{navigate.find} &
\fnsym{2}Find selected \gls{object} &
\mnemonictrail{navigate.find}
\tabularnewline
%
\accelerator{menu.debug.objectinfo} &
Displays debugging information &
\tabularnewline
%
\accelerator{menu.debug.writelog} &
Writes log file in the \gls{config_dir} &
\tabularnewline
\accelerator{close_window} &
Quit &
\mnemonictrail{file.quit}
\tabularnewline
\midrule
%
\accelerator{edit.select_all} &
Select all \gls{object} &
\mnemonictrail{edit.select_all}
\tabularnewline
%
\accelerator{edit.back} &
Move selected \gls{object} to the \gls{back} &
\mnemonictrail{edit.back}
\tabularnewline
%
\accelerator{edit.copy} &
Copy selected \gls{object} to clipboard &
\mnemonictrail{edit.copy}
\tabularnewline
%
\accelerator{transform.convert} &
Convert outline to a \gls{path} &
\mnemonictrail{transform.convert}
\tabularnewline
%
\accelerator{tools.ellipse} &
Switch to ellipse tool &
\mnemonictrail{tools.ellipse}
\tabularnewline
%
\keys{\keyref{ctrl}+\actualkey{F}} &
Select mode: &
\tabularnewline
 &
\leftquadpar{Move selected \gls{object} to the \gls{front}} &
\mnemonictrail{edit.front}
\tabularnewline
 & \TeX\ editor: &
\tabularnewline
 &
\leftquadpar{Find text} &
\mnemonic{texeditor.find}
\tabularnewline
\keys{\keyref{ctrl}+\actualkey{G}} &
Select mode: &
\tabularnewline
 &
\leftquadpar{Group selected \gls{object}} &
\mnemonictrail{transform.group}
\tabularnewline
 &
\TeX\ editor: &
\tabularnewline
 &
\leftquadpar{Find again} &
\mnemonic{texeditor.find_again}
\tabularnewline
\keys{\keyref{ctrl}+\actualkey{H}} &
Select mode: &
\tabularnewline
 &
\leftquadpar{Shear selected \gls{object}} &
\mnemonictrail{transform.shear}
\tabularnewline
 &
\TeX\ editor: &
\tabularnewline
 &
\leftquadpar{Find and Replace text} &
\mnemonictrail{texeditor.replace}
\tabularnewline
%
\accelerator{edit.path.edit} &
Edit selected \gls{path} &
\mnemonictrail{edit.path.edit}
\tabularnewline
%
\accelerator{transform.merge} &
Merge selected \gls{path} &
\mnemonictrail{transform.merge}
\tabularnewline
%
\accelerator{tools.open_curve} &
Switch to open curve tool &
\mnemonictrail{tools.open_curve}
\tabularnewline
%
\accelerator{tools.open_line} &
Switch to open line tool &
\mnemonictrail{tools.open_line}
\tabularnewline
%
\accelerator{tools.gap} &
Gap function &
\mnemonictrail{tools.gap}
\tabularnewline
%
\accelerator{file.new} &
New canvas &
\mnemonictrail{file.new}
\tabularnewline
%
\accelerator{file.open} &
Open \gls{JDR} or \gls{JDR} file &
\mnemonictrail{file.open}
\tabularnewline
%
\accelerator{tools.select} &
Switch to select tool &
\mnemonictrail{tools.select}
\tabularnewline
%
\accelerator{file.quit} &
Quit &
\mnemonictrail{file.quit}
\tabularnewline
%
\accelerator{tools.rectangle} &
Switch to rectangle tool &
\mnemonictrail{tools.rectangle}
\tabularnewline
%
\accelerator{file.save} &
Save current image &
\mnemonictrail{file.save}
\tabularnewline
%
\accelerator{tools.textarea} &
Switch to text tool &
\mnemonictrail{tools.textarea}
\tabularnewline
%
\accelerator{transform.ungroup} &
Ungroup selected \gls{group} &
\mnemonictrail{transform.ungroup}
\tabularnewline
%
\accelerator{edit.paste} &
Paste \gls{object} from clipboard &
\mnemonictrail{edit.paste}
\tabularnewline
%
\accelerator{transform.rotate} &
Rotate selected \gls{object} &
\mnemonictrail{transform.rotate}
\tabularnewline
%
\accelerator{edit.cut} &
Cut selected \gls{object} &
\mnemonictrail{edit.cut}
\tabularnewline
%
\accelerator{edit.path.style.all_styles} &
Edit the selected paths' line styles &
\mnemonictrail{edit.path.style.all_styles}
\tabularnewline
%
\accelerator{transform.scale} &
Scale selected \gls{object} &
\mnemonictrail{transform.scale}
\tabularnewline
%
\accelerator{edit.deselect_all} &
Deselect all &
\mnemonictrail{edit.deselect_all}
\tabularnewline
%
\accelerator{edit.movedown} &
Move selected \gls{object} down the \gls{stack} &
\mnemonictrail{edit.movedown}
\tabularnewline
%
\accelerator{edit.moveup} &
Move selected \gls{object} up the \gls{stack} &
\mnemonictrail{edit.moveup}
\tabularnewline
%
\accelerator{edit.textarea.edit} &
Edit selected text &
\mnemonictrail{edit.textarea.edit}
\tabularnewline
%
\accelerator{tools.closed_curve} &
Switch to closed curve tool &
\mnemonictrail{tools.closed_curve}
\tabularnewline
%
\accelerator{tools.closed_line} &
Switch to closed line tool &
\mnemonictrail{tools.closed_line}
\tabularnewline
%
\accelerator{tools.math} &
Switch to \mathstool &
\mnemonictrail{tools.math}
\tabularnewline
\midrule
%
\keys{\keyref{alt}+\actualkey{1}}\ldots\keys{\keyref{alt}+\actualkey{8}} &
\Glsname{linear-gradient-direction} selectors &
\tabularnewline
%
\keys{\keyref{alt}+\actualkey{1}}\ldots\keys{\keyref{alt}+\actualkey{9}} &
\Glsname{radial-gradient-start-location} selectors &
\end{longtable}


\chapter{Settings}\label{sec:settings}

You can customise the appearance of \FlowframTk's main window either
using the command line arguments (\sectionref{sec:cmdargs}) or
using the settings menu (\sectionref{sec:settingsmenu}).

\section{Command Line Arguments}\label{sec:cmdargs}

\FlowframTk\ can be invoked from a command prompt. 

\appdef{flowframtk}

Depending on your installation, this command may run a bash script
(which will run the application \ext{jar} file) or this command may
be an executable form of the application \ext{jar} file.
The application \ext{jar} file is called \file{flowframtk.jar}
and may also be invoked from the command line explicitly:
\begin{terminal}
java -jar path/to/\file{flowframtk.jar}
\end{terminal}
where \filefmt{path/to/} is the path to the \file{flowframtk.jar}
file.

Note that the options and the filenames may be omitted.
Each filename must be either a \gls{JDR} or an \gls{AJR} file.
The \app{flowframtk} bash script uses the environment variable 
\inlineglsdef{JDR_JVMOPTS} to pass
options to the \gls{jvm}.  For example, if you want to run \FlowframTk\ with
a maximum size of 128Mb for the memory allocation pool, you can set
\gls{JDR_JVMOPTS} to \verb|-Xmx128m|:
\begin{terminal}
setenv \gls{JDR_JVMOPTS} -Xmx128m
\end{terminal}
The \app{flowframtk} script also uses the environment variable
\inlineglsdef{FLOWFRAMTK_OPTS} to pass options to \FlowframTk.

\begin{information}
If you have previously used \gls{JpgfDraw}, the \inlineglsdef{JPGFDRAW_OPTS} 
environment variable will also be recognised, but any settings in 
\gls{FLOWFRAMTK_OPTS} will override those in \gls{JPGFDRAW_OPTS}.
\end{information}

For example, if you always want \FlowframTk\ to start up with the grid showing,
 you can set \gls{FLOWFRAMTK_OPTS} to \switch{show_grid}:
\begin{terminal}
setenv \gls{FLOWFRAMTK_OPTS} \switch{show_grid}
\end{terminal}
(Bear in mind that \gls{JDR} and \gls{AJR} files can have certain
settings saved, which may override the startup settings.)

\begin{important}
Note that these environment variables only have an effect if you
use the \app{flowframtk} script to run the \gls{jre}.
\end{important}

Available command line options are listed below.
Older versions of \FlowframTk\ had switches prefixed with a single
hyphen (such as \shortargfmt{help}). These are still supported for
backward-compatibility but double-hyphen versions are now provided
(such as \longargfmt{help}).

\switchdef{show_grid}
Show the \gls{grid}.

\switchdef{noshow_grid}
Don't show the \gls{grid}.

\switchdef{lock_grid}
Lock the \gls{grid}.

\switchdef{nolock_grid}
Don't lock the \gls{grid}.

\switchdef{toolbar}
Show the \glspl{toolbar}.

\switchdef{notoolbar}
Don't show the \glspl{toolbar}.

\switchdef{statusbar}
Show the \gls{statusbar}.

\switchdef{nostatusbar}
Don't show the \gls{statusbar}.

\switchdef{ruler}
Show the \glspl{ruler}.

\switchdef{noruler}
Don't show the \glspl{ruler}.

\switchdef{paper}
Set the paper \gls{paper.size}. The argument may be a single keyword that
identifies a recognised paper \gls{paper.size} or, for a custom size, the
argument may be the keyword \optfmt{user} followed by the width and
height. For example:
\begin{terminal}
\app{flowframtk} \switch{paper} user 100mm 200mm
\end{terminal}

The custom size must have positive dimensions.
Recognised units: \code{\gls{pt}}, \code{\gls{bp}},
\code{in}, \code{mm}, \code{cm}, \code{pc},
\code{dd} and \code{cc}. If the unit is omitted,
\code{\gls{bp}} is assumed. Examples:
\begin{itemize}
\item \code{\switch{paper} a4r}
\item \code{\switch{paper} user 8.5in 12in}
\item \code{\switch{paper} user 600 1000}
\end{itemize}

\FloatTable
{tab:papersizes}
{%
\begin{tabular}{llll}    
\toprule
\multicolumn{1}{c}{\bfseries Identifier} &
\multicolumn{1}{c}{\bfseries Description} &
\multicolumn{1}{c}{\bfseries Identifier} &
\multicolumn{1}{c}{\bfseries Description}
\tabularnewline 
\midrule
\optfmt{a10}&A10 portrait &    \optfmt{a10r}&A10 landscape\tabularnewline 
\optfmt{a9}&A9 portrait &    \optfmt{a9r}&A9 landscape\tabularnewline
\optfmt{a8}&A8 portrait &    \optfmt{a8r}&A8 landscape\tabularnewline
\optfmt{a7}&A7 portrait &    \optfmt{a7r}&A7 landscape\tabularnewline
\optfmt{a6}&A6 portrait &    \optfmt{a6r}&A6 landscape\tabularnewline
\optfmt{a5}&A5 portrait &    \optfmt{a5r}&A5 landscape\tabularnewline
\optfmt{a4}&A4 portrait &    \optfmt{a4r}&A4 landscape\tabularnewline
\optfmt{a3}&A3 portrait &    \optfmt{a3r}&A3 landscape\tabularnewline
\optfmt{a2}&A2 portrait &    \optfmt{a2r}&A2 landscape\tabularnewline
\optfmt{a1}&A1 portrait &    \optfmt{a1r}&A1 landscape\tabularnewline
\optfmt{a0}&A0 portrait &    \optfmt{a0r}&A0 landscape\tabularnewline
\optfmt{b10}&B10 portrait &    \optfmt{b10r}&B10 landscape\tabularnewline
\optfmt{b9}&B9 portrait &    \optfmt{b9r}&B9 landscape\tabularnewline
\optfmt{b8}&B8 portrait &    \optfmt{b8r}&B8 landscape\tabularnewline
\optfmt{b7}&B7 portrait &    \optfmt{b7r}&B7 landscape\tabularnewline
\optfmt{b6}&B6 portrait &    \optfmt{b6r}&B6 landscape\tabularnewline
\optfmt{b5}&B5 portrait &    \optfmt{b5r}&B5 landscape\tabularnewline
\optfmt{b4}&B4 portrait &    \optfmt{b4r}&B4 landscape\tabularnewline
\optfmt{b3}&B3 portrait &    \optfmt{b3r}&B3 landscape\tabularnewline
\optfmt{b2}&B2 portrait &    \optfmt{b2r}&B2 landscape\tabularnewline
\optfmt{b1}&B1 portrait &    \optfmt{b1r}&B1 landscape\tabularnewline
\optfmt{b0}&B0 portrait &    \optfmt{b0r}&B0 landscape\tabularnewline
\optfmt{c10}&C10 portrait &    \optfmt{c10r}&C10 landscape\tabularnewline
\optfmt{c9}&C9 portrait &    \optfmt{c9r}&C9 landscape\tabularnewline
\optfmt{c8}&C8 portrait &    \optfmt{c8r}&C8 landscape\tabularnewline
\optfmt{c7}&C7 portrait &    \optfmt{c7r}&C7 landscape\tabularnewline
\optfmt{c6}&C6 portrait &    \optfmt{c6r}&C6 landscape\tabularnewline
\optfmt{c5}&C5 portrait &    \optfmt{c5r}&C5 landscape\tabularnewline
\optfmt{c4}&C4 portrait &    \optfmt{c4r}&C4 landscape\tabularnewline
\optfmt{c3}&C3 portrait &    \optfmt{c3r}&C3 landscape\tabularnewline
\optfmt{c2}&C2 portrait &    \optfmt{c2r}&C2 landscape\tabularnewline
\optfmt{c1}&C1 portrait &    \optfmt{c1r}&C1 landscape\tabularnewline
\optfmt{c0}&C0 portrait &    \optfmt{c0r}&C0 landscape\tabularnewline
\optfmt{letter}&Letter portrait &    \optfmt{letterr}&Letter landscape\tabularnewline
\optfmt{legal}&Legal portrait &    \optfmt{legalr}&Legal landscape\tabularnewline
\optfmt{executive}&Executive portrait &    \optfmt{executiver}&Executive landscape\tabularnewline
\bottomrule 
\end{tabular}
}%
[Paper Size Identifiers]
{Paper \gls{paper.size} identifiers for use with \switch{paper} command line switch.}


\switchdef{disable_print}
Disable the request for printer attributes on startup.

\switchdef{nodisable_print}
Don't disable the request for printer attributes on startup (default).

\switchdef{debug}
Enable debugging mode. This will add the \inlineglsdef{menu.debug}
menu to the main menu bar which provides the following functions:
\menu{debug.objectinfo} (displays diagnostic information about the
currently \selected\ objects); \menu{debug.writelog} (writes
diagnostic information for all currently open images to a log file
in the \gls{config_dir}) \menu{debug.revalidate} (revalidates the
image) and \menu{debug.dumpall} (saves all current images to a
subdirectory of the \gls{config_dir}).

\switchdef{nodebug}
Don't enable debugging mode (default).

\switchdef{experimental}
Enable experimental functions for testing purposes. These functions don't
work properly and are not documented.

\switchdef{noexperimental}
Don't enable experimental functions (default).

\switchdef{help}
Display help message and exit.

\switchdef{version}
Display version details and exit.

\section{The Settings Menu}\label{sec:settingsmenu}

\menudef{menu.settings}

While \FlowframTk\ is running, you can change the current settings
using the \menu{settings} menu. Most of the settings will be
remembered next time you use \FlowframTk, but may be overridden
either by \hyperref[sec:cmdargs]{command line arguments} or by
settings specified in any \gls{JDR} or \gls{AJR} file that you load.

If you have selected \widget{initsettings.default} in the
\widget{initsettings.title} tab of the \dialog{config} dialog,
then the \emph{\gls{canvas}} settings will be set to the default
values on startup (unless overridden, as above). Some (but not all)
of the user interface settings may still be remembered from the
previous session.

\subsection{Styles}\label{sec:setcurrentstyles}

\menudef{menu.settings.styles}

The \menu{settings.styles} menu item will open a dialog window
which can be used to set the current \gls{path} and
\gls{textarea} attributes. New paths and text areas will use these
attributes when they are created. The attributes for existing paths
and text areas are changed using the \menu{edit} menu.  These
settings are discussed in more detail in \sectionref{sec:styles}.

\subsection{Show Rulers}\label{sec:showrulers}

\menudef{menu.settings.rulers}

The \menu{settings.rulers} menu item can be used to toggle between showing
and hiding the \glspl{ruler} for the current \gls{canvas}. This
setting will be applied to new \glspl{canvas} that are subsequently
opened, but the setting may be overridden when a new image is
loaded.

\seealsorefs{sec:rulers}

\subsection{Grid}\label{sec:gridmenu}

\menudef{menu.settings.grid}

The \menu{settings.grid} submenu allows you to change
the \gls{grid} settings:

\menudef{menu.settings.grid.show}

The \menu{settings.grid.show} menu item toggles between displaying
the \gls{grid} on the \gls{canvas} and hiding it. If there is
enough memory available, the grid will be stored as a bitmap in
order to improve redraw speed.

\plabel[Locking the Grid]{mi:gridlock}
\menudef{menu.settings.grid.lock}

The \menu{settings.grid.lock} menu item toggles between locking and
unlocking the grid. If the grid is locked, mouse \glspl{click} will
be translated to the nearest tick mark.  This means that if you use
a mouse \gls{click} to set the location of a \gls{controlpt} when
constructing a \gls{path}, the point will be placed at the nearest
tick mark. This also means that when you move a point while in 
\editpathmode, the point will be moved in
intervals of the gap between tick marks. Note that locking the grid
does not affect the keyboard or menu driven functions, such as
\menutrail{menu.navigate.goto} \accelerator{menu.navigate.goto}
or emulate a \gls{primaryclick}
\accelerator{action.construct_click}.


When the grid is locked, the \gls{statusbar} will show the image
\includeimg[alt={Grid lock on}]{key} otherwise it will show
the image \includeimg[alt={Grid lock off}]{keycross}.
You can \gls{doubleclick} on this image to toggle the state.

\begin{warning}
If you lock the grid, you will be unable to use the
mouse to \select\ narrow \glspl{path} that lie between tick marks as
mouse \glspl{click} will be translated to the nearest tick mark, unless you
use the drag rectangle (which may \select\ other \glspl{object} as well).
\end{warning}

Similarly, if the \widget{editpathui.ignorelock}
option is off, you won't be able to select \glspl{controlpt} in
\editpathmode\ with the mouse unless a
tick mark lies inside the \gls{controlpt}['s] bounding box.
You will however be able to select them using the
\menutrail{menu.editpath.next_control} 
or \menutrail{menu.editpath.prev_control} functions.

\menudef{menu.settings.grid.settings}

The \menu{settings.grid.settings} menu item will open the
\dialog{grid} dialog box (see \figureref{fig:griddialog}) in which
you can specify the position of the tick marks and the units used.
You can also open this dialog box by
\glslink{doubleclick}{double-clicking} on the top left corner
between the \glspl{ruler}, where the current grid unit is displayed.

\FloatFig{fig:griddialog}
{\includeimg{annoteGridDialog}}
{The Grid Dialog}

\begin{important}
The grid unit is independent of the 
\hyperref[sec:controlsettings]{storage unit}.  However, it's a good idea to choose a
grid unit and storage unit that have a convenient conversion factor
between them. For example, \code{mm} storage unit and \code{cm}
grid unit. Regardless of the grid used, co-ordinates are always
stored as left-handed rectangular co-ordinates where the \gls{origin} is
at the top left of the paper. This may cause slight rounding errors in the
conversion between rectangular and radial co-ordinates.
\end{important}

\widgetdef{grid.title}

The default grid type is a left-handed rectangular grid. You can
switch to a different grid by selecting a different tab.
The \inlineglsdef{origin} is the top left hand corner of the paper.
This defaults to the top left hand corner of the \gls{canvas}, but
the \gls{origin} may be shifted.

Imagine that a page with the paper size
and orientation governed by the paper setting (see
\sectionref{sec:papermenu}) is overlaid on the \gls{canvas}. The
\gls{canvas} has the same height and width as the page and initially
the page exactly fits the \gls{canvas} with the page \gls{origin} (the top
left corner of the page) aligned with the top left corner of the
\gls{canvas}. Shifting the \gls{origin} is essentially moving the page
horizontally or vertically around the \gls{canvas}. Anything outside
of the page can be viewed in \FlowframTk\ but may not be visible if
the image or \gls{flowframe} data is exported.

The $x$ and $y$ axes are drawn although they may be hard to see when
they're aligned along the \gls{canvas} borders. See, for example, 
\figureref{fig:grid-radial-shift} where the \gls{origin} has been
shifted 1cm to the right and 2cm down.

\widgetdef{grid.offset}

The \gls{origin} offset panel is always show in the \dialog{grid}
dialog, regardless of which tab has been selected.
Enter the horizontal shift in the \inlineglsdef{grid.offset.x} box
and the vertical shift in the \inlineglsdef{grid.offset.y} box. The unit of
measurement is always the unit associated with the grid's major
divisions setting. Note that the offset values aren't automatically
updated if you change the grid unit or paper size or orientation.

For convenience, there are nine buttons that you can click on to
calculate the shift required to position the \gls{origin} at the page:
top left, top middle, top right, left middle, middle, right middle,
bottom left, bottom middle, or bottom right. If you change the grid
unit or the paper, then you will need to recalculate the positions.

Each grid type has a \inlineglsdef{grid.major} setting with an
associated unit and a \inlineglsdef{grid.sub_divisions} setting. In
some cases, these may just apply to the \glspl{ruler}.
There are buttons arranged in a column on the right hand side
of the \dialog{grid} dialog which may be used to quickly fill in the
\widget{grid.major} and \gls{grid.sub_divisions} boxes in each grid tab for common
settings.

\FloatSubFigs{fig:grid}
{
  {fig:grid-rect}{\includeimg{grid-rect}}{},
  {fig:grid-iso}{\includeimg{grid-iso}}{},
  {fig:grid-radial-page}{\includeimg{grid-radial}}{},
  {fig:grid-radial-origin}{\includeimg{grid-radial-origin}}{}
}
[Available Regular Grids]
{Available regular grids:
\subfigref{fig:grid-rect} rectangular grid;
\subfigref{fig:grid-iso} isomorphic grid;
\subfigref{fig:grid-radial-page} radial grid (page-dependent);
\subfigref{fig:grid-radial-origin} radial grid (origin).}

\widgetdef{grid.rectangular}

The rectangular grid matches the left-handed internal co-ordinate
storage with the horizontal $x$ values increasing to the right and the
vertical $y$ values increasing downwards
(\figureref{fig:grid-rect}). This grid has two parameters:
\widget{grid.major} (which identifies the grid unit) and
\widget{grid.sub_divisions} which indicates the number of minor tick
marks between each major tick.

\widgetdef{grid.iso}

The isometric grid is likewise a left-handed co-ordinate system but in this case
the major divisions indicate the length of each
side of the equilateral triangles forming the grid
(\figureref{fig:grid-iso}).

\widgetdef{grid.radial}

The radial grid also has the \widget{grid.major} and
\widget{grid.sub_divisions} but additionally has a \inlineglsdef{grid.spokes}
setting, which indicates the number of spokes that radiate out from
the \manmsg{centre} of the grid. The tick marks are positioned along
the spokes.

The \inlineglsdef{grid.radial.centre} setting governs where the
\manmsg{centre} of the grid is drawn. Remember that the
\widget{grid.offset} will cause the grid to shift (compare
\figureref{fig:grid-radial-page} and
\figureref{fig:grid-radial-origin} with
\figureref{fig:grid-radial-page-shift} and
\figureref{fig:grid-radial-origin-shift}, where the \gls{origin} has
been shifted by 1cm to the right and 2cm down).

\FloatSubFigs{fig:grid-radial-shift}
{
  {fig:grid-radial-page-shift}{\includeimg{grid-radial-page-shift}}{},
  {fig:grid-radial-origin-shift}{\includeimg{grid-radial-origin-shift}}{}
}
[Radial Grid with Origin Shift]
{Radial grid with origin shift (1cm to the right and 2cm down):
\subfigref{fig:grid-radial-page-shift} radial grid (page-dependent);
\subfigref{fig:grid-radial-origin-shift} radial grid (origin).}

\widgetdef{grid.radial.centre.origin}

The \widget{grid.radial.centre.origin} setting will \manmsg{centre}
the grid on the actual \gls{origin}, which is at the top left
hand corner of the page. So the radial co-ordinate (0:0) will be
converted to the rectangular co-ordinate (0,0). With this setting
on, the grid is unaffected by the paper size or orientation.

\widgetdef{grid.radial.centre.paper}

The paper-dependent radial grid is \manmsg{centred} in the middle of
the paper (\figureref{fig:grid-radial-page}). Bear in mind that any
radial co-ordinates will be converted to rectangular co-ordinates.
So the radial co-ordinate (0:0) will be converted to the rectangular
co-ordinate of the current paper \manmsg{centre}.

\begin{important}
If you use a radial grid with the \widget{grid.radial.centre.paper}
setting and you change the paper size or orientation,
the grid will shift but the \glspl{object} will maintain
their original positions relative to the rectangular co-ordinate
\gls{origin}.
\end{important}

Remember that shifting the paper \gls{origin} is like shifting the
page around on the \gls{canvas}. This will cause the grid to also
shift so that it's no longer \manmsg{centred} on the \gls{canvas}.

\widgetdef{grid.tschichold}

The \widget{grid.tschichold} is a typesetting grid after Tschichold
(see~\cite[p.~40]{Hoschuli}). This is the only grid that checks the
\hyperref[sec:displaypage]{display page setting}. If an even
numbered page is displayed, the \gls{verso} grid is shown
(\figureref{fig:tschicholda}), otherwise the \gls{recto} grid is
shown (see \figureref{fig:tschicholdb}). The \gls*{recto} grid is
used for the default \widget{displaypage.all} setting.

\FloatSubFigs{fig:tschichold}
{
  {fig:tschicholda}{\includeimg{tschichold-verso}}{},
  {fig:tschicholdb}{\includeimg{tschichold-recto}}{}
}
[Tschichold Grid]
{Tschichold grid:
\subfigref{fig:tschicholda} verso (even pages);
\subfigref{fig:tschicholdb} recto (odd pages).}

Note that you are limited to only fourteen locations with the
\widget{grid.tschichold} grid if you have the
\gridlock\ on. The settings for this grid style are the same as for
the rectangular grid and are only applied to the rulers. The \gls{origin}
is the top left corner of the \gls{canvas} for both the \gls{recto}
and \gls{verso} displays. The grid settings (major and subdivisions)
are only applied to the rulers. In general, it's best not to shift
the \gls{origin} with this grid (unless you're trying to find an
\gls{object} that has somehow moved outside the page bounds).

\widgetdef{grid.path}

The \widget{grid.path} grid follows a specified path. This places major tick
marks at the path's control points. (The major distance setting is
only applied to the rulers.) The subdivision setting will place
minor tick marks along the path segments.

\FloatSubFigs*{fig:pathgrid}
{
  {fig:pathgrida}{\includeimg{pathgrid1}}{},
  {fig:pathgridb}{\includeimg{pathgrid2}}{},
  {fig:pathgridc}{\includeimg{pathgrid3}}{}
}
 [Path-Based Grid]
 {Path-based grid:
\subfigref{fig:pathgrida} path used to form new grid
(current grid is rectangular);
\subfigref{fig:pathgridb} grid panel;
\subfigref{fig:pathgridc} path in
\subfigref{fig:pathgrida} has been deleted by the user and the new grid is now
visible.}

For example, in \figureref{fig:pathgrida} a circle has been
constructed on a rectangular grid. This circle will be used as the
guide for the path-based grid. Note that this will make a
\emph{copy} of the shape. If the original shape (the circle in this
case) is edited or deleted, the grid won't change.
In \figureref{fig:pathgridb}, the path-based grid panel has
been selected. This provides three options:

\widgetdef{grid.path.keep}

If a path-base grid has already been used, then the
\widget{grid.path.keep} option will be available and should be
selected if you want to keep that path.  This option will be
disabled if you haven't yet used a path-based grid.

\widgetdef{grid.path.usepage}

The \widget{grid.path.usepage} option will create a grid that
follows the page boundary. (That is, the path is the rectangle that
fits the \gls{canvas} border.)

\widgetdef{grid.path.select}

The \widget{grid.path.select} option allows you to select an
\gls{object} from the \gls{canvas} to use as the path.  If this
option is selected, the drop-down menu next to it will be enabled.
This lists all the objects in your image (as per the
\dialog{description} dialog box described in
\sectionref{sec:navigate}).

If the object is a \gls{shape}, that shape
will be converted to a complete \gls{path} (if not already a
\gls{path}), otherwise the grid will be based on the
\gls{object}['s] \gls{bbox}. In \figureref{fig:pathgridb},
the circle (Path:~4) has been selected.
(\hyperref[sec:objectdescription]{Assigning descriptions} to
\glspl{object} makes this task easier, but the drop-down menu will
default to the first selected \gls{object}, if applicable, to
assist selection.)

In \figureref{fig:pathgridc}, the new grid has been applied.  The
original circle has been manually deleted (using \menu{edit.cut}) to
allow the grid to be shown for illustrative purposes. Note that the
major division setting of 100\gls{pt} only applies to the rulers, as
the major tick marks are located at the shape's \glspl{controlpt}.



\subsection{Zoom}\label{sec:zoommenu}

\menudef{menu.settings.zoom}

The \menu{settings.zoom} sub-menu allows you to change
the magnification. You can choose one of the predefined
settings or you can specify an arbitrary setting.

\menudef{menu.settings.zoom.user}

The \menu{settings.zoom.user} menu item will open the
\inlineglsdef{zoom.title} dialog box (see \figureref{fig:zoom}) in
which to specify an arbitrary magnification.  The magnification
value may be entered as either a percentage
(\figureref{fig:zoompercent}) or a decimal value
(\figureref{fig:zoomdecimal}). For example, either 150\% or 1.5 to
zoom by a factor of 1.5.  You can also change the magnification
using the zoom function in the \gls{statusbar}. \Gls{click} on the
decrease button \includeimg{zoomdown} to reduce the magnification or
on the increase button \includeimg{zoomup} to increase the
magnification, according to the list of preset values.
Alternatively, you can \gls{doubleclick} to open the \dialog{zoom}
dialog box or \gls{menuclick} on the percentage value to open
a~popup menu.

\FloatSubFigs{fig:zoom}
 {
   {fig:zoompercent}{\includeimg{setMagnificationPercent}}{Percentage},
   {fig:zoomdecimal}{\includeimg{setMagnificationDecimal}}{Decimal}
 }
 {Setting Custom Magnification}

\subsection{Paper}\label{sec:papermenu}

\menudef{menu.settings.paper}

The \menu{settings.paper} sub-menu allows you to change
the \gls{paper} attributes.

\menudef{menu.settings.paper.margins}

The \menu{settings.paper.margins} item toggles between showing
and hiding the \glspl{printer-margin}, but note that this facility is not
available if you use the \switch{disable_print} command line
argument.

The predefined paper \glspl{paper.size} A0 to A5, letter, legal and executive
can be selected from the \menu{settings.paper} menu.

\menudef{menu.settings.paper.other}

The \menu{settings.paper.other} item allows a custom paper \gls{paper.size} to
be specified.  Select the  \widget{paper.predefined} radio button to
enable a list of additional known paper sizes or select the
\widget{paper.user} radio button to enter a custom size.


\subsection{Configure Image Settings}\label{sec:configuredialog}

\menudef{menu.settings.config}

The \menu{settings.config} menu item opens the \inlineglsdef{config.title}
dialog box, which can be used to change image settings.
(\sectionref{sec:texconfig} covers \TeX\slash\LaTeX\ related settings and
\sectionref{sec:configureuidialog} covers settings related to the user
interface.)


\subsubsection{Control Points}\label{sec:controlsettings}

\widgetdef{controls.title}

\FloatFig
  {fig:configdialog-controlsettings}
  {\includeimg{configureDialog-controls}}
  {Configuration Dialog Box (Control Point Settings)}

The \widget{controls.title} tab
(\figureref{fig:configdialog-controlsettings})
has the following settings.

\widgetdef{controls.control_size}

Set the size of the \glspl+{controlpt} with
\widget{controls.control_size} length field.

\widgetdef{controls.scale_controls}

You can choose whether or not to scale the \glspl{controlpt}
when the image has the magnification changed.
Deselect \widget{controls.scale_controls} if you want the
\glspl{controlpt} to remain the same size regardless of the zoom
setting.

\widgetdef{controls.storage_unit}

Set the \gls{storageunit} in the \gls{dropdown} selector (\gls+{pt},
\gls+{bp}, in, cm, mm, pc, dd or cc).

It's best to set the \gls{storageunit} before you start creating an
image. If the selected \gls{canvas} isn't empty, all \glspl{object} will
have their co-ordinates recomputed in terms of the new unit, which
may take a while if there are many \glspl{object} or \glspl{path}
with many segments.  You can also open a dialog window with just the
storage unit panel in it by \glslink{doubleclick}{double-clicking}
the mouse on the storage unit area of the \gls{statusbar}.

\subsubsection{Startup Directory}\label{sec:startdir}

\widgetdef{startdir.title}

\FloatFig
  {fig:configdialog-startdir}
  {\includeimg{configureDialog-startdir}}
  {Configuration Dialog Box (Startup Directory Settings)}

The \widget{startdir.title} tab
(\figureref{fig:configdialog-startdir})
allows you to choose which directory \FlowframTk\ should use as the
current working directory when it starts up. You have a choice of:
\begin{itemize}
\item the current working directory that you were in when you started
up \FlowframTk;
\item the directory you were using when you last used \FlowframTk;
\item a specific directory. In this case, type in the path in the
\widget{startdir.named} box or use the
\widget{startdir.browse} button to select the required
directory.
\end{itemize}


\subsubsection{JDR/AJR Settings}\label{sec:jdrsettings}

\widgetdef{jdr.title}

\FloatFig
  {fig:configdialog-jdrsettings}
  {\includeimg{configureDialog-jdrsettings}}
  {Configuration Dialog Box (JDR/AJR Settings)}

You can use the \widget{jdr.title} tab
(\figureref{fig:configdialog-jdrsettings})
to specify whether or not you want the current
\gls{canvas} settings stored in the \gls{JDR} or \gls{AJR} file when
you save your image. You can also choose whether or not you want to
apply any canvas settings information stored in any \gls{JDR} or
\gls{AJR} file that you load. The canvas settings consist of:
grid show\slash hide, grid locked\slash not locked, rulers
displayed\slash not displayed, the tool in use, the LaTeX normal
size, the \gls{paper} attributes, the grid style, the size of the
\glspl{controlpt} and whether they should be affected by the
magnification setting.


\subsubsection{Startup Settings}\label{sec:initsettings}

\widgetdef{initsettings.title}

\FloatFig
  {fig:configdialog-initsettings}
  {\includeimg{configureDialog-initsettings}}
  {Configuration Dialog Box (Startup Settings)}

You can use the \widget{initsettings.title} tab
(\figureref{fig:configdialog-initsettings})
to choose whether you want \FlowframTk\ to start with its
default settings, or whether to restore the settings from the last
time you used \FlowframTk, or whether to use the settings that are
currently in use.

If you choose the default settings option, the \emph{\gls{canvas}}
settings will be set to the default on startup.  Some (but not all)
of the user interface settings may still be remembered from the
previous session, including the language used by the user interface
and the manual, the paths to the required applications used by the
\filefn{export} functions and the button styles.

Most of the settings are saved in the file \file{flowframtk.conf} in the
\gls{config_dir}.  Mappings,
accelerators, language settings and the recent file list aren't
governed by the startup setting and are stored in separate files in
the configuration directory. When you upgrade to a new version of
\FlowframTk, the accelerators are reset to the default and then the
existing accelerators file is loaded to ensure any new accelerators
are added. Don't modify these files whilst \FlowframTk\ is running.
You may modify them after you have quit \FlowframTk\ using a text
editor, but make sure you save your changes before restarting
\FlowframTk.


\subsubsection{Bitmaps}\label{sec:bitmapconfig}

\widgetdef{bitmapconfig.title}

\FloatFig
  {fig:configdialog-bitmap}
  {\includeimg{configureDialog-bitmap}}
  {Configuration Dialog Box (Bitmap Settings)}

You can use the \widget{bitmapconfig.title} tab
(\figureref{fig:configdialog-bitmap})
to choose whether included \glspl{bitmap} should be
saved using their full path name or a path name relative to the
file being saved. Relative names allow for greater portability, but
if you move the saved file to a different location, you will need to
remember to move the bitmap files relative to the new location or
they won't be found.

You can also use this tab to specify
your preferred default image command, which may be either
\gls{pgfimage} or \gls{includegraphics}.


\subsubsection{Application Paths}\label{sec:processes}

\widgetdef{processes.title}

\FloatFig
  {fig:configdialog-apppaths}
  {\includeimg{configureDialog-apppaths}}
  {Configuration Dialog Box (Application Paths)}

If you \filefn{export} your image to PDF or if you export to 
PNG (or, if enabled, EPS or \gls{svg}) with the \widget{export.use_process} option on then
\FlowframTk\ will first save the image as a \LaTeX\
document and will then run external applications to create the
desired file format. In order to do this, \FlowframTk\ needs to know
the correct paths to these applications. It will try to find them
from your system's \gls{PATH} environment variable, but if it
can't find them you can use the \widget{processes.title} tab
(\figureref{fig:configdialog-apppaths}) to set their locations.  The
\file{libgs} library is needed by \app{dvisvgm}, so you only
need it if you intend to export to \gls{svg}.
These settings can also be changed in the \dialog{export} dialog.

To reduce the chance of zombie processes, each process is run with a
timer that will kill the process if it exceeds the value specified
in the \widget{processes.timeout} box.

\widgetdef{processes.support_eps_svg}

The DVI format was still widely in use when \gls{JpgfDraw} was first
created (around 2005) so it was useful to be able to export to EPS.
However, the DVI format has mostly fallen out of use so, to reduce
clutter in the \dialog{export} dialog, the export functions that rely
on the DVI format are no longer supported by default.
If you still require EPS or \gls{svg}, you need to enable support
by ensuring that the \widget{processes.support_eps_svg} checkbox is
selected.

\subsection{\TeX\ Settings Dialog}\label{sec:texconfig}

\menudef{menu.settings.configtex}

The \menu{settings.configtex} menu item will open up 
the \inlineglsdef{texconfig.title} dialog box
in which you can adjust the \TeX\slash\LaTeX\ settings.
(\sectionref{sec:configuredialog} covers image settings
and \sectionref{sec:configureuidialog} covers user interface settings.)


\subsubsection{Setting the Document Class and Normal Font Size}
\label{sec:normalsize}

\widgetdef{clssettings.title}

Most of \FlowframTk's \TeX\slash\LaTeX\ related functions (including the
applicable \filefn{export} formats) require a value
corresponding to \gls{normalsize} (the \LaTeX\ command that sets the
\gls{normal-font-size}). A \gls{textarea} needs to know the normal
font size to determine the appropriate font size declaration (see
\sectionref{sec:fontsize}). In addition, both the
\gls{menu.tex.parshape} and \gls{menu.tex.shapepar} functions use
the value of \gls{baselineskip} for the normal font size in order to
determine the location of the scan lines used to compute the
required parameters. This also means that any static or dynamic
frames (\sectionref{sec:flowframe}) that use a non-standard paragraph
shape also require this information.

\FloatFig
 {fig:normalsize}
 {\includeimg{normalsizeandclass}}
 {Setting the Normal Font Size and (optionally) the Class}

\widgetdef{clssettings.normalsize}

The \inlineglsdef{normal-font-size} can be set using the
\widget{clssettings.title} tab (\figureref{fig:normalsize}).  Select the
required value from the \widget{clssettings.normalsize} \gls*{dropdown} and select
\dgls{okay} to set it. Note that you must remember
to use this value in your document. For example, if you set the
normal size as 20, your document will need to use one of the
\sty{extsizes} class files, e.g.\ \cls{extarticle}, and specify
20\gls{pt} as one of the optional arguments:
\begin{codebox}
\cmd{documentclass}[20pt]\marg{extarticle}
\end{codebox}

The largest normal size listed is 25pt (the value is actually
24.88pt, but \FlowframTk\ lists it as 25pt) which is for use with the
\cls{a0poster} class file. Remember that for very large or very
small fonts, you will need to use scalable fonts in your document to
prevent font size substitutions.  Available values, along with the
corresponding value of \gls{baselineskip} and the file in which they
are defined, are listed in \tableref{tab:normalsize}.

\FloatTable
{tab:normalsize}
{%
\begin{tabular}{@{}ccl@{}}
\bfseries Normal size value & \bfseries \gls{baselineskip}
value & \bfseries Relevant File\\
8 & 9.5 & \filefmt{tex/latex/extsizes/size8.clo}\\
9 & 11 & \filefmt{tex/latex/extsizes/size9.clo}\\
10 & 12 & \filefmt{tex/latex/base/size10.clo}\\
11 & 13.6 & \filefmt{tex/latex/base/size11.clo}\\
12 & 14.5 & \filefmt{tex/latex/base/size12.clo}\\
14 & 17 & \filefmt{tex/latex/extsizes/size14.clo}\\
17 & 22 & \filefmt{tex/latex/extsizes/size17.clo}\\
20 & 25 & \filefmt{tex/latex/extsizes/size20.clo}\\
25 & 30 & \filefmt{tex/latex/a0poster/a0poster.sty}
\end{tabular}
}
[Available Values for the Normal Font Size]
{Available values for the normal font size, the corresponding value
and the file in which they are defined (relative to the TEXMF
tree).}

\widgetdef{clssettings.update}

If the \widget{clssettings.update} \gls*{checkbox} is selected,
changing the normal size setting in this dialog will update the
\LaTeX\ font size settings for all the \glspl{textarea} in the
current image.

\widgetdef{clssettings.default_cls}

If you want to export your image to a complete \LaTeX\ document (see
\sectionref{sec:exportdoc}) the \inlineglsdef{document-class} will default to:
\begin{itemize}
\item \cls{article}, if the normal size is
set to 10, 11 or 12;
\item \cls{a0poster}, if the normal size is set to
25;
\item \cls{extarticle}, otherwise.
\end{itemize}

\widgetdef{clssettings.custom_cls}

If you want to use a different \gls{document-class}, select the
\widget{clssettings.custom_cls} radio button, which will enable the
field where you can type the require class name (without the
\filefmt{.cls} extension). You need to ensure the class supports your
specified normal font size (as a standard option, not a key=value
option).

The \gls{document-class} is also used as the base class with the export to
document class function (see \sectionref{sec:exportsty}) and is used
for all \filefn{export} functions that use the export to encapsulated \LaTeX\
document function as an intermediate step.

\widgetdef{clssettings.relative_fontsize}

The \widget{clssettings.relative_fontsize} \gls*{checkbox} governs
the suggested \LaTeX\ font size command when you change the
\hyperref[sec:fontsize]{font size setting} for \glspl{textarea}. If
this \gls*{checkbox} is selected, \FlowframTk\ will attempt to select a
font size declaration, such as \gls{large}, according to the current
normalsize setting. Otherwise, \gls{setfontsize} will be used. If
the font size is significantly larger than the largest available
declaration, \gls{setfontsize} will be used regardless of this
setting.

\widgetdef{clssettings.pdfinfo}

The \widget{clssettings.pdfinfo} \gls*{checkbox} governs whether or
not to add the title and creation date meta data to the exported
document. If you have \sty{flowframtkutils} installed, the
information will be written to the exported file in the form
\begin{compactcodebox}
\gls{flowframtkimageinfo}\marg{
 title=\margm{image-description},
 creationdate=\margm{PDF date}
}
\end{compactcodebox}
where \meta{image-description} is the image's description
(see \sectionref{sec:imagedescription}) and \meta{PDF date}
is the date in PDF date format. The title will be omitted if the
image's description hasn't been set.
If \sty{flowframtkutils} isn't available, then \gls{pdfinfo} will be
used instead, if it's available.


\subsubsection{Flowframe Settings}\label{sec:texconfigflf}

\widgetdef{flfsettings.title}

\FloatFig
 {fig:flfsettings}
 {\includeimg{flfsettings}}
 {Flowframe Settings Tab}

The \widget{flfsettings.title} tab
(\figureref{fig:flfsettings}) allows you to adjust the
\sty{flowfram} related settings.

The \sty{flowfram} package now allows you to use absolute pages
numbers in the page list rather than using the value of the
\ctr{page} counter. For example, if your document pages are numbered
a, b, i, ii, iii, 1, 2, 3, then with the absolute setting page
number 3 refers to the page \manmsg{labelled} i whereas with the
relative setting page number 3 refers to both the page
\manmsg{labelled} iii and the page \manmsg{labelled} 3. (See the
\sty{flowfram} documentation for further details.) If you want to
use the absolute setting, select the
\inlineglsdef{flfsettings.pages_opt.absolute} button otherwise select the
\inlineglsdef{flfsettings.pages_opt.relative} button.

\widgetdef{flfsettings.shapeparcs}

The \sty{shapepar} package now has a command called
\gls{Shapepar} that behaves slightly differently to
\gls{shapepar}. Since \gls{Shapepar} works better than
\gls{shapepar} when used with the \sty{flowfram} package,
\FlowframTk\ defaults to using \gls{Shapepar} for the
\gls{menu.tex.shapepar} function or when a
\hyperref[sec:flowframe]{static or dynamic frame} has the
shape set to \widget{flowframe.shape_shapepar}. However, if
you prefer the original \gls{shapepar} command, selected the
appropriate \widget{flfsettings.shapeparcs} radio button.
If you want to use \gls{Shapepar}, you need to ensure you have
up-to-date versions of the \sty{flowfram} and \sty{shapepar}
packages. This setting applies both to frames with the
\widget{flowframe.shape_shapepar} shape setting and to the
\gls{menu.tex.shapepar} function.

\subsubsection{Text Settings}\label{sec:texconfigtext}

\widgetdef{textconfig.title}

\FloatFig
  {fig:configdialog-texsettings}
  {\includeimg{configureDialog-texsettings}}
  {LaTeX-Related Text Settings}

The \widget{textconfig.title} tab
(\figureref{fig:configdialog-texsettings})
allows you to adjust the text-related settings.

\widgetdef{textconfig.anchor}

If the \widget{textconfig.anchor} \gls{checkbox} is selected,
whenever you \hyperref[sec:alignobjects]{justify} a \gls{group}, any
\glspl{textarea} in that group will have their
\textattrpl{anchor} automatically adjusted.

\widgetdef{textconfig.textualshading}

\FlowframTk\ can't implement \dgls{gradient-paint} for text when
\hyperref[sec:exportpgf]{exporting} to \sty{pgf}. (This includes the
\filefn{export} functions that use \app{latex} or \app{pdflatex}, such as
the export to PDF function.) You can choose how \FlowframTk\ should export
shaded text using the \widget{textconfig.textualshading}
\gls*{dropdown}. Available options:

\begin{deflist}
\itemtitle
 {\inlineglsdef{textconfig.textualshading.average}}

\begin{itemdesc}
The text will be given the \manmsg{colour} obtained by averaging the
shading's start and end \manmsg{colour}.
\end{itemdesc}

\itemtitle
 {\inlineglsdef{textconfig.textualshading.start}}

\begin{itemdesc}
Just the shading's start \manmsg{colour} will be used.
\end{itemdesc}

\itemtitle
 {\inlineglsdef{textconfig.textualshading.end}}

\begin{itemdesc}
Just the shading's end \manmsg{colour} will be used.
\end{itemdesc}

\itemtitle
 {\inlineglsdef{textconfig.textualshading.path}}

\begin{itemdesc}
The text will be exported as a path rather than text. This means
that the \LaTeX\ alternative text attribute will be ignored. This is
equivalent to applying the 
\hyperref[sec:outlinetopath]{convert outline to path}, 
\hyperref[sec:grouping]{ungroup} and 
\hyperref[sec:mergepaths]{merge path}
functions (without actually changing your image).
\end{itemdesc}

\end{deflist}

\widgetdef{textconfig.textpathoutline}

\FlowframTk\ can't implement the text
\hyperref[sec:textoutline]{outline} option for
\glspl{textpath} when exporting to \sty{pgf}. (Again, this
includes the export functions that use \app{latex} or \app{pdflatex}.)
You can choose how \FlowframTk\ should export \gls{textpath}
outlines using the \widget{textconfig.textpathoutline}
\gls*{dropdown}. Available options:

\begin{deflist}
\itemtitle
 {\inlineglsdef{textconfig.textpathoutline.path}}

\begin{itemdesc}
The \gls{textpath} will be exported as a path rather than a
\gls{textpath}. This means that the \LaTeX\
alternative text attribute will be ignored. This is equivalent to
applying the
\hyperref[sec:outlinetopath]{convert outline to path}, 
\hyperref[sec:grouping]{ungroup} and 
\hyperref[sec:mergepaths]{merge path}
functions, without actually changing your image.
(This option will always override the shading options described
above, if the \gls{textpath} has a shading.)
\end{itemdesc}

\itemtitle
 {\inlineglsdef{textconfig.textpathoutline.ignore}}

\begin{itemdesc}
The outline attribute will be ignored.
\end{itemdesc}

\end{deflist}

\iconstartpar{textarea,math}%
\plabel[TeX Mappings]{mi:texmappings}%
\FlowframTk\ has two tools for creating \glspl{textarea}: the
regular text-mode tool (\menu{tools.textarea}) and the
\manmsg{maths}-mode tool (\menu{tools.math}). Each \gls{textarea} has an
associated \LaTeX\ alternative text which, if set, is used
during the \sty{pgf} export operations in place of the
text displayed on the \gls{canvas}. (This includes the export
functions that use \app{latex} or \app{pdflatex}, such as
the export to PDF function.) The \mathstool\ automatically
inserts \glsname{mshift} at the start and end of the
alternative text. 

\widgetdef{textconfig.escape}

If the \inlineglspluraldef{textarea-mapping} are enabled, Unicode symbols present in
the text when a new \gls*{textarea} is constructed can be mapped to
a \LaTeX\ command.
The mappings applied depend on which tool has been selected. With
the regular \texttool, all the ten \TeX\ special characters are
mapped to commands. In addition, there are some other characters
that are also mapped by default. These are listed in the table shown
in the \widget{textconfig.textmappings} tab (see
\figureref{fig:configdialog-texsettings}). If you don't want any
text mappings applied, deselect the
\widget{textconfig.escape} \gls{checkbox}.

\widgetdef{textconfig.escape_mathchar}

With the \mathstool, the \gls{hash} and \gls{percent} characters are the
only two of the ten \TeX\ special characters that are mapped by
default. However there are other mappings of \manmsg{maths}-related Unicode
characters and these are listed in the table shown in the
\widget{textconfig.mathmappings} tab (see
\figureref{fig:configdialog-mathsettings}). If you don't want
\mathsmode\ mappings applied, deselect the
\widget{textconfig.escape_mathchar} \gls*{checkbox}.

\FloatFig
  {fig:configdialog-mathsettings}
  {\includeimg{configureDialog-mathsettings}}
  {LaTeX-Related Text Settings\dash \Manmsg{maths}-Mode Mappings}

The mapping tables can be sorted by \glslink{click}{clicking} on
their column headers. You can add, delete or modify any of these
\textmode\ or \mathsmode\ mappings. Any mapping that ends with a control
word (a backslash followed by one or more letters) should
usually be followed by a space or \verb|{}| to prevent it from
running into any subsequent letter when the mapping is applied. For
\textmode\ mappings, \verb|{}| is better in case the command is
followed by an intended space, although this may depend on the
command definition. For \mathsmode\ mappings it's better
to follow the control word with a space.

One or more rows in a mapping table can be selected with the mouse.
You can use \keys{\keyref{shift}}+\gls{click} or 
\keys{\keyref{ctrl}}+\gls{click} to add to the
current selection.

\widgetdef{textconfig.textmappings.remove}

To delete a \textmode\ mapping or mappings, select the appropriate row or rows of the
\widget{textconfig.textmappings} table and click on the
\widget{textconfig.textmappings.remove} button
to the side of the table. 

\widgetdef{textconfig.mathmappings.remove}

To delete a \mathsmode\ mapping or mappings, select the appropriate row or rows of the
\widget{textconfig.mathmappings} table and click on the
\widget{textconfig.mathmappings.remove} button
to the side of the table. 

To restore all the original mappings, quit \FlowframTk\ and delete
or rename the files \file{mathmappings.prop} and
\file{textmappings.prop} in the \gls{config_dir}.

To edit an existing mapping, \gls{doubleclick} on the second and
third columns of the mapping table. The first two columns can't be
edited.

\widgetdef{textconfig.textmappings.add}
\plabel[New \TeX\ Mappings]{mi:newtexmappings}% HelpSet id
To add a \textmode\ new mapping, \gls{click} on the
\widget{textconfig.textmappings.add} button to the
side of the \widget{textconfig.textmappings} table. 

\widgetdef{textconfig.mathmappings.add}
To add a \mathsmode\ new mapping, \gls{click} on the
\widget{textconfig.mathmappings.add} button to the
side of the \widget{textconfig.mathmappings} table. 

\widgetdef{textconfig.mapping.title}

In either case, this will open the \widget{textconfig.mapping.title} mapping
dialog. Enter the character you want mapped in the
\widget{textconfig.mapping.character} box or type the hexadecimal value in the
\widget{textconfig.mapping.codepoint} box and then enter the replacement
command in the \widget{textconfig.mapping.command} box.  If the command is
defined in a package, enter the package name (without the \ext{sty}
extension) in the \widget{textconfig.mapping.package} box. If the mapping
requires multiple commands from different packages, you can specify
a comma-separated list of packages in the
\widget{textconfig.mapping.package} box. If the replacement command is
available in the \LaTeX\ kernel, you can leave this box blank.
(These packages will be automatically added to the
image's \gls{early-preamble} code (\sectionref{sec:preamble}), whenever the
mapping is applied.)

The package name may be preceded by optional arguments in square
brackets, for example \code{[weather]ifsym} (note that the package name
isn't enclosed in braces). Set the package name to \qt{none} or
leave it empty if you don't want it automatically added to the
\gls{early-preamble} code when the mappings are applied.

For example, in \figureref{fig:addTeXMapping} the new mapping dialog
is being used to define a new text mapping from the Unicode dagger
\textdagger\ symbol (U+2020) to the \csfmt{textdagger} command.
Since this command is defined in the \LaTeX\ kernel, the package
field can be left empty. The Unicode symbol can be specified either
by typing the hexadecimal code into the
\widget{textconfig.mapping.codepoint} field or by typing the actual
symbol into the \widget{textconfig.mapping.character} field. If there
is already a mapping for this Unicode symbol, the old mapping will
be overwritten.

\FloatFig
  {fig:addTeXMapping}
  {\includeimg{addTeXMapping}}
  {Adding a New Text Mapping} 

You can also import mappings from a tab-separated file (\ext{tsv})
where the first column is the hexadecimal code, the second column is
the command (or commands) and the third column is the package name
or comma-separated list of packages. Any additional columns are
ignored, as are blank lines or lines starting with \gls{hash}. The file
shouldn't contain any delimiters nor may any of
the cells contain a newline or tab character. For example,
the file may look like:
\begin{verbatim}
00260E  \Telephone      [misc]ifsym
0026A1  \Lightning      [weather]ifsym
\end{verbatim}

\widgetdef{textconfig.textmappings.import}
Import \textmode\ mappings with \widget{textconfig.textmappings.import}
in the \widget{textconfig.textmappings} tab.

\widgetdef{textconfig.mathmappings.import}
Import \mathsmode\ mappings with \widget{textconfig.mathmappings.import}
in the \widget{textconfig.mathmappings} tab.

You can find extra mappings using the Symbol Lookup page at
\url{http://www.dickimaw-books.com/latex/symbol-lookup.php} which
has a web form you can use to look up mappings in the database.  If
the mapping ends with a control word the import function will
automatically append a space for \mathsmode\ or
\verb|{}| for \textmode, unless the Unicode character type is one
of: combining spacing mark, connector punctuation, modifier symbol
or modifier letter, in which case just a space is appended.
(This adjustment isn't done for the edit mapping or
add a single-mapping functions described above. You need to do this
yourself, as I did in \figureref{fig:addTeXMapping}.) If this
adjustment isn't appropriate, you can edit the mapping to remove it.

For example, in \figureref{fig:symbolLookup}, I've selected the
\qt{Latin-1 Supplement} block with the mode set to \qt{text}. If I
then click on the \qt{Search} button at the bottom of the form, this
will list all the mappings listed in the database that match. To
import these values into \FlowframTk, you first need to download
them in the correct format. Set the \qt{Results Format}
\gls{dropdown} to TSV (\emph{not CSV}) and click on the
\qt{Search} button. Depending on your browser, this may
automatically save the file \filefmt{symbol-lookup.tsv} in your
downloads directory\slash folder or it may try to open the file.
Be careful if it tries to open the file in a spreadsheet application
as this may change the format to one that's not compatible with
\FlowframTk.

\FloatFig
  {fig:symbolLookup}
  {\includeimg[width=0.9\textwidth]{symbol-lookup}}
  {Symbol Lookup Script}

If you try this search on the Symbol Lookup page and open the file in your
\manmsg{favourite} text editor, you may notice that some codepoints are listed
multiple times. For example:
\begin{verbatim}
0000A3  \textsterling   none    text    0
0000A3  \pounds         none    both    0
\end{verbatim}
If you simply import the file into \FlowframTk, new mappings will
override the earlier mappings, so in this case the mapping for
U+A3 will be set to \csfmt{pounds} rather than
\csfmt{textsterling} so delete any of the mappings you don't want
before you import the file.

This example also produces mappings that require the \sty{fontenc}
package. For example:
\begin{verbatim}
0000AB  \guillemotleft  fontenc text    0
\end{verbatim}
This indicates commands that are part of the \LaTeX\ kernel but don't
work with the default OT1 font encoding. In my case, I've set my
\gls{preamble.default} to include
\sty{fontenc} with the T1 encoding, so I don't want that package
automatically added to my early-preamble code. To fix this, I just need to
use my text-editor's search-and-replace function to replace all instances of
\qt{fontenc} with \qt{none} before I import this file. If you don't
have this package in the default preamble, you'll need to add the appropriate
option.  For example, change the line to:
\begin{verbatim}
0000AB  \guillemotleft  [T1]fontenc     text    0
\end{verbatim}
(Again, you can use your text-editor's search-and-replace function.)
Similarly, if you want to import any of the symbol maps that include
commands from the \sty{mathdesign} package, you'll need to add
the option to set the required font. For example
\begin{verbatim}
002231  \intclockwise   [utopia]mathdesign      math    1
\end{verbatim}

Once all these modifications have been made, the file can then be
imported by clicking on the import button in the appropriate mapping
pane. In this case, I have fetched mappings that are valid in
\textmode, so I need to select the \widget{textconfig.textmappings} tab
and then click on the import button to the right of the mapping
table. This will open a file chooser which I can use to select the
TSV file.

\begin{warning}
Note that mappings take up resources and the more mappings you have,
the longer it will take to startup \FlowframTk, so it's best to only
add the mappings that you're likely to need. The symbol lookup form
on the Dickimaw Books website has a maximum limit of 500 for the search
results. (A smaller limit can be set if required. The default value
is 200.)
\end{warning}

\subsubsection{Default Preamble}\label{sec:texconfigpreamble}

\widgetdef{preambleconfig.title}

The \widget{preambleconfig.title} tab
(\figureref{fig:texconfig-preamble}) allows you to set the
\inlineglsdef{preamble.default} code that
should always be added to the preamble when exporting images to
complete \LaTeX\ documents or formats that use the encapsulated
\LaTeX\ document function as an intermediate step (see
\sectionref{sec:exportdoc}). This code isn't used for the export to
class (\ext{cls}) or package (\ext{sty}) functions.

\FloatFig
  {fig:texconfig-preamble}
  {\includeimg{texconfig-preamble}}
  {Default Preamble Code}

The \gls{preamble.default} code is stored in a file called
\file{preamble.tex} in \FlowframTk's \gls{config_dir}. If you edit
this file outside of \FlowframTk, you'll need to use the reload
button to refresh this panel. The other buttons are the same as for
the \TeX\ editor described in \sectionref{sec:texeditor}.  You can
also access these button actions through the
\gls{index.menu.texeditor} context menu, which can be opened using
a~\gls{menuclick} on the editor pane.


\subsection{Configure User Interface}\label{sec:configureuidialog}

\menudef{menu.settings.configui}

The menu item \menu{settings.configui} will open up 
the \inlineglsdef{configui.title} dialog box
in which you can adjust the user interface settings.
(\sectionref{sec:configuredialog} covers image settings
and \sectionref{sec:texconfig} covers \TeX\slash\LaTeX\ related
settings.)


\subsubsection{Graphics Settings}\label{sec:graphics}

\widgetdef{graphics.title}

\FloatFig
  {fig:graphics}
  {\includeimg{configureUI-graphics}}
  {Configuration UI Dialog Box (Graphics Settings)}

The \widget{graphics.title} tab (\figureref{fig:graphics})
allows you to make adjustments to the way the image is rendered on
the \gls{canvas}.

\widgetdef{render.anti_alias}

If enabled, use \gls{anti-aliasing} to draw the image.

\widgetdef{render.rendering}

Choose between speed or quality in the \gls{rendering}.

\widgetdef{editpathui.title}

The \widget{editpathui.title} area has the following settings that
relate to the \editpathmode.

\widgetdef{editpathui.canvasclick}

If enabled, this setting will cause a mouse \gls{click} on the
\gls{canvas} outside of any of the \glspl{controlpt} to exit
\editpathmode.

\widgetdef{editpathui.ignorelock}

If enabled, the \gridlock\ will be ignored when using the
mouse to select a \gls{controlpt} in \editpathmode.

\widgetdef{render.control.standard}

Set the \manmsg{colour} for the regular
\glspl*{controlpt} according to whether they are selected or
unselected.

\widgetdef{render.control.symmetry}

Set the \manmsg{colour} for the \gls{line-of-symmetry}
\glspl*{controlpt} according to whether they are selected or
unselected.

\widgetdef{render.control.patternanchor}

Set the \manmsg{colour} for the pattern \gls{pattern.anchor}
\glspl*{controlpt} according to whether they are selected or
unselected.

\widgetdef{render.control.patternadjust}

Set the \manmsg{colour} for the pattern 
\glspl*{pattern.adjustment-controlpt} according to whether they are selected or
unselected.

\plabel[Hotspots]{mi:hotspots}%
\widgetdef{hotspots.title}

\iconstartpar{hotspots.png,nohotspots.png}%
\Inlineglspluraldef{hotspot} are regions around an \gls*{object}['s] 
\gls{selection-bbox} that can be used to perform freehand
transformations.
You can use the \widget{graphics.title} tab to choose between
enabling (left icon) and disabling (right icon) \glspl{hotspot} along the
\glspl{selection-bbox}. If \glspl{hotspot} are enabled, you can scale, rotate or
shear \glspl{object} by dragging the appropriate \gls{hotspot}. (Note that
transforming \glspl{compositeshape} applies the transformation to
the \emph{underlying} shape not to the shape as a whole.)

You may want to disable this option when you want to move small
objects, or you may end up transforming them instead of moving them.
When this option is enabled, the cursor will change
shape when you move it over the edge of the \gls{selection-bbox}.
(The actual cursor appearance depends on the look and
feel of the platform you are using. On some systems the South and
North arrows may look the same, and similarly for the East and West
arrows.)
\figureref{fig:hotspotsa} shows how the \gls{bbox} is displayed
when \glspl{hotspot} are enabled and \figureref{fig:hotspotsb} shows
how the \gls{selection-bbox} is displayed when the \glspl{hotspot} have been
disabled. Each \gls{hotspot} is represented by a small square. Available
functions are listed in \tableref{tab:hotspotfunctions}.

\FloatTable
{tab:hotspotfunctions}
{%
\begin{tabular}{lll}
\bfseries Hotspot & \bfseries Function &
\bfseries Cursor Appearance\\
Bottom left & rotate & hand\\
Bottom \manmsg{centre} & scale vertically & South arrow\\
Bottom right & scale both directions & South-East arrow\\
Middle right & scale horizontally & East arrow\\
Top right & shear vertically & North arrow\\
Top left & shear horizontally & West arrow
\end{tabular}
}
{Hotspot Functions}
 
Note that even if you have more than one \gls{object} \selected, only the
object whose \gls{hotspot} you are dragging will be transformed.
As may be predicted, using \glspl{hotspot} is not as precise as using the
transformation dialog boxes described in
\sectionref{sec:selectobjects}.

\FloatSubFigs{fig:hotspots}
{
 {fig:hotspotsa}{\includeimg{exhotspots}}{Enabled},
 {fig:hotspotsb}{\includeimg{exnohotspots}}{Disabled}
}
{Hotspots}

\seealsorefs{sec:rotateobjects,sec:scaleobjects,sec:shearobjects}

\subsubsection{Annotations Settings}\label{sec:annotations}

\widgetdef{annotations.title}

\FloatFig
  {fig:annotations}
  {\includeimg{configureUI-annotations}}
  {Configuration UI Dialog Box (Annotations Settings)}

The \widget{annotations.title} tab (\figureref{fig:annotations})
allows you to set the font used for annotating frames or draft
\glspl{bitmap} and set the font used on the splash screen during startup.


\subsubsection{Language Settings}\label{sec:languages}

\widgetdef{lang.title}

\FloatFig
  {fig:languages}
  {\includeimg{configureUI-languages}}
  {Configuration UI Dialog Box (Language Settings)}

You can use the \widget{lang.title} tab
(\figureref{fig:graphics})
to set which language to use for the application
resources (menus, messages etc) and which language to use for
the manual. These settings will not be applied until you quit and
restart \FlowframTk.

You can also use the \widget{lang.title} tab to specify the
Unicode blocks to display in the
\hyperref[mi:insertsymbol]{symbol selector}. By default, only
a limited subsection of Unicode characters are available because it
would significantly slow \FlowframTk's startup process to provide
all possible characters. To add a new block, \gls{click} on the
green plus button next to the table. To remove an unwanted block,
select the appropriate row in the table and \gls{click} on the red minus
button. The start and end values don't need to match a complete
Unicode block and may span multiple blocks. For example, suppose you
regularly want to enter musical symbols into your image, then you
can add a block starting from 1D100 and ending at 1D1DD. You need to
quit and restart \FlowframTk\ for the changes to take effect. If you
want to restore the defaults, quit \FlowframTk, open the file
\file{flowframtk.conf} in the \gls{config_dir} and remove
the line starting with \qt{unicode=}.

\seealsorefs{sec:multilingualsupport}

\subsubsection{Accelerator Settings}\label{sec:accelerators}

\widgetdef{accelerators.title}

\FloatFig
  {fig:accelerators}
  {\includeimg{configureUI-accelerators}}
  {Configuration UI Dialog Box (Accelerators)}

You can use the \widget{accelerators.title} tab
(\figureref{fig:accelerators}) to change the default accelerators
(keyboard shortcuts). It's possible to use the same keystroke for
different actions provided the actions are never both enabled at the
same time. (For example, \accelerator{menu.editpath.next_control}
selects the next control in path edit mode or adjust the selection
in \selectmode.)

\begin{information}
Java's accessibility API uses \accelerator{action.menubarfocus} to switch
the focus to the menu bar, so avoid using this key for an
accelerator.
\end{information}

Suppose you want to change the accelerator for the \menu{edit.undo}
function from the default \accelerator{menu.edit.undo} to, say,
\keys{\keyref{ctrl}+\keyref{shift}+U}. Find the appropriate row in
the accelerator table and \gls{doubleclick} on it to open the
\widget{accelerator.set} dialog box
(\figureref{fig:setaccelerator}).

\FloatFig
  {fig:setaccelerator}
  {\includeimg{setaccelerator}}
  {Changing a keyboard shortcut.}

There are two ways to change the
keystroke. If the \widget{accelerator.set.useselector}
button is selected, you can select or deselect the required
modifiers (such as \widget{accelerator.set.shift}) and
use the drop-down box to select the keystroke. So to change the
keystroke to \keys{\keyref{ctrl}+\keyref{shift}+\actualkey{U}}, select the
\widget{accelerator.set.shift} and
\widget{accelerator.set.ctrl} \glspl{checkbox} and set the drop-down
box to \widgetfmt{pressed U}.

Alternatively, if the \widget{accelerator.set.usekeystroke} button
is selected you can type the required keystroke in the
\widget{accelerator.set.usekeystroke.label} field. Care must be
taken with this option. You need to make sure you release the main
key before releasing the modifiers. For example, press down the
\desckeyref{ctrl}, \desckeyref{shift} and \keys{\actualkey{U}} keys
but release the \keys{\actualkey{U}} key before releasing the
\keys{\keyref{ctrl}} and \keys{\keyref{shift}} keys. 

Note that the \desckeyref{tab} key retains its usual
function of moving the focus to the next component in the window,
and so can't be typed in the
\widget{accelerator.set.usekeystroke.label} field. (Neither
can certain other keys that are always intercepted by the operating
system.) The \desckeyref{return} key, on the other hand, will be picked up
by the \widget{accelerator.set.usekeystroke.label} field
if it has the focus, so you need to ensure you move the focus to a
different component if you want to use \keys{\keyref{return}} to activate the
\btn{okay} button.

The accelerator settings are written to a file called
\inlineglsdef{file.accelerators.prop} in the \gls{config_dir} when
\FlowframTk\ quits normally. You may edit this file using your
preferred text editor to change the settings as long as \FlowframTk\
isn't currently running. For example, if you want to change all the
keystrokes that require the control key to be pressed to requiring
the meta key pressed instead, you may find it easier to do a global
search and replace in \file{accelerators.prop} of \code{ctrl}
with \code{meta}. If you do edit this file, make sure you only
edit the values to the right of the \code{=} sign. To restore the
default accelerators, delete or rename this file (when \FlowframTk\
isn't running).

\subsubsection{Toolbar, Ruler and Status Bar Settings}\label{sec:rulers}

\widgetdef{borders.title}

\FloatFig
  {fig:rulers}
  {\includeimg{configureUI-rulers}}
  {Configuration UI Dialog Box (Toolbar, Ruler and Status Bar Settings)}

You can use the \widget{borders.title} tab (\figureref{fig:rulers})
to customise the \glspl{ruler}, \glspl{toolbar} and \gls{statusbar}.
You can show or hide the \glspl{toolbar} using the
\widget{borders.showtools} checkbox. If this check box is selected,
you can also specify the location of the vertical toolbar.

\iconstartpar{toolbarleft,toolbarright}%
The vertical toolbar is located on the left of \FlowframTk's main
window by default, but can be switched to the right by selecting the
\widget{borders.vtoolbar} \widget{borders.vtoolbar.right} radio
button. You will need to quit and restart for the change to take
effect.

The width (in pixels) of the vertical ruler can be specified in the
\widget{borders.rulerwidth} field, and the height (in pixels) of
the horizontal ruler can be specified in the
\widget{borders.rulerheight} field. For example, if you find that
the $y$ co-ordinates don't fit on the vertical ruler, you can make the
ruler wider, say, to 30 pixels. There's a sample panel on the right
that shows the dimensions (but doesn't show the ruler annotations).

The way the co-ordinates appear on the rulers is governed by the
\widget{borders.rulerpattern} field.  The pattern syntax is as for
\href{https://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html}{\filefmt{java.text.DecimalFormat}},
described in the Java API.  You can also set the locale governing
the pattern, but this pattern is only applied to the \glspl{ruler},
not to the co-ordinate dialog boxes or \gls{statusbar}. The font
used by the rulers can also be changed.  This panel doesn't provide
a setting to show or hide the rulers as this is done for the
currently selected \gls{canvas} using the main menu item
\menu{settings.rulers}.

You can show or hide the \gls{statusbar} using the
\widget{borders.showstatus} check box. If this box is
selected, you can additionally choose to show or hide the
individual \gls{statusbar} elements.

\seealsorefs{sec:thetoolbars,sec:therulers,sec:thestatusbar}

\subsubsection{Normalization}\label{sec:normalize}

\widgetdef{normalize.title}

\FloatFig
  {fig:normalize}
  {\includeimg{configureUI-normalize}}
  {Configuration UI Dialog Box (Normalization)}

When an image is \glslink{painting}{drawn} on the \gls{canvas} via Java's painting
methods, the co-ordinates of all the objects are converted into
PostScript points (including any scaling applied by the zoom
settings). However, it is rare for any display device, such as a
standard monitor, to have pixels that are exactly one PostScript point square
in size. This means that a 1in (or 72\gls{bp}) line drawn on the
screen at 100\% magnification may not actually measure 1in if you
hold a ruler up against the screen. This is fairly typical for
most graphical applications but, if it bothers you, you can
adjust the horizontal and vertical normalization factors used by
\FlowframTk\ in the \widget{normalize.title} tab
(\figureref{fig:normalize}).

If you happen to already know the normalization factors
for your device, you can enter them in the
\widget{normalize.norm.x} and
\widget{normalize.norm.y} fields. If you don't know them,
\FlowframTk\ can compute them for you. To do this, you need to hold
a ruler against the \widget{normalize.nonorm_horizontal}
line, enter the measurement in the length field below the line and
\gls{click} on the \widget{normalize.x_compute_norm} button. This
will insert the normalization factor into the
\widget{normalize.norm.x} field. Next, hold the ruler
against the \widget{normalize.nonorm_vertical} line, enter
the measurement in the length field below that line and \gls{click} on the
\widget{normalize.y_compute_norm} button. This will insert
the normalization factor into the \widget{normalize.norm.y}
field. You then need to \gls{click} on the okay button to set these
normalization factors.

\subsubsection{\TeX\ Editor Settings}\label{sec:texeditorui}

\widgetdef{texeditorui.title}

\FloatFig
  {fig:texeditorui}
  {\includeimg{configureUI-texeditorui}}
  {Configuration UI Dialog Box (TeX Editor Settings)}

\FlowframTk\ has small text editor that's opened when you want to
edit the contents of a static or dynamic frame.
The font used by this editor can be changed in the
\widget{texeditorui.title} tab (\figureref{fig:texeditorui}).
You can also set the default width (in terms of approximate number
of characters per line) and the default height (in terms of lines)
for the editor when it's first created at startup. You can also
enable or disable syntax highlighting by selecting or deselecting
the button marked \widget{texeditorui.highlight}. If
selected, you can also set the \manmsg{colour} used for comments
(indicated by \TeX's \glssymbol{percent} comment character) or for commands. The
editor currently doesn't have any spell-checking support.
The \hyperref[sec:texconfigpreamble]{default preamble} panel
of the \dialog{texconfig} dialog also
uses these settings.

In \FlowframTk\ version 0.7, this editor window was also used for changing the
preamble text, but as from version~0.8, the preamble editor has been
switched to a pane attached to the \gls{canvas} that can remain open
while you're editing the image. This pane uses these settings,
except for the default width and height, which is now governed
by the size of the \gls{canvas} window and the location of the
divider. By default, the preamble pane is to the right of the
\gls{canvas}, but you can change this using the radio buttons in the
\widget{texeditorui.split} area.

\seealsorefs{sec:thepreamblepane,sec:flowframe,sec:texeditor}

\subsubsection{Look and Feel Settings}\label{sec:lookandfeel}

\widgetdef{lookandfeel.title}

\FloatFig
  {fig:lookandfeel}
  {\includeimg{configureUI-lookandfeel}}
  {Configuration UI Dialog Box (Look and Feel Settings)}

Java displays \gls{gui} elements, such as buttons and menus,
according to the selected \qt{\gls{look-and-feel}}. There are a number of
different \glspl{look-and-feel} that may, or may not, be available on your
platform. Some of the \glspl{look-and-feel} don't support certain features
such as the click-to-collapse setting on the divider bar in split
panes, including the divider between the \gls{canvas} and the preamble
pane. The \widget{lookandfeel.title} tab has a
\gls{dropdown} with the list of available \gls{look-and-feel}. For
example, \figureref{fig:lookandfeel} has the \qt{Metal} look and
feel selected. You can change this to a different \gls{look-and-feel}, but
you must restart \FlowframTk\ for the change to be implemented.

Some example \glspl{look-and-feel} are shown in \figureref{fig:lookandfeelex}.
Note that the main window's title bar and outer border isn't
governed by Java's \gls{look-and-feel}, but by the operating
system's window manager. For example, I've used different window
themes whilst taking snapshots of \FlowframTk\ for this manual,
which is why the \manmsg{colour} and format of the title bar for the main
window and for the dialog boxes vary.

\FloatSubFigs{fig:lookandfeelex}
{
  {fig:lookandfeelex-metal}
    {\includeimg[alt={Metal Look and Feel}]{lookandfeel-metal}}{Metal},
  {fig:lookandfeelex-nimbus}
    {\includeimg[alt={Nimbus Look and Feel}]{lookandfeel-nimbus}}{},
  {fig:lookandfeelex-cdemotif}
    {\includeimg[alt={CDE\slash Motif Look and Feel}]{lookandfeel-cdemotif}}{},
  {fig:lookandfeelex-gtk}
    {\includeimg[alt={GTK+ Look and Feel}]{lookandfeel-gtk}}{}
}
[Look and Feel Examples]
{Look and Feel Examples:
\subfigref{fig:lookandfeelex-metal} Metal;
\subfigref{fig:lookandfeelex-nimbus} Nimbus;
\subfigref{fig:lookandfeelex-cdemotif} CDE\slash Motif;
\subfigref{fig:lookandfeelex-gtk} GTK+}

In addition to changing the look and feel, you can also change how
the buttons that have icons are displayed. By default, the buttons
with icons have a bevel bordered style, with a different icon image for
the up, down, rollover and disabled states, but if you don't like
them, you can select a different type from the
\widget{lookandfeel.button.style} area. Each type has some sample
buttons displayed on the right. They don't perform any actions, but
you can press them to try them out. The button types come in the
following \manmsgpl{flavour}:

\begin{deflist}
\itemtitle{Bordered}

\begin{itemdesc}
This is the default button type described above.
These buttons have distinctive up and down states regardless of the
\gls{look-and-feel}.
\end{itemdesc}

\itemtitle{Small Bordered}

\begin{itemdesc}
Similar to bordered but a smaller version.
\end{itemdesc}

\itemtitle{Plain}

\begin{itemdesc}
This has a single icon image for the button. The up and
down look is dealt with by the \gls{look-and-feel}. This means that if the
selected look and feel doesn't draw an up or down effect, you won't
be able to see the button state.
\end{itemdesc}

\itemtitle{Small Plain}

\begin{itemdesc}
Similar to plain but a smaller version.
\end{itemdesc}

\itemtitle{Highlights}

\begin{itemdesc}
This is like plain but there is a
second icon for the down state of radio and check buttons that is
like the up state but has a highlighted background. This means that
you can now see a difference between the up and down states for the
radio and check buttons when used with a \gls{look-and-feel} style that
doesn't draw an up or down effect.
\end{itemdesc}

\itemtitle{Small Highlights}

\begin{itemdesc}
Similar to highlights but a smaller version.
\end{itemdesc}

\itemtitle{Bordered Switches}

\begin{itemdesc}
Uses the plain type for press buttons and
the bordered type icons for radio and check buttons. Unlike the
default bordered style, in this case the bordered icons also include
the \gls{look-and-feel}['s] up and down effect (where supported).
\end{itemdesc}

\itemtitle{Small Bordered Switches}

\begin{itemdesc}
Like bordered switches but a smaller version.
\end{itemdesc}

\end{deflist}

Some of these styles also display a textual label, which may be
above, below, to the left or to the right of the icon.
Alternatively, you can just select the text only option. If you
prefer to have a different style for the dialog windows, you can
uncheck the \widget{lookandfeel.dialog.as_general} button,
which will display a set of button styles that you can apply to the
dialog windows. For example, \figureref{fig:icontext} shows the
dialog window from \figureref{fig:graphics} with the
small icons and trailing text dialog button option.

As with the look and feel setting, you must restart \FlowframTk\
before the changes can be implemented.

\FloatFig
  {fig:icontext}
  {\includeimg{configureUI-graphics-icontext}}
  {Dialog Buttons with Small Icons and Trailing Text}


\section{Configuration Directory}\label{sec:configdir}


When you quit \FlowframTk, the settings will be saved in
\FlowframTk's \inlineglsdef{config_dir}.  This directory is
determined (and created if necessary) as follows:

\begin{itemize}
  \item If the environment variable \gls{JDRSETTINGS} exists
        and is a directory, that directory is used.

  \item If \FlowframTk\ detects the existence of \gls{JpgfDraw}['s]
        configuration directory, that will be used. If the file
        \file{jpgfdraw.conf} exists in that directory but the file
        \file{flowframtk.conf} doesn't exist, \FlowframTk\ will load the
        settings from \file{jpgfdraw.conf} and then save the new settings to
        \file{flowframtk.conf}. If you like, after you have quit
        \FlowframTk, you can remove the now unneeded file
        \file{jpgfdraw.conf} and rename the directory \file{.flowframtk} or
        \file{flowframtk-settings}, as appropriate.

  \item If the directory \file{home/.flowframtk} exists
        and is a directory, that directory is used (where
        \meta{home} indicates the user's home directory as given
        by the Java \code{user.home} property).

  \item If the directory \file{home/flowframtk-settings} exists
        and is a directory, that directory is used.

  \item If the operating system (as identified by the Java \code{os.name}
        property) is a version of Windows and the
        directory \file{home/flowframtk-settings} can
        be created, that directory is used.

  \item For other operating systems, if the directory
        \file{home/.flowframtk} can be created, that
        directory is used.

  \item If the directory \file{settings/user} or
        \file{settings} can be created in \FlowframTk's
        installation directory, that directory will be used
        (where \meta{user} is the current user's user name). This is
        sub-optimal and not recommended as it may be removed when
        upgrading to a new version.

  \item If none of the above, an error will occur and you will need
        to set the environment variable \gls{JDRSETTINGS} to
        a sensible location with read and write permissions.

\end{itemize}

The configuration directory may also contain:
\begin{itemize}
\item the list of \hyperref[sec:recentfiles]{recent files}
(written by \FlowframTk\ when it quits normally);

\item the \hyperref[sec:accelerators]{accelerator settings}
file \file{accelerators.prop}
(written by \FlowframTk\ when it quits normally);

\item the \mathsmode\ and \textmode\
\hyperref[sec:texconfigtext]{character mapping} files,
\file{mathmappings.prop} and \file{textmappings.prop}
(written by \FlowframTk\ when it quits normally);

\item the \hyperref[sec:preamble]{preamble} file \file{preamble.tex}
(created by you, if you want it, in any text editor) used by some of
the \filefn{export} functions
(see \sectionref{sec:texconfigpreamble});

\item the \file{languages.conf} file that stores the
\hyperref[sec:languages]{language settings} used for the resources and manual;

\item the \file{startup.conf} file that stores the names of the
fonts used by the \hyperref[sec:graphics]{startup splash screen};

\item the \file{latexfontmap.prop} file (created by you, if you want
it, in any text editor) that contains any \glspl{font-mapping} (see
\sectionref{sec:fontfamily}).  For compatibility with
\gls{JpgfDraw}, the file may simply be \filefmt{latexfontmap}
without an extension.

\end{itemize}

In addition, the configuration directory is used to save the log
file, \file{flowframtk.log}, in the event that
\accelerator{menu.debug.writelog} is used (or \menu{debug.writelog}
if the command line option \switch{debug} is used). The emergency
save all function \accelerator{menu.debug.dumpall} (or
\menu{debug.dumpall} if the command line option \switch{debug} is
used) will create a subdirectory (using the current date and time to
construct the name) and will save all open images to that directory
with filenames of the form \file{imagen.jdr}.

\chapter{The Basics}\label{sec:thebasics}

\FloatFig
  {fig:mainwindow}
  {\includeimg{jpdwindow}}
  {The Main Window}

\FlowframTk\ uses a \gls{mdi}. This means that you can have multiple
images loaded in separate child windows, without having to start up
new instances of \FlowframTk\ (these can be selected or rearranged
with the \menu{window} menu). Most of the buttons and menu items
will only be applied to the child window that currently has the
focus. If there are no child windows, or if they have all been
minimized, then the relevant buttons and menu items will be disabled.
The only exceptions are the non-\gls{canvas} specific items.
The main \FlowframTk\ window is shown in \figureref{fig:mainwindow}.

\section{The Canvas}\label{sec:thecanvas}

The \inlineglsdef{canvas} is the white area (that may optionally
have a~\gls{grid}) in each of \FlowframTk's child windows on which you create
your picture. It shares a~child window with the
\gls{preamble-and-document-text-editor-area}.

In \selectmode\ (but not when you're editing or
distorting a shape) you can \gls{drag-and-drop} image files or
text onto the canvas to add to the current image. With the
\texttool\ or \mathstool\ you can only \gls{drag-and-drop} text onto
the canvas. If you attempt to drop a file instead, you will get a
new \gls{textarea} containing the file's path (or URI). 

\section{The Preamble and Document Text Editor Area}\label{sec:thepreamblepane}

The \inlineglsdef{preamble-and-document-text-editor-area} is, by default, on the
right of the \gls{canvas}, which may be used to specify code that
should go in the document preamble or (where applicable) the
content of the \env{document} environment of exported files.  (This includes
exports that use \LaTeX\ as an intermediate step, such as export to PDF.)

This \gls{editor-area} is split into tabs for the \gls{early-preamble} code,
the \gls{mid-preamble} code, the \gls{late-preamble} code,
the content of the \env{document} environment and an area for
\glspl{magic-comment} or \glspl{directive} (the last two are
only applicable with \gls{flowframe} exports that create a complete
\LaTeX\ document).

The \gls{canvas} and \gls{editor-area} are separated by a divider that can be adjusted to
allow one side to take up more room in the window. This can be done
by dragging the divider.  With some \glspl{look-and-feel}, the
divider has small triangular buttons which you can click on to
collapse or expand one side, but not all have this function nor can
some of them completely hide the editor area (such as the GTK+
Look and Feel).  You can also use the \menu{tex.set_preamble} menu
item to show the editor area.

See \sectionref{sec:preamble} for further details on how this
code is added during the export process, and
see \sectionref{sec:configureuidialog} to set a default preamble
for all images and to reposition the \gls{preamble-and-document-text-editor-area}.

\section{The Toolbars}\label{sec:thetoolbars}

There are two \inlineglspluraldef{toolbar}.  The horizontal toolbar positioned at
the top of the main window, which allows you to manipulate
\glspl{object} on the \gls{canvas} (as well as the save, load and
new buttons) and the vertical toolbar positioned to the left of the
main window, which you can use to create new \glspl{path} and
\glspl{textarea}. If a toolbar is too wide\slash tall, scroll buttons will
appear.

You can show or hide the \gls{toolbar} or change the location of
the vertical toolbar so that it appears on the right of \FlowframTk's
main window using the \widget{borders.title} tab in the
\dialog{configui} dialog.

Each tab of the \gls{editor-area} has its own
toolbar with buttons to edit the preamble code and document text.


\section{The Rulers}\label{sec:therulers}

There are two \inlineglspluraldef{ruler}.The horizontal ruler
positioned above the \gls{canvas} which marks out the $x$-ticks, and
the vertical ruler positioned to the left of the \gls*{canvas} which
marks out the $y$-ticks. The gap between tick marks can be changed
using the \menu{settings.grid.settings} menu item.

You can show or hide the \glspl*{ruler} using the menu item
\menu{settings.rulers}.  You can adjust their size and number format
using the \widget{borders.title} tab in the \dialog{configui}
dialog box. When the rulers are visible, the grid unit is displayed
in the corner between the rulers. You can \gls{doubleclick} on this
corner to open the grid settings dialog.

\section{The Status Bar}\label{sec:thestatusbar}

\FloatFig
  {fig:statusbar}
  {\includeimg{annoteStatusBar}}
  {The Status Bar}

The \inlineglsdef{statusbar} (\figureref{fig:statusbar}) is positioned along
the bottom of the main window. This has the following elements:

\begin{itemize}

\item The current position of the pointer (or the pointer's last
position before it was moved away from the \gls{canvas}). You can
\gls{doubleclick} on this area to open the \dialog{goto} dialog.

\item The \hyperref[sec:controlsettings]{storage unit}. You
can \gls{doubleclick} on this to open the storage unit selector.

\item The file status area.  If the current picture has been modified, it
will display the word \qt{\gls{info.modified}}, otherwise it
will be blank.

\item The \gridlock\ indicator. This shows if the \gridlock\ is on
\includeimg{key} or off \includeimg{keycross}. You can
\gls{doubleclick} on this area to toggle the \gridlock\ setting as an
alternative to using the \menu{settings.grid.lock} menu item or
button.

\item The current magnification. You can adjust this value by
\glslink{click}{clicking} on the plus or minus icons to move up or
down the pre-defined list of zoom settings. Alternatively, in the area
between them where the magnification value is displayed, you can
\gls{menuclick} to popup a~menu or \gls{doubleclick} to open the
\dialog{zoom} dialog.

\item A help button \includeimg{statushelp} that you can \gls{click} on
to open the manual at the section related to the current operation.
This button is only present when the current operation has a section
in the manual. You may also use the keyboard shortcut
\accelerator{contexthelp}.

\item A brief message about the currently selected tool or
operation. If the message is too long to fit in the provided area,
you can \gls{doubleclick} on it to open the \dialog{info} dialog window with the
full message.

\end{itemize}

\widgetdef{info.title}

The \dialog{info} dialog (\figureref{fig:information}) has two
buttons: \widget{close} (closes the dialog) and \widget{help} (opens
the manual at the applicable page, as per the \gls{statusbar} help
button, but also closes the \dialog{info} dialog). If the focus has
switched to the \gls{canvas} or \gls{editor-area}, you will need to
use \accelerator{contexthelp} not \accelerator{help} if you want to
use a keyboard shortcut. Note that in this case the \dialog{info}
dialog won't be automatically closed as the
\accelerator{contexthelp} shortcut is equivalent to clicking on the
help button in the status bar.

\FloatFig
  {fig:information}
  {\includeimg{informationDialog}}
  {The Information Dialog}

You can show or hide the \gls*{statusbar}, or elements within the
bar, using the \dialog{configui} dialog. You can also use this
dialog to change the font used in the \gls*{statusbar}.

\section{The Window Menu}\label{sec:thewindowmenu}
\menudef{menu.window}

If you have multiple images open,
the \menu{window} menu provides a convenient way of bringing 
another image into view or tiling images so that all images can be
viewed at the same time.

\menudef{menu.window.tile}

The \menu{window.tile} menu will tile all open images.

\menudef{menu.window.vertically}

The \menu{window.vertically} menu will arrange all open images
vertically.

\menudef{menu.window.horizontally}

The \menu{window.horizontally} menu will arrange all open images
horizontally.

\menudef{menu.window.minimize}

The \menu{window.minimize} will minimize all open images.

\menudef{menu.window.maximize}

The \menu{window.maximize} will maximize all open images.

\section{Common Dialog Buttons}\label{sec:commonwidgets}

Some menu items open dialog boxes. Many of them share some common
buttons.

\widgetdef{button.okay}

The \widget{okay} button applies the settings in the dialog and
closes the dialog window.

\widgetdef{button.cancel}

The \widget{cancel} button discards any changes that have been made
and closes the dialog window.

\widgetdef{button.help}

The \widget{button.help} button may be used to open a help
window for the section that describes the dialog box (see
\sectionref{sec:secondaryhelp}).

\widgetdef{button.default}

The \widget{button.default} button may be used to restore default
settings.

\widgetdef{button.choose}

The \widget{button.choose} button (\btn{choose}) opens a new dialog in which you
can choose a sub-setting from the main dialog window.

\widgetdef{button.selectfile}

The \widget{button.selectfile} button (\btn{selectfile}) opens a file chooser in
which you can choose a file or (if applicable) a directory.

\chapter{The File Menu}\label{sec:filemenu}

\menudef{menu.file}

You can use the \menu{file} menu to create a
\hyperref[sec:newimage]{new} picture,
\hyperref[sec:loadimage]{load} a picture from a
\gls{JDR} or \gls{AJR} file,
\hyperref[sec:saveimage]{save} the current picture,
\hyperref[sec:exportimage]{export} the current
picture to a supported format (such as a \LaTeX\ file),
\hyperref[sec:imagedescription]{assign a description} to the
current picture, \hyperref[sec:print]{print} the
current picture or \hyperref[sec:quit]{quit} \FlowframTk.

\section{New}\label{sec:newimage}

\menudef{menu.file.new}

To start a new picture, select \menu{file.new}. This will open
a new child window. You can switch between child windows using the
\menu{window} menu.

\section{Open}\label{sec:loadimage}

\menudef{menu.file.open}

To load a \gls{JDR} or \gls{AJR} file, select \menu{file.open}.
If there is already a picture in the current child window, a new
child window will open to display the file. Note that although
\FlowframTk\ can export to other formats, it only has limited
import capability, so be sure to save your images as 
\gls{JDR} or \gls{AJR} files.

If you load an image that contains a link to a \gls{bitmap} and
the bitmap is no longer in the same location, you will be prompted
for a new link or you can discard the link. Note that if you
select a new link, the \LaTeX\ link will also be updated.
If there is insufficient memory in the \gls{jre} to load a bitmap,
\FlowframTk\ will revert to draft mode for that bitmap.

On some systems you may be able to \gls{drag-and-drop} \gls*{JDR} or
\gls*{AJR} files from a filer window onto \FlowframTk's internal desktop
(the \manmsg{grey} background of \FlowframTk's main window) and this
will load each file into \FlowframTk. If you drag and drop a
\gls{bitmap} it will be equivalent to \hyperref[sec:newimage]{creating a
new image} and then \hyperref[sec:insertbitmap]{inserting the bitmap}.

For example, in \figureref{fig:dnda} three \gls{JDR} files and
a PNG file have been selected and then dragged onto \FlowframTk's
desktop, \figureref{fig:dndb}. This results in four child
windows, \figureref{fig:dndc}, where one of them is a new
untitled image with the link to the \gls{bitmap} inserted.

\FloatSubFigs{fig:dnd}
{
  {fig:dnda}{\includeimg{dnd1}}{},
  {fig:dndb}{\includeimg{dnd2}}{},
  {fig:dndc}{\includeimg{dnd3}}{}
}
{Drag and Drop onto \FlowframTk's Internal Desktop}

If you want to open an image in a new child window using drag and drop,
make sure you drop onto \FlowframTk's desktop. If you drop a file onto a
text area, such as the preamble pane or the text field used to
create a new \gls{textarea} then the filename (or URI) will be
inserted instead. If you drop onto a \gls{canvas}, the file contents
will be added to the current image (in the case of a \gls{JDR} or
\gls{AJR} file) or a link will inserted into the current image (in the
case of a \gls{bitmap} file). You can only drop a file onto the
\gls{canvas} in \selectmode\ (when no objects are being distorted or
edited).

\section{Recent Files}\label{sec:recentfiles}

\menudef{menu.file.recent}

To load a recently used \gls{JDR} or \gls{AJR} file, use the sub
menu \menu{file.recent}. A maximum of ten files, starting with the
most recently used are listed. Note that loading a file from this
list will change the open file chooser directory to that file's
directory.

\section{Image Description}\label{sec:imagedescription}

\menudef{menu.file.image_description}

You can use the \menu{file.image_description} dialog box to give the
image a description. The description is not visible in the image,
but may be saved as a comment if you \filefn{export} the image. If
you have the \widget{clssettings.pdfinfo} option selected,
the image description will be added to an exported \LaTeX\ document
using \gls{flowframtkimageinfo} (if \sty{flowframtkutils} is
detected) or in the \gls{pdfinfo/Title} attribute of the
\gls{pdfinfo} argument (otherwise).

\section{Save and Save As}\label{sec:saveimage}

\menudef{menu.file.save}
\menudef{menu.file.save_as}

You can save the current picture in \FlowframTk's native
\gls{JDR} (binary) or \gls{AJR} (ASCII) format using either
\menu{file.save} (if it already has a name)
or \menu{file.save_as} (if you want to specify the
filename).  I strongly recommend that you save your work frequently.
There is no auto-save function. The \gls{JDR} format can store
higher precision values than the \gls{AJR} format.

\section{Export}\label{sec:exportimage}

\menudef{menu.file.export}

\FloatFig
 {fig:export-pgfpicture-dialog}
 {\includeimg{export-pgfpicture-dialog}}
 {Export Dialog}

The \menu{file.export} menu item allows you to export your image
as a \inlineglsdef{ext.tex}, \inlineglsdef{ext.sty},
\inlineglsdef{ext.cls}, \inlineglsdef{ext.pdf} or
\inlineglsdef{ext.png} file. You may also export to a
\inlineglsdef{ext.ps}, \inlineglsdef{ext.eps} or 
\inlineglsdef{ext.svg} file, but you will need to enable export support for
PostScript and \gls{svg} first.

\begin{warning}
\FlowframTk\ only has very limited import capability, so I
strongly recommend that you first save the picture as a
\gls{JDR} or \gls{AJR} file before exporting it, in case you
wish to edit it later.
\end{warning}

The \menu{file.export} menu item will open the \dialog{export} dialog box
(\figureref{fig:export-pgfpicture-dialog}), which provides a way to
specify the name and location of the file as well as what format to
export to and what settings to apply. 

\begin{information}
\FlowframTk\ is designed to produce files suitable for inclusion in
\LaTeX\ documents. As such, you will need a \TeX\ distribution for
most of the export formats, particularly those that use an external
process.
\end{information}

\widgetdef{export.title}

At the top of the \dialog{export} dialog is the
\inlineglsdef{export.file} field for the path to
the desired export file. You can either type in the full path or use
the \widget{selectfile} button at the side to open the file chooser.

\widgetdef{export.format}

Below the \widget{export.file} field is the \widget{export.format} area where you
can select the required export format.
There are two different types of data to export: the actual image as
shown on the \gls{canvas} (or as close as can be obtained given the
export format) or the \gls{flowframe} data associated with the
image (that is, the \gls{typeblock} and any \gls{flowframe} data
associated with any of the \glspl{object} that make up the image).

\widgetdef{export.format.image_type}

The \widget{export.format.image_type} row is for exporting the
actual image. Available image exports are:
\begin{deflist}
\itemtitle{\widget{export.pgfpicture}}
\begin{itemdesc}
Create a file that just contains the \env{pgfpicture} environment,
which can be included in a \LaTeX\ document with \gls{input}
or (provided by \sty{flowframtkutils}) \gls{includeteximage}.

This is the default export type and is the current setting shown in
\figureref{fig:export-pgfpicture-dialog}. Remember to include 
\sty{flowframtkutils} in your document. If \FlowframTk\ can't detect
\sty{flowframtkutils} on \TeX's path, it will assume it's not
available and the exported file will include comments about how to
define the required commands.
\end{itemdesc}

\itemtitle{\widget{export.imagedoc}}

\begin{itemdesc}
Create a file that's a complete single-paged \LaTeX\ document that
has no page header or footer and the document environment simply
contains the \env{pgfpicture} environment that renders the image.
The \env{pgfpicture} environment will be encapsulated with
\gls{jdrimagebox} (provided by \sty{flowframtkutils}).
The page size will depend on the \widget{export.bounds} setting.
If \FlowframTk\ can't detect \sty{flowframtkutils} on \TeX's path,
it will include the relevant command definitions.

You can then compile (typeset/build) the exported file using your
usual document build method (such as running \app{pdflatex}).
However, if you want \FlowframTk\ to do this for you, use the 
\widget{export.imagepdf} export setting instead.
\end{itemdesc}

\itemtitle{\widget{export.imagepdf}}

\begin{itemdesc}
A convenient shortcut that creates a temporary directory, 
exports a complete single-paged \LaTeX\
document, as per the \widget{export.imagedoc} method, to that
temporary location, compiles the document, and copies the resulting
PDF file to the location specified in the file field. The temporary
directory will then be deleted.
\end{itemdesc}

\itemtitle{\widget{export.png}}

\begin{itemdesc}
There are two possible ways of exporting the image to a PNG file.
The first is for \FlowframTk\ to create PNG data that replicates
the way the image is \glslink{painting}{drawn} on the \gls{canvas}
(at 100\% magnification and without annotations or
\glspl{selection-bbox}), optionally cropped either to the image's
bounding box or (if set) the \gls{typeblock}. You can choose whether
or not to include the alpha channel (which provides transparency).

The second method is for \FlowframTk\ to create the PNG using a PDF
file as an intermediate step. This basically works in much the same
way as the \widget{export.imagepdf} function but after the PDF is
created, a PDF to PNG tool is used to create the PNG file from the
PDF file.
\end{itemdesc}

\itemtitle{\widget{export.eps}}

\begin{itemdesc}
The export to EPS function is no longer available by default but can
be enabled with the \widget{processes.support_eps_svg} setting in 
the \widget{processes.title} tab of the \dialog{config} dialog.

This works in much the same way as the \widget{export.png} option.
You can either get \FlowframTk\ to write the EPS content directly
(which doesn't fully support all features) or you can use external
processes to create the file from a temporary \LaTeX\ document.
In this case, it's necessary to use the DVI \app{latex} rather than
\app{pdflatex}, followed by \app{dvips}.
\end{itemdesc}

\itemtitle{\widget{export.svg}}

\begin{itemdesc}
As with the export to EPS function, the export to \gls{svg} function is no
longer available by default but can be enabled with the
\widget{processes.support_eps_svg} setting in the
\widget{processes.title} tab of the \dialog{config} dialog.

This works in much the same way as the \widget{export.eps} option.
In this case, \app{dvisvgm} is used instead of \app{dvips}.
\end{itemdesc}

\end{deflist}

\widgetdef{export.format.flf_type}

The \widget{export.format.flf_type} row is for exporting the
\gls{flowframe} data. (Ensure that you have at least version 2.0 of
the \sty{flowfram} package installed.) The buttons in this row are only enabled when
the image has a \gls{typeblock} set
(see \sectionref{sec:exportsty}). Available \gls{flowframe}
exports are:
\begin{deflist}
\itemtitle{\widget{export.cls}}

\begin{itemdesc}
Create a \LaTeX\ class file which loads the \sty{flowfram} package.
\end{itemdesc}

\itemtitle{\widget{export.sty}}

\begin{itemdesc}
As \widget{export.cls} but creates a \LaTeX\ package rather than a
class.
\end{itemdesc}

\itemtitle{\widget{export.flfdoc}}

\begin{itemdesc}
As \widget{export.cls} but creates a complete \LaTeX\ document instead.
If no \gls{document-body} has been set, default content will be
created according to the page lists specified in the \gls{flowframe}
data assigned to \glspl{object}.
\end{itemdesc}

\itemtitle{\widget{export.flfpdf}}

\begin{itemdesc}
A convenient shortcut that creates a temporary directory, 
exports a complete document, as per the \widget{export.flfdoc} method, to that
temporary location, compiles the document, and copies the resulting
PDF file to the location specified in the file field. The temporary
directory will then be deleted.
The PDF may only be a single page if all page lists are set to
\qt{all} or if the \gls{document-body} is less than a page long but, 
unlike the \widget{export.imagepdf} option,
the resulting PDF may have multiple pages.
\end{itemdesc}
\end{deflist}

\widgetdef{export.remember}

The \widget{export.remember} checkbox (located on the bottom left)
may be used to remember the current settings. If this checkbox is
selected, the currently available settings will be updated when the
image or \gls{flowframe} data is exported. Any settings that are
currently hidden won't be changed.

There are common settings shared by the different export functions.
These are described below.

\widgetdef{export.bounds}

The \widget{export.bounds} panel isn't always available, but when it
is, it may be used to specify the bounds of the exported image (the
page size for \widget{export.imagedoc} and any export settings that
that's based on that function).
It's not available for any of the \widget{export.format.flf_type}
functions.

\widgetdef{export.bounds.papersize}

The bounds should be set to the \gls{canvas}['s] paper setting. This
option is not available for the \widget{export.pgfpicture} function.

\widgetdef{export.bounds.image}

The bounds should be set to the image's bounding box.
Note that this may not be correct if different fonts or alternative
text in \glspl{textarea} are wider in the \LaTeX\ document than they
are when drawn on the \gls{canvas}.

\widgetdef{export.bounds.typeblock}

The bounds should be set to the image's \gls{typeblock}.
This option is not available if the image doesn't have a
\gls{typeblock} set.

\widgetdef{export.markup}

The \widget{export.markup} options are only applicable for the
\widget{export.format.image_type} functions that either create a
\LaTeX\ file or use a complete \LaTeX\ document as an intermediate
step. The markup is a command or pair of commands inserted into
the code in the body of the \env{pgfpicture} environment.
The following settings are available:

\widgetdef{export.markup.none}

No markup is added to the exported image.

\widgetdef{export.markup.paired}

Each object in the \env{pgfpicture} environment is book-ended by
\cmddef{flowframtkstartobject}
and
\cmddef{flowframtkendobject}
These commands are defined by \sty{flowframtkutils}. They initially
do nothing but may be redefined in conjunction with the
the \widget{export.markup.paired} option.
For example, suppose you want to export an image to a file that can
be input in a \cls{beamer} presentation. If this option is set, then each object can be
uncovered one at a time with the following redefinition:
\begin{codebox}
\csfmt{renewcommand}\gls{flowframtkendobject}\oarg{7}\marg{\csfmt{pause}}
\end{codebox}

The first argument \meta{n} starts at 0 (the entire image) and is
incremented for every \gls{object}, descending down the
\glspl{group}, so that each \gls{object} has a unique value.
The value of \meta{n} will match the start and end pair.

The \meta{class name} is the Java class name of the \gls{object}:
\code{JDRGroup} for a \gls{group}, \code{JDRPath} for a \gls{path},
\code{JDRText} for a \gls{textarea},
\code{JDRTextPath} for a \gls{textpath},
\code{JDRRotationalPattern} for a rotational \gls{pattern},
\code{JDRScaledPattern} for a scaled \gls{pattern},
\code{JDRSpiralPattern} for a spiral \gls{pattern}, and
\code{JDRSymmetricPath} for a symmetric shape.

The \meta{description} is the image's description when \meta{n} is 0
otherwise it's the \gls{object}['s] description. This argument will
be empty if no description has been set.

The \meta{tag} is the object's tag. This argument will be empty if
no tag has been set.

The \meta{pgf point} argument is the lower left point of the object's bounding
box in \sty{pgf} point notation (\gls{pgfpoint}\margm{x}\margm{y}).

The \meta{width} and \meta{height} arguments are the width and
height of the object's bounding box.

\widgetdef{export.markup.encap}

Each object in the \env{pgfpicture} environment is encapsulated with
\cmddef{flowframtkencapobject}
The first seven arguments are as for \gls{flowframtkstartobject}
and \gls{flowframtkendobject}. The final argument is the object
code.

\widgetdef{export.textualshading}

If the export format doesn't support text \dgls{gradient-paint}, the
\widget{export.textualshading} panel provides options to indicate
what should be done if the image contains any text with a 
\dgls{gradient-paint}. Note that this option doesn't change
the image itself but just governs the way the image is saved in the export
file.

\widgetdef{export.textualshading.average}

If \widget{export.textualshading.average} is selected, any text
with a \dgls{gradient-paint} will be exported with the paint set to
the average of the start and end \manmsgpl{colour}.

\widgetdef{export.textualshading.start}

If \widget{export.textualshading.start} is selected, any text
with a \dgls{gradient-paint} will be exported with the paint set to
the start \manmsg{colour}.

\widgetdef{export.textualshading.end}

If \widget{export.textualshading.end} is selected, any text
with a \dgls{gradient-paint} will be exported with the paint set to
the end \manmsg{colour}.

\widgetdef{export.textpathoutline}

If the export format doesn't support \gls{textpath} outlines, the
\widget{export.textpathoutline} panel provides options to indicate
what should be done if the image contains any \glspl{textpath} with 
the \textattr{outline} mode on. Note that this option doesn't change
the image itself but just governs the way the image is saved in the export
file.

\widgetdef{export.textpathoutline.ignore}

If \widget{export.textpathoutline.ignore} is selected, all
\glspl{textpath} will be exported as though the \textattr{outline} mode
was off.

\widgetdef{export.textpathoutline.topath}

If \widget{export.textpathoutline.topath} is selected, all
\glspl{textpath} with the \textattr{outline} mode attribute set 
will be exported as though they had been converted to a path.

\widgetdef{export.load_doc_class}

The export to class and export to complete \LaTeX\ document options will
need to load a document class.  In the case of \widget{export.cls},
this is the underlying class that will be loaded with
\gls{LoadClass} otherwise the class is loaded with
\gls{documentclass}.

\widgetdef{export.load_doc_class.default}

Select \widget{export.load_doc_class.default} if you want to use the
class associated with the image (as specified in the
\widget{clssettings.title} tab of the \dialog{texconfig} dialog,
see \sectionref{sec:normalsize}).

\widgetdef{export.load_doc_class.specified}

Select \widget{export.load_doc_class.specified} and enter the class
name if you want a different class.

\widgetdef{export.pdf_info}

For export options that create a \LaTeX\ document, the
\widget{export.pdf_info} checkbox is available. If selected, 
the document title and creation date will be set
using \gls{flowframtkimageinfo} (if \sty{flowframtkutils} is
available) or \gls{pdfinfo} otherwise.

Note that this option isn't available for \widget{export.png} even
if \widget{export.use_process} is on as the information will be lost
when the PDF is converted to PNG, so the setting in this case would
be superfluous.

\widgetdef{export.use_process}

For export options that can be created with or without external
processes, the \widget{export.use_process} checkbox will be
available to choose which method to use. This checkbox is not
shown if no external processes are required (such as when creating a
\LaTeX\ file) or if an external process is required (such as
exporting to a PDF).


If external processes are required or if the
\widget{export.use_process} checkbox has been selected, then one or
more of the following processor panels will be shown. These are the
same as in the \widget{processes.title} tab of the \dialog{config}
dialog.
If the \widget{export.remember} checkbox is selected, the
corresponding settings in the \dialog{config} dialog will be
updated when the image is exported.

Each processor panel has the same format. The file field may be used
to set the path to the required command line tool. You can use the
\btn{selectfile} button to navigate your way to it. Below this, is
a list of command line options to pass to the application. Each
option should be on a separate line. The following placeholders are
available:
\begin{deflist}
\itemtitle{\inlineglsdef{placeholder-inputfile}}

\begin{itemdesc}
The name of the input file. This is a file in the temporary
directory, not the current image file.
\end{itemdesc}

\itemtitle{\inlineglsdef{placeholder-outputfile}}

\begin{itemdesc}
The name of the output file. This is a file in the temporary
directory, not the designated export file.
\end{itemdesc}

\itemtitle{\inlineglsdef{placeholder-basename}}

\begin{itemdesc}
The input file's basename, which will also be the job name. (Don't change
the job name or \FlowframTk\ won't be able to find the created file.)
\end{itemdesc}

\itemtitle{\inlineglsdef{placeholder-libgs}}

\begin{itemdesc}
The path to the \file{libgs} library for use with \app{dvisvgm}.
\end{itemdesc}

\end{deflist}

\widgetdef{processes.timeout}

To reduce the chance of zombie processes, each process is run with a
timer that will kill the process if it exceeds the value specified
in the \widget{processes.timeout} box.

\widgetdef{processes.pdflatex}

\FloatFig{fig:pdfprocessor}
 {\includeimg{pdfprocessor}}
 {The \pdfLaTeX\ Processor Panel (Default Setting)}

The default is to use the \app{pdflatex} application to create a PDF
file (\figureref{fig:pdfprocessor}). You can change this, for example to \app{lualatex}.
This setting is not only used for exports to PDF but also for any
exports that use PDF as an intermediate step (such as
\widget{export.png} with the \widget{export.use_process} checkbox
selected).

Any \LaTeX\ engine that creates a PDF file should be sufficient for
the image exports, but the \widget{export.flfpdf} function may
require a more complicated build if there are any cross-references.
In that case, you can use an automation tool. For example, in
\figureref{fig:pdfprocessor-latexmk} the application has been set to
\app{latexmk}. Note the need to add \code{-pdf} to the list of
options to ensure that a PDF file is created.

\FloatFig{fig:pdfprocessor-latexmk}
 {\includeimg{pdfprocessor-latexmk}}
 {The \pdfLaTeX\ Processor Panel (LaTeXMk)}

If you want to use an automation tool that requires \glspl{directive}
or \glspl{magic-comment}, then you will need to set the appropriate
comments in the \widget{texeditor.latexcodeblock.magic_comments}
panel.

\widgetdef{processes.latex}

\FloatFig{fig:dviprocessor}
 {\includeimg{dviprocessor}}
 {The DVI \LaTeX\ Processor Panel}

The default is to use the \app{latex} application to create a PDF
file (\figureref{fig:dviprocessor}).  This setting is used for exports
that use DVI as an intermediate step (that is, \widget{export.eps}
or \widget{export.svg} with the \widget{export.use_process} checkbox
selected).

\subsection{Export to PNG}\label{sec:exportpng}

\widgetdef{export.png}

\FloatFig{fig:exportpngdialog}
 {\includeimg{exportpngdialog}}
 {Export Dialog (PNG)}

To create a PNG of the current image, specify the target \ext+{png}
file in the \widget{export.file} field and make sure that the \widget{export.png}
radio button in the \dialog{export} dialog is selected. 
Use the buttons in the \widget{export.bounds} row to determine the
size of the exported PNG. The \widget{export.bounds.image}
or (where available) \widget{export.bounds.typeblock} buttons may be
used to crop the image.

The \widget{export.use_process} checkbox is visible with this export
option. Leave it unselected if you simply want to create a PNG file where the image
looks as it is \glslink{painting}{drawn} on the \gls{canvas}(at
100\% magnification and without annotations or
\glspl{selection-bbox}).

\widgetdef{export.use_alpha}

If the \widget{export.use_process} checkbox is not selected, the
\widget{export.use_alpha} checkbox will be available. Select it if
you want the PNG to have an alpha channel (which provides
transparency). If it's unselected, the PNG will have a white
background otherwise it will have a \gls{transparent} background.
Note that all \manmsgpl{colour} will be converted to RGB.

If you want the PNG file to be created via the
\widget{export.imagepdf} function, select the
\widget{export.use_process} checkbox. This will first export the
image to a PDF in a temporary directory and then convert that PDF to
a PNG file, which ensures that \LaTeX\ fonts and any \LaTeX\
alternative text will be used.

\widgetdef{processes.pdftopng}

If \widget{export.use_process} is selected, the \widget{processes.pdflatex}
and \widget{processes.pdftopng} panels will be shown. 
For the \widget{processes.pdftopng} tool, \FlowframTk\ will search
for \app{magick} (Image Magick), \app{pdftoppm}, or
\app{convert} (the old name for \app{magick}). If none of these are
found on the system path, you will need to supply an alternative
tool.

\subsection{Export to a \LaTeX\ Class or Package or Multi-Paged Document}
\label{sec:exportsty}

\widgetdef{export.cls}

\FloatFig{fig:exportclsdialog}
 {\includeimg{exportclsdialog}}
 {Export Dialog (CLS)}

\begin{information}
Although \FlowframTk\ can still export to files suitable for
the older 1.17 version of \sty{flowfram}, it's best to upgrade to
\sty{flowfram} v2.0+. Note only does this provide
\sty{flowframtkutils}, which simplifies the code written to the
exported file, but \sty{flowfram} v2.0 has been rewritten to take
the new \LaTeX\ kernel output routine into account.
Unexpected results may occur with older versions of \sty{flowfram}.
\end{information}

To create a \LaTeX\ class that loads the \sty{flowfram}
package (and the \sty{flowframtkutils} package if \FlowframTk\
detects it) specify the target \ext+{cls} file in the
\widget{export.file} field and make sure that the
\widget{export.cls} radio button in the \dialog{export} dialog is
selected (\figureref{fig:exportclsdialog}).  The class will have
class options provided that can be passed to the \sty{flowfram}
package when it loads.

The \widget{export.load_doc_class} setting will be available. The
specified class (or the default) will be loaded by the exported
class. Any class options that aren't picked up as \sty{flowfram}
options will be passed to this underlying class.

Any occurrences of \gls{usepackage} in the image
preamble will be converted to \gls{RequirePackage} on export.

The rest of the exported content is as for \widget{export.sty}
and \widget{export.flfdoc} (except for the \gls{document-body}, which
isn't applicable).

\widgetdef{export.sty}

To create a \LaTeX\ package that loads the \sty{flowfram}
package (and the \sty{flowframtkutils} package if \FlowframTk\
detects it) specify the target \ext+{sty} file in the
\widget{export.file} field and make sure that the
\widget{export.sty} radio button in the \dialog{export} dialog is
selected.  The package will have package options provided that can
be passed to the \sty{flowfram} package when it loads.

Any occurrences of \gls{usepackage} in the image
preamble will be converted to \gls{RequirePackage} on export.

\widgetdef{export.flfdoc}

To create a complete \LaTeX\ document that loads the \sty{flowfram}
package (and the \sty{flowframtkutils} package if \FlowframTk\
detects it) specify the target \ext+{tex} file in the
\widget{export.file} field and make sure that the
\widget{export.flfdoc} radio button in the \dialog{export} dialog is
selected.

Any occurrences of \gls{RequirePackage} in the image
preamble will be converted to \gls{usepackage} on export.

If a \gls{document-body} has been provided, the content will be
placed in the \env{document} environment,
otherwise \FlowframTk\ will attempt to work out how many pages to
create by inspecting the page list of each \gls{object} that has
\gls{flowframe} data assigned and will just write a series of
\gls{null} commands separated by \gls{clearpage} to create the appropriate
number of pages. This facility is provided as it's used as an
intermediate step in the \widget{export.flfpdf} function where it
may be useful to quickly check the document layout without adding
text. You may prefer to use a package that provides dummy text, such
as \sty{lipsum}.

\widgetdef{export.flfpdf}

If you want \FlowframTk\ to automatically create a multi-paged PDF 
document, specify the target \ext+{pdf} file in the
\widget{export.file} field and make sure that the
\widget{export.flfpdf} radio button in the \dialog{export} dialog
is selected.

This function works by first creating a \LaTeX\ document
(as per \widgetdef{export.flfdoc})
in a temporary file and then compiling it with
\app{pdflatex} (or whatever tool has been specified in the
\widget{processes.pdflatex} panel). The temporary file (and any
associated files created in the process) will then be deleted.

In each of the above cases, the \sty{geometry} package will be
loaded (before \sty{flowfram}) to set the page layout according to
the \gls{canvas} paper size and the \gls{typeblock}. (Note that
changing the page geometry after \sty{flowfram} has been loaded is
likely to cause an wanted shift in the frames.)
The \sty{pgf} package will also be
required to create borders and backgrounds, where applicable.
(It's also automatically loaded by \sty{flowframtkutils}.)

Only \glspl{object} that have been identified as static, flow or
dynamic frames will be exported (see \sectionref{sec:flowframe}).
This means that you can create additional \glspl{object} for use as
guidelines and they won't be included in the exported file.

Each \gls{object} that has \gls{flowframe} data
assigned to it will have a corresponding \gls{newflowframe},
\gls{newstaticframe} or \gls{newdynamicframe} line, as applicable,
written to the exported file.

If the \widget{flowframe.border} option was set to \widget{flowframe.border_as_shown}
then the command definition for the border will be written to the
file. The frame attributes will be set.

The \gls{early-preamble} text (\sectionref{sec:preamble}) is added before the
start of the package option declarations, which provides a means to
add extra package options, if required.  The \gls{mid-preamble} text will
be placed after the class or packages are loaded and the
\gls{late-preamble} text is placed at the end of the class or package.
(With \widget{export.flfdoc} and \widget{export.flfpdf}, the
preamble blocks are placed in roughly analogous positions.
Additionally, any \glspl{magic-comment} will be placed at the start
of the \ext{tex} file.)

\begin{important}
The \hyperref[sec:texconfigpreamble]{default preamble} is not used
when exporting to a class or package.
\end{important}

\widgetdef{export.shapeparcs}

Any frames that have the shape set to
\widget{flowframe.shape_shapepar} will use the command identified
in the \widget{export.shapeparcs} panel (\gls{shapepar} or
\gls{Shapepar}).

The export to class and export to document functions (that is, not the
export to package function), will have the
\widget{export.load_doc_class} panel available.

\seealsorefs{sec:texconfig,
sec:preamble,
sec:flowframe,
sec:houseexample,
sec:neuronexample,
sec:postertutorial,
sec:newstutorial}

\subsection{Export to PGF}\label{sec:exportpgf}

\widgetdef{export.pgfpicture}

To create a file that just contains the \env{pgfpicture} environment, 
specify the target \ext+{tex}
file in the \widget{export.file} field and make sure that the
\widget{export.pgfpicture} radio button in the \dialog{export} dialog is selected
(\figureref{fig:export-pgfpicture-dialog}). 
The file can then be included in a \LaTeX\ document with \gls{input}
or (provided by \sty{flowframtkutils}) \gls{includeteximage}.

Remember to include \sty{flowframtkutils} in your document. If
\FlowframTk\ can't detect \sty{flowframtkutils} on \TeX's path, it
will assume it's not available and the exported file will include
comments about how to define the required commands.

The \widget{export.bounds} panel will be available but the
\widget{export.bounds.papersize} option will be disabled.
The \widget{export.bounds.image} option is the default.
The \widget{export.bounds.typeblock} option will only be available
if the \gls{typeblock} has been set.

The \widget{export.markup}, \widget{export.textualshading}
and \widget{export.textpathoutline} panels will be available. 

If you want to create a standalone file, complete with a document
class and document environment, you will need the
\nameref{sec:exportdoc} function instead.

\seealsorefs{sec:texconfig,
sec:preamble,
sec:houseexample,
sec:neuronexample}

\subsection{Export to Single-Paged Document}\label{sec:exportdoc}

\widgetdef{export.imagedoc}

To create a standalone single-paged \LaTeX\ document that just
displays the image, specify the target \ext+{tex} file in the
\widget{export.file} field and make sure that the
\widget{export.imagedoc} radio button in the \dialog{export} dialog
is selected.

The \widget{export.bounds} panel will be available which determines
the page geometry.  The \widget{export.bounds.typeblock} option will
only be available if the \gls{typeblock} has been set.  (If the
\widget{export.bounds.typeblock} button is selected, see
\sectionref{sec:normalsize}.)

\begin{information}
For the encapsulated export function (that is, where the
\widget{export.bounds.papersize} option isn't selected),
if the bounding box is smaller than the baselineskip, the page
height is set to the baselineskip, according to the given
\hyperref[sec:normalsize]{normal size} for the image.
\end{information}

The preamble information written to the exported \LaTeX\ file is as detailed below.

\widgetdef{export.imagepdf}

If you want \FlowframTk\ to automatically create a single-paged PDF 
of the image from a \LaTeX\ document, specify the target \ext+{pdf} file in the
\widget{export.file} field and make sure that the
\widget{export.imagepdf} radio button in the \dialog{export} dialog
is selected.

This function works by first creating a standalone encapsulated
\LaTeX\ document (as per the \widget{export.imagedoc} option) 
in a temporary file and then compiling it with
\app{pdflatex} (or whatever tool has been specified in the
\widget{processes.pdflatex} panel). The temporary file (and any
associated files created in the process) will then be deleted.

\begin{information}
If the \widget{export.imagepdf} function fails, try exporting to a
\LaTeX\ document (\widget{export.imagedoc}) and then manually
building the document. It may be that the preamble code or 
a \gls{textarea} has a command that needs to be defined or that has
been misspelt.
\end{information}

Any \glspl{magic-comment} that have been provided will be added to
the start of the \LaTeX\ source file.  If a \gls{preamble.default}
has been set (see \sectionref{sec:texconfigpreamble}) the code will
be included in the \ext{tex} file's preamble.  This is in addition
to the contents of the image's \glsname{preamble.early}-,
\glsname{preamble.mid}- and \gls{preamble.late} (see
\sectionref{sec:preamble}). For example, I have set the default
preamble to:
\begin{verbatim}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\end{verbatim}
If you prefer to use \sty{fontspec} and you are using the
\widget{export.imagepdf} option, change the
\widget{processes.pdflatex} path from \app{pdflatex} to
\app{lualatex} or \app{xelatex}. Alternatively, you could set the
\widget{processes.pdflatex} tool to \app{arara} and set the
\glspl{magic-comment} as appropriate.

If your image includes \LaTeX\ commands that require a particular
package, you will need to add these packages to the
\hyperref[sec:preamble]{image preamble}. This is done automatically
by the \gls{textarea-mapping} function, if it has been
\hyperref[mi:texmappings]{enabled}.  See
\sectionsref{sec:texconfigtext,sec:preamble} for further details.

\FlowframTk\ will automatically add
the code to load the \sty{flowframtkutils} package (if detected),
and other packages, such as \sty{pgf} and \sty{geometry}.

\begin{warning}
Changes caused by differences in the way that \FlowframTk\ renders
\glspl{textarea} with the way that \LaTeX\ typesets them
can cause the image to be clipped if the bounding box
has been underestimated. If this is a problem, use
the \widget{export.bounds.typeblock}
option in the \widget{export.bounds} button group of the
\dialog{export} dialog, and use the \gls+{image.typeblock} function to mark your
preferred bounding box.
\end{warning}

For example, in \figureref{fig:equation} I have a \gls{textarea} with the
alternative \LaTeX\ text set to:
\begin{verbatim}
$\displaystyle f(\boldsymbol{\Upupsilon}; \eta ) = 
\frac{1}{2}\eta \sum_k\boldsymbol{\upupsilon}_k\cdot 
\boldsymbol{\upupsilon}_k$
\end{verbatim}
Below this is a \gls{path} for illustrative purposes. When viewed in
\FlowframTk, as shown in \figureref{fig:equationa}, the
\gls*{textarea} and \gls*{path} are the same widths, but when the
image is exported to PDF, shown in \figureref{fig:equationb}, the
equation generated by the alternative text is wider that its
representation on the \gls{canvas} and has consequently been clipped
(both the top of the fraction and the right end of the equation)
because it exceeds the image bounding box that was computed by
\FlowframTk.

In \figureref{fig:equationc}, a rectangle has been
added to the image. This now extends the image bounding box, so when
the image is now exported to PDF, as shown in
\figureref{fig:equationd}, the equation is no longer clipped,
but the new rectangle is now visible, which may not be desirable.

There are two ways to deal with this. The first is to give the
rectangle a \gls{transparent} \pathattr{line-paint} (in addition to the
default \gls{transparent} \pathattr{fill-paint}) but now it can only been detected on the
\gls{canvas} when it's selected. The second method is to set the
\gls{image.typeblock} to the area of that rectangle (see \sectionref{sec:typeblock}).
The easiest way to do this is to \select\ the rectangle, use the
\menu{tex.flowframe.set_typeblock} menu item to open the
\dialog{typeblock} dialog box, and click on the
\widget{typeblock.compute_from_path} button. Then delete the
rectangle. The \gls{image.typeblock} is now shown as a \manmsg{grey} rectangle in
\figureref{fig:equatione}. Redoing the export to PDF with the
\widget{export.bounds.typeblock} button selected now
produces the image shown in \figureref{fig:equationf}.

\FloatSubFigs{fig:equation}
{
 {fig:equationa}{\includeimg{equationa}}{},
 {fig:equationb}{\includeimg{equationb}}{},
 {fig:equationc}{\includeimg{equationc}}{},
 {fig:equationd}{\includeimg{equationd}}{},
 {fig:equatione}{\includeimg{equatione}}{},
 {fig:equationf}{\includeimg{equationf}}{}
}
[Exported Text Areas Can Overflow Bounding Box]
{Exported Text Areas Can Overflow Bounding Box:
\subfigref{fig:equationa} image as shown on canvas;
\subfigref{fig:equationb} image exported to PDF (equation has been clipped);
\subfigref{fig:equationc} rectangle added to image;
\subfigref{fig:equationd} image from \subfigref{fig:equationc} exported to PDF;
\subfigref{fig:equatione} typeblock added and rectangle removed;
\subfigref{fig:equationf} image from \subfigref{fig:equatione} exported to PDF.}

If the exported PDF file has unexpected results or fails to be
created, try exporting to an encapsulated \LaTeX\ document and then
manually building the document, as the issue may be due to the
conversion process or it may be due to an unrecognised command or
syntax error in a \gls{textarea} or \gls{textpath}.

\seealsorefs{sec:texconfig,sec:preamble,sec:fontanchor}

\subsection{Export to SVG or EPS}\label{sec:exportsvgeps}

\FloatFig{fig:exportepsdialog}
 {\includeimg{exportepsdialog}}
 {Export Dialog (EPS)}

The export to \gls{svg} or EPS functions are only available if the
\widget{processes.support_eps_svg} checkbox has been selected
(in the \widget{processes.title} tab of the \dialog{config} dialog).

\widgetdef{export.eps}

The \widget{export.eps} function is similar to the \widget{export.png}
in that you can choose whether or not to use external tools to
create the exported file. Note that \FlowframTk's support for
exporting to EPS without an external tool is quite basic and may not
work correctly.

To create a PostScript file of the current image, specify the target
\ext+{ps} or \ext+{eps} file in the \widget{export.file} field and
make sure that the \widget{export.eps} radio button in the
\dialog{export} dialog is selected. 

If the \widget{export.use_process} checkbox is
selected (\figureref{fig:exportepsdialog}), then the
\widget{processes.latex} processor panel and the
\inlineglsdef{processes.dvips} processor panel will be shown.
A temporary \LaTeX\ file will be created, as for
\widget{export.imagepdf}, but in this case \app{latex} not
\app{pdflatex} is needed.

\begin{warning}
The \app{dvips} \code{-E} switch can be problematic when the file only
contains images. It's best to omit it and use the appropriate
\widget{export.bounds} option.
\end{warning}

\widgetdef{export.svg}

To create an \gls{svg} file of the current image, specify the target
\ext+{svg} file in the \widget{export.file} field and
make sure that the \widget{export.svg} radio button in the
\dialog{export} dialog is selected. 

The \widget{export.svg} function is much the same as
\widget{export.eps} but in this case, if the  \widget{export.use_process} checkbox is
selected, then the 
\widget{processes.latex} processor panel and the
\inlineglsdef{processes.dvisvgm} processor panel will be shown.
Additionally, the \widget{processes.libgs} panel will be shown
where you can optionally specify the path to the \file{libgs}
library. You may leave this blank if this information can be
obtained from the \gls{LIBGS} environment variable.

\begin{warning}
In both cases, \app{latex} rather than \app{pdflatex} is used to
create a DVI file. The DVI format is quite old and is more
problematic than the newer PDF format engines. Consider exporting to
PDF and then converting from that instead.
\end{warning}

\widgetdef{export.bitmaps_to_eps}

In either case, if the image contains any
\glspl{bitmap}, \FlowframTk\ will attempt to convert
them to EPS, where necessary, if the \widget{export.bitmaps_to_eps}.
checkbox is selected.

\begin{important}
Note that PostScript does not support transparency.
\end{important}

As with the \widget{export.imagepdf} option, if the resulting \gls{svg} or EPS
file has unexpected results or fails to be created, try exporting to
a \LaTeX\ document (\widget{export.imagedoc}) and then manually building the
document.

\section{Import}\label{sec:importimage}

\menudef{menu.file.import}

A supported file format can be imported using the \menu{file.import}
menu item, which will open the \dialog{import} dialog. The
experimental mode may provide additional import options.

\begin{information}
There is currently only one file format type that is supported in
normal (non-experimental) mode, and that is the Acorn Draw file
format.
\end{information}

The original \gls{JpgfDraw} application was inspired by Acorn Computers' Draw
application. The Acorn Draw file format is a little-endian binary format that can
now be imported by \FlowframTk. However there are some limitations
and also some differences.

\begin{itemize}
\item a \FlowframTk\ \gls{textarea} corresponds to a Draw \qt{text line};
\item the Draw \qt{text area} specification supports multiple paragraphs
and columns, which will be implemented in \FlowframTk\ as
\gls{flowframe} data;
\item \FlowframTk\ currently can't extract embedded Sprite data
but can extract embedded JPEG data;
\item \FlowframTk\ currently doesn't support Draw's transformed text;
\item some basic conversion for the System Font, Selwyn, Latin1 and
Latin2 is provided but characters from other fonts may not be
correctly converted;
\item \FlowframTk\ doesn't support different $x$ and $y$ divisions
in the \gls{grid};
% TODO:
\item \FlowframTk\ currently doesn't support Draw's arrow markers;
\item \FlowframTk\ uses a left-handed \gls{co-ordinate} system so the 
right-handed \glspl{co-ordinate} in the Draw file will be converted;
\item since \gls{RISCOS} doesn't use dot file extensions, the file
chooser uses the \gls{RISCOS} \gls{NFS} style \ext+{aff} suffix 
(\href{http://www.riscos.com/support/users/omniclient/6_filemap.html}{comma 
followed by three hexadecimal digits}) for the Acorn Draw filter in the file chooser.
\end{itemize}

\widgetdef{import.title}

\FloatFig
  {fig:importdialog}
  {\includeimg{importdialog}}
  {Import Dialog}

The \dialog{import} dialog (see \figureref{fig:importdialog}) has a
field at the top to specify the import file. You can use the
\widget{selectfile} button on the right to open a file chooser to
navigate your way to the required file. Once you have selected the
file and accepted it, the file name will be set in the
\widget{import.file} field.

The following file types may be recognised:
\begin{itemize}
\item Acorn Draw (always available);
\item EPS (\ext+{eps} or \ext+{ps}, only in experimental mode);
\item \gls{svg} (\ext+{svg}, only in experimental mode).
\end{itemize}
Note that \FlowframTk\ doesn't probe the file to determine the file
type but simply tests which file filter accepts the filename. 
The default is Acorn Draw. If the Draw file doesn't have the
\ext+{aff} suffix, you can just use the \qt{All Files} filter.

\begin{information}
For formats that are only available in experimental mode,
some or all of the following settings may be ignored.
\end{information}

\widgetdef{import.use_mappings}

If the \widget{import.use_mappings} checkbox is selected, any text
found in the imported file will have the current
\hyperref[mi:texmappings]{\TeX\ mappings}
applied. Note that when importing from an Acorn Draw file, any text
lines that have the Selwyn font will be converted to \mathsmode, 
and the \mathsmode\ mappings will be used.

\widgetdef{import.extract_bitmaps}

If the \widget{import.extract_bitmaps} checkbox is selected,
any supported embedded \glspl{bitmap} will be extracted. If this checkbox
is selected, the \widget{import.bitmap_dir} and
\widget{import.bitmap_prefix} fields will be visible.

\widgetdef{import.bitmap_dir}

The \widget{import.bitmap_dir} field may be used to specify the
destination directory for any extracted \glspl{bitmap}. If left
empty, the current directory will be used. You can either type in
the directory path or click on the \widget{selectfile}
button on the right to open a directory chooser.

\widgetdef{import.bitmap_prefix}

Each extracted \gls{bitmap} will be saved as
\meta{prefix}\meta{n}\filefmt{.}\meta{ext} where
the \meta{prefix} is specified in the \widget{import.bitmap_prefix}
field, \meta{n} is an integer that's incremented for each extracted
\gls{bitmap} and \meta{ext} is the file extension.
If an import file is selected via the file chooser and the
\widget{import.bitmap_prefix} field is empty, this field will be set to the
file's basename.

\section{Page Setup}\label{sec:pagesetup}

\menudef{menu.file.page}

The \menu{file.page} menu item will open the printer's page
setup dialog box. This will require a print service to be available.
The \glspl{printer-margin} will be shown on the \gls{canvas} if the
\menu{settings.paper.margins} menu item is selected.

\section{Print}\label{sec:print}

\menudef{menu.file.print}

You can \glslink{printing}{print} the current image using the \menu{file.print} menu
item which will open the printer dialog box. If no printer is found,
the error message \qt{\errmsg{printing.no_service}} will
be displayed. If this happens, check that the printer is switched
on and connected to the computer. The print function uses the
\gls{canvas}['s] \gls{rendering} and \gls{anti-aliasing} settings
(provided in the \dialog{graphics} configuration) and draws
the image as it's displayed on the \gls{canvas} (at 100\%
magnification and without the grid or annotations).

\begin{information}
If you use the printer's \qt{Print to PDF} function (where
supported), the resulting PDF may be different from that created
with the export to PDF function (see \sectionref{sec:exportdoc})
as the \LaTeX-related settings won't be used by the printer.
\end{information}

\section{Message Window}\label{sec:messages}

\menudef{menu.file.messages}

You can display the \inlineglsdef{message.title} window using the
\menu{file.messages} item. This usually just lists the
files that have been opened, saved or exported, but warnings are
sometimes written there as well. This window is opened during a read
or write operation. When an external application is spawned, the
abort button becomes enabled, which you can use to kill the spawned
process if required.

\section{Close}\label{sec:closeimage}

\menudef{menu.file.close}

You can close the current child window, either by clicking on the
child window's close icon or by selecting \menu{file.close}.
If there is any unsaved data, \FlowframTk\ will ask for confirmation
before discarding the window (see \figureref{fig:confirmclose1}).
In this dialog box you can:

\begin{deflist}
\itemtitle{\includeimg{discard}}

\begin{itemdesc}
click on the discard button next to the image name to discard the
image;
\end{itemdesc}

\itemtitle{\includeimg{save}}

\begin{itemdesc}
click on the save button next to the image name to save the image;
\end{itemdesc}

\itemtitle{\includeimg{cancel}}

\begin{itemdesc}
click on the cancel button at the bottom of the dialog box to cancel
the close operation.
\end{itemdesc}

\end{deflist}

\FloatFig
  {fig:confirmclose1}
  {\includeimg{confirmclose1}}
  {Confirm Discard Dialog (1 Modified Image).}

An image will only be marked as unmodified if it has been saved as a
\gls{JDR} or \gls{AJR} file.  If you have
\hyperref[sec:exportimage]{exported} your image to another file
type, I recommend that you also \hyperref[sec:saveimage]{save} it as
a \gls{JDR} file as well, in case you want to edit it later.

Note that you must finish or discard any \gls{path} that is under
\hyperref[sec:newobjects]{construction} before you can close
an image.

\section{Quit}\label{sec:quit}

\menudef{menu.file.quit}

To quit \FlowframTk\ either use the menu item
\menu{file.quit} or click on the close icon on the
main window. All child frames will be closed. If any child frame
contains unsaved data, you will be asked for confirmation before
the window is discard. If there is only one modified image, the
dialog box is as for the \hyperref[sec:closeimage]{close operation} shown in
\figureref{fig:confirmclose1}, otherwise it's as shown in
\figureref{fig:confirmclose2}, where each modified file is listed.

\FloatFig
  {fig:confirmclose2}
  {\includeimg{confirmclose2}}
  {Confirm Discard Dialog (2 Modified Images).}

As with the close operation, for each listed file, you can:
\begin{deflist}
\itemtitle{\includeimg{save}}

\begin{itemdesc}
click on the save button next to the image name to save the image;
\end{itemdesc}

\itemtitle{\includeimg{discard}}

\begin{itemdesc}
click on the discard button next to the image name to discard the
image.
\end{itemdesc}

\end{deflist}

Alternatively you can:
\begin{deflist}
\itemtitle{\includeimg{save_all}}

\begin{itemdesc}
click on the save all button to save all the listed files;
\end{itemdesc}

\itemtitle{\includeimg{discard_all}}

\begin{itemdesc}
click on the discard all button to discard all the listed files and
quit;
\end{itemdesc}

\itemtitle{\includeimg{cancel}}

\begin{itemdesc}
click on the cancel button at the bottom of the dialog box to cancel
the quit operation.
\end{itemdesc}

\end{deflist}

\chapter{Creating New Objects}\label{sec:newobjects}

\menudef{menu.tools}

New \glspl{path} and \glspl{textarea} can be created using
\FlowframTk's \gls{construction}, which can be obtained using any tool
except the \tool{select}. The tools can be selected using either the
vertical \gls{toolbar} or the \menu{tools} menu. Once \glspl{path}
and \glspl{textarea} have been created they can then be edited or
transformed or combined to form a \gls{textpath} object. You can
also apply patterns to \glspl{path} or \glspl{textpath}.

\Glspl{bitmap} (\sectionref{sec:insertbitmap}) can also be added to
the image but this is done via the \menu{bitmap.insert} menu item
and they can't be edited (although they can be moved, scaled,
sheared and rotated).

\menudef{menu.tools.finish}

Finish the \gls{path} or \gls{textarea} by pressing
\accelerator{menu.tools.finish} or by selecting \menu{tools.finish}
or by clicking on the finish button or (\gls{path}) by
\glslink{doubleclick}{double-clicking} (instead of single-clicking)
on the final vertex or (\gls{textarea}) clicking on the \gls{canvas}
where you want the next \gls{textarea} to start.  

Note that transferring the focus to
another \FlowframTk\ child window or selecting a new tool whilst you
are constructing a \gls{path}, will complete the current path.

\menudef{menu.tools.abandon}

Cancel the current \gls{path} by pressing the
\accelerator{menu.tools.abandon} key or by selecting
\menu{tools.abandon} or by clicking on the abandon path button.
(Not applicable for \glspl{textarea}.)

\menudef{menu.tools.gap}

The \inlineglsdef{gap} or \qt{\gls{move-to}} function is only
available when constructing an open or closed
\hyperref[sec:newlinepath]{line path} or \hyperref[sec:newcurvepath]{curve
path}.  Once you have clicked on the vertex where you want the
\gls{gap} to start, select \menu{tools.gap} or click on the
\gls{gap} button or press \accelerator{menu.tools.gap}, then click
on the \gls{canvas} where you want the \gls{gap} to end. The next
segment will resume according to the tool (line or curve).

\begin{warning}
The undo/redo mechanism is disabled while you are constructing a
path, however while you are creating a line path or a curve path,
you can delete the previous segment using the
backspace \accelerator{action.delete_last} key.
\end{warning}

Note that \FlowframTk\ won't allow you to create a \gls{path} whose
total width and height are both less than 1.002\gls{bp}. This is to
prevent accidentally creating a tiny path that can't be seen but
contributes to the total image dimensions. This restriction only
applies when creating \glspl*{path} and does not apply to editing
paths.

The \dglspl{path-attribute} will only be set
once the \gls{path} has been completed. Whilst the
\gls{path} is under construction you will
only see a draft version (see \figureref{fig:draftfinal}).
If you want a \gls{path} with a mixture of line and curve
segments, first construct a \gls{path} with only one
type of segment (e.g.\ lines), and then use the
\gls{menu.edit.path.edit} function to convert
the required segments.

\FloatSubFigs{fig:draftfinal}
{
 {fig:draftfinala}{\includeimg{underconstruction}}{},
 {fig:draftfinalb}{\includeimg{curvecompleted}}{}
}
[Path Attributes Are Only Set Once the Path is Completed]
{Path attributes are only set once the path is completed:
\subfigref{fig:draftfinala} path under construction;
\subfigref{fig:draftfinalb} path completed.}

If you are unable to use the mouse, you can move the pointer using
\menu{navigate.goto}. The keystroke
\accelerator{action.construct_click} will emulate a single mouse
click in \gls{construction}.

\seealsorefs{sec:editpath,sec:symmetric,sec:patterns}

\section{Line Paths}\label{sec:newlinepath}

\menudef{menu.tools.open_line}

To construct an open line \gls+{path}, select the open line tool,
either by clicking on the open line button or by selecting
\menu{tools.open_line}. You can later close the \gls{path}
with the \gls{menu.edit.path.edit} function.

\menudef{menu.tools.closed_line}

To construct a closed line \gls{path}, select the closed line tool,
either by clicking on the closed line button or by selecting
\menu{tools.closed_line}. You can later open the \gls{path}
with the \gls{menu.edit.path.edit} function.

Use the \glslink{primaryclick}{primary mouse button} to click on each vertex
defining the path. To complete the \gls{path}, do one of the following:
\begin{itemize}
\item \glslink{doubleclick}{Double-click} instead of single-clicking
on the final vertex: this performs the combined function of defining
the vertex and finishing the path. If you use this method, be
careful not to accidentally create two coincident vertices at the
end point, or it will cause a problem for any mid or end
\hyperref[sec:markers]{marker} that you apply.

\item Single-\gls{click} on the final vertex and then
complete the path by pressing \accelerator{tools.finish} or by
clicking on the finish button or by selecting
\menu{tools.finish}.
\end{itemize}
If you have used the closed line tool, the path will automatically
be closed by inserting a line between the end vertex
and the initial vertex.

\seealsorefs{
 sec:rectangles,
 sec:linepaint,
 sec:fillpaint,
 sec:pathstyle,
 sec:editpath,
 sec:houseexample,
 sec:accesstutorial
}

\section{Curve Paths}\label{sec:newcurvepath}

\menudef{menu.tools.open_curve}

To construct an open curve \gls+{path}, select the open curve tool,
either by clicking on the open curve button or by selecting
\menu{tools.open_curve}. You can later close the \gls{path}
with the \gls{menu.edit.path.edit} function.

\menudef{menu.tools.closed_curve}

To construct a closed curve \gls{path}, select the closed curve tool,
either by clicking on the closed curve button or by selecting
\menu{tools.closed_curve}. You can later open the \gls{path}
with the \gls{menu.edit.path.edit} function.

Use the \glslink{primaryclick}{primary mouse button} to click on each vertex in
the \gls*{path}.  There is no way to specify the location of the
\glspl{controlpt} defining the curvature of the \gls*{path} whilst the
\gls*{path} is under construction, however, once the
\gls*{path} has been completed, it is possible to move these
\glspl*{controlpt} in \editpathmode.

To complete the \gls*{path}, do one of the following:
\begin{itemize}
\item \glslink{doubleclick}{Double-click} instead of single-clicking
on the final vertex: this performs the combined function of defining
the vertex and finishing the path. If you use this method, be
careful not to accidentally create two coincident vertices at the
end point, or it will cause a problem for any mid or end
\hyperref[sec:markers]{marker} that you apply.

\item Single-\gls{click} on the final vertex and then
complete the path by pressing \accelerator{tools.finish} or by
clicking on the finish button or by selecting
\menu{tools.finish}.
\end{itemize}
If you have used the closed curve tool, the path will automatically
be closed by inserting a curve between the end vertex
and the initial vertex.

\seealsorefs{
 sec:ellipses,
 sec:linepaint,
 sec:fillpaint,
 sec:pathstyle,
 sec:editpath,
 sec:neuronexample
}

\section{Rectangles}\label{sec:rectangles}

\menudef{menu.tools.rectangle}

To construct a rectangle, select the rectangle tool either by
clicking on the rectangle tool button or by selecting
\menu{tools.rectangle}.

Use the \glslink{primaryclick}{primary mouse button} to click where
you want the first corner to go, then move (not drag) the mouse to
the opposite corner, and \gls{click} or press
\accelerator{menu.tools.finish} to complete the \gls{path}.

Note that this function is just a shortcut to using the
\gls{menu.tools.closed_line} function. Once the rectangle is
created, it is simply another closed \gls+{path}, and can be edited in
exactly the same way.

\seealsorefs{
 sec:newlinepath,
 sec:linepaint,
 sec:fillpaint,
 sec:pathstyle,
 sec:editpath,
 sec:houseexample,
 sec:neuronexample
}


\section{Ellipses}\label{sec:ellipses}

\menudef{menu.tools.ellipse}

To construct an ellipse, select the ellipse tool either by clicking
on the ellipse tool button or by selecting
\menu{tools.ellipse}.

Use the \glslink{primaryclick}{primary mouse button} to click on the
\manmsg{centre} point of the ellipse, and then move (not drag) the mouse
until the ellipse has reached the desired dimension, and \gls{click}
or press \accelerator{menu.tools.finish} to complete the \gls{path}. If you want
to create a circle, I recommend that you first enable the \gridlock\ or use the
\menu{navigate.goto} menu item.

Note that this function is just a shortcut to using the
\gls{menu.tools.closed_curve} function. Once the ellipse is
created, it is simply another closed \gls+{path}, and can be edited in
exactly the same way.

\seealsorefs{
 sec:newcurvepath,
 sec:linepaint,
 sec:fillpaint,
 sec:pathstyle,
 sec:editpath,
 sec:cheeseexample
}

\section{Text}\label{sec:newtext}

\Glspl{textarea} can be created to annotate images. Each
\gls*{textarea} has text that's displayed on the \gls{canvas} but
may have alternative text to use when
\hyperref[sec:exportimage]{exporting} to a \LaTeX\ file. (This includes
the export functions that create a temporary \LaTeX\ file, such as
the export to PDF function.) There are two tools to create a
\gls*{textarea}: the \texttool\ and the \mathstool. These
affect the default alternative text for the new \gls*{textarea} in
different ways. You can later \hyperref[sec:edittext]{edit the
alternative text}, if the default isn't suitable.

Line breaks are not supported in \gls{textarea}. If you are using
the \hyperref[sec:flowframe]{flowframe} functions, you can create a
static frame and provide multi-lined text for the frame content.

\menudef{menu.tools.textarea}

The text tool can be selected either by clicking on the
\gls{menu.tools.textarea} tool button or by selecting \menu{tools.textarea}.

If \widget{textconfig.escape} is enabled, the alternative text will be set
to the original supplied text with any identified characters
substituted according to the \widget{textconfig.textmappings} settings.

\menudef{menu.tools.math}

The \manmsg{maths} tool can be selected either by clicking on the
\gls{menu.tools.math} tool button or by selecting \menu{tools.math}.

If \widget{textconfig.escape_mathchar} is enabled, the alternative text will be set
to the original supplied text with any identified characters
substituted according to the \widget{textconfig.textmappings} settings.

After any substitutions on the alternative have been performed, 
the \gls{mshift} character will be added to the start and end
of the alternative text.


With either the \texttool\ or the \mathstool,
once you have selected the required tool, click with the
\glslink{primaryclick}{primary mouse button} at the position where
you want the text to start. This will produce a shaded area with a
cursor in which you can type no more than a single line of text
(\figureref{fig:textareafield}).
Clicking inside this shaded area will move the cursor around the
text area under construction.

\FloatFig
  {fig:textareafield}
  {\includeimg{textareafield}}
  {Text Area Construction Field}

When you want to complete a \gls{textarea}, press
\accelerator{menu.tools.finish} (which will start a new
\gls{textarea} on the line below) or click anywhere on the canvas
outside of the current text area (which will start a new
\gls{textarea} at the new location) or use the
\gls{menu.tools.finish} button or \menu{tools.finish}.  Selecting
another tool whilst a \gls{textarea} is under construction will
finish the current \gls{textarea}, unless you're switching between
the \texttool\ and \mathstool.  (If you do switch between the
text and \manmsg{maths} tools, the alternative \LaTeX\ text is only
created when you finish the \gls*{textarea}, so the mappings applied
will be governed by the tool currently selected when you completed
the \gls*{textarea}.) An empty \gls{textarea} will be discarded.

If a mapping is performed that has an associated package, then the
package will be automatically add to the image's
\hyperref[sec:preamble]{early-preamble}. The mapping function will
first search the early-preamble code to check if the package is
already present, but it doesn't check the mid- or late-preamble code
or the code in the \hyperref[sec:texconfigpreamble]{default
preamble}.

Once a \gls{textarea} has been completed, the only way to edit it is via the
\hyperref[sec:edittext]{edit text function}. If you click the
mouse on the location of a completed text area (while the
\texttool\ or \mathstool\ is selected) you will simply create a new
overlapping \gls*{textarea}.

If your operating system supports \gls{drag-and-drop}, you can also
\gls{drag-and-drop} text onto the \gls{canvas}. If the drop point is
inside the \gls{textarea} construction field, the dropped text will
be inserted into the field (newline characters will be converted to
spaces). If the drop point is outside the \gls{textarea}
construction field, a new text area will be created for each line of
dropped text. The mapping applied to the dropped text will be
according to the currently selected text tool.  If text is dropped
onto the \gls{canvas} in \selectmode, the text mappings (not
\manmsg{maths} mappings) will be applied. If a file is dropped onto
the \gls{canvas} when either the \texttool\ or \mathstool\ is
active, the file path (or URI) will be added as a new
\gls{textarea}.

\figureref{fig:dndtext} illustrates \gls{drag-and-drop} to create new
\glspl{textarea}.
In \figureref{fig:dndtexta} I have four lines of
text selected in a text editor. The second line simply contains two
space characters (which aren't visible). These four lines of text
are then dragged onto the \gls{canvas},
\figureref{fig:dndtextb}, and dropped. The drop location (the
location of the pointer when the mouse button was released) is
directly on the canvas, not on the \gls{textarea} construction field (which
currently isn't visible). This creates three new \glspl*{textarea},
\figureref{fig:dndtextc}.
The line solely consisting of white space hasn't created a 
\gls{textarea} but has contributed to the vertical offset of the following
\gls{textarea}. In \figureref{fig:dndtextd}, the same three lines of
text are dragged onto the \gls{textarea} construction field and dropped
at the cursor, \figureref{fig:dndtexte}. This has inserted the
dropped text into the \gls{textarea} construction field. The new line
characters have been converted to spaces and the \gls{textarea}
construction field is awaiting further input.

\FloatSubFigs*{fig:dndtext}
{
 {fig:dndtexta}{\includeimg{dndtext1}}{},
 {fig:dndtextb}{\includeimg{dndtext2}}{},
 {fig:dndtextc}{\includeimg{dndtext3}}{},
 {fig:dndtextd}{\includeimg{dndtext4}}{},
 {fig:dndtexte}{\includeimg{dndtext5}}{}
}
[Drag and Drop Text]
{Drag and Drop Text: \subfigref{fig:dndtexta} drag initiated on some
selected text in another application; \subfigref{fig:dndtextb}
selected text dragged onto canvas; \subfigref{fig:dndtextc} the text
that was dropped onto the canvas in \subfigref{fig:dndtextb} has
been converted into three \glspl{textarea}; \subfigref{fig:dndtextd}
the selected text from \subfigref{fig:dndtexta} is now dragged onto
the \gls{textarea} construction field; \subfigref{fig:dndtexte} the
dropped text has been inserted into the construction field.}

\menudef{index.menu.textarea}

Whilst a \gls{textarea} is under construction, you can activate the
\gls{index.menu.textarea}, illustrated in
\figureref{fig:textpopup}, with a \gls{menuclick}. Alternatively,
you can use the \accelerator{popup} key or, if supported by your
system, the \accelerator{context_menu} \gls{context-menu} key.

\FloatFig
  {fig:textpopup}
  {\includeimg{textpopup}}
  {Text Area Popup Menu}

\menudef{menu.textarea.copy}

The \menu{textarea.copy} menu item copies to the clipboard any text within 
the text construction field that has been selected.

\menudef{menu.textarea.cut}

The \menu{textarea.cut} menu item cuts to the clipboard any text within 
the text construction field that has been selected.

\menudef{menu.textarea.paste}

The \menu{textarea.paste} menu item pastes text from the
clipboard to the cursor position in the text construction field.

\menudef{menu.textarea.select_all}

The \menu{textarea.select_all} menu item selects all text in 
the text construction field.

\menudef{menu.textarea.insert_symbol}

The \menu{textarea.insert_symbol} menu item 
opens the \dialog{symbolselector} dialog  if you want to
enter a symbol that doesn't appear on your keyboard. 

\plabel[Insert Symbol Dialog Box]{mi:insertsymbol}% HelpSet id
\widgetdef{symbolselector.title}

\FloatFig
  {fig:insertsymbol}
  {\includeimg[width=\linewidth]{annoteInsertSymbol}}
  {Insert Symbol Dialog Box}

The \dialog{symbolselector} dialog box (see \figureref{fig:insertsymbol})
has a field at the top which contains the text currently in the text
area. If you know the hexadecimal Unicode value for the character
you want to insert, you can type the number into the
\widget{symbolselector.unicode} box and press the
\includeimg{insertAtCaret} \widget{symbolselector.insertAtCaret} button to
insert it into the text field at the caret. 

On the right hand panel below the \widget{symbolselector.unicode} field
there is an enlarged image of the selected character. If there's an
associated mapping it will be displayed below the image
(see \figureref{fig:insertsymbol}), but remember that this mapping
may change if you switch between the \texttool\ and \mathstool\ before
completing the \gls{textarea}.

Alternatively, you can use the button panels on the left to
select the character you want to insert into the text field. Use the
left hand list to display the require Unicode block and either click
on the button with the required character on it to insert and
display the symbol or hold the shift key down while you click to
just display the symbol in the right hand panel without inserting it
into the text field. The available Unicode blocks and symbols are govern by the
\widget{lang.title} tab in the \dialog{configui} dialog.

Once the \gls{textarea} has been finished (by clicking on the
\gls{menu.tools.finish} button or by pressing
\accelerator{menu.tools.finish} or by switching to a non-text
tool) any packages that are required by the mappings will be added
to the \hyperref[sec:preamble]{early-preamble pane}, as shown in
\figureref{fig:addpackage}.  Note that the \gls{canvas} and the
preamble panes have separate undo\slash redo managers so if you undo
a new text area it will remove the new text area but won't remove
the modification to the preamble. You will need to switch to the
early-preamble panel and use its undo button or \gls{popupmenu} item.

\FloatFig
  {fig:addpackage}
  {\includeimg{addpackage}}
  {Package Required by Mapping Added to the Early Preamble}

\begin{important}
The text in your \env{pgfpicture} environment may not
look exactly the same as in \FlowframTk\ due to font differences as
well as the translation of \LaTeX\ commands.
\end{important}

\seealsorefs{%
sec:edittext,
sec:fontanchor,
sec:texconfig,
sec:preamble,
sec:textpaint,
sec:textstyle,
sec:outlinetopath,
sec:splittext,
sec:exportdoc,
sec:neuronexample,
sec:accesstutorial
}

\section{Bitmaps}\label{sec:insertbitmap}

\menudef{menu.bitmap}

\FlowframTk\ is primarily a \gls{vectorgraphics} application,
however it is possible to insert a \maingls{bitmap}
(\gls{rastergraphics}) into your picture for background effects or
if you want to annotate a \gls{bitmap} (as was done in
\figureref{fig:insertsymbol}).  Note that
\FlowframTk\ does not save the actual \glslink{rastergraphics}{raster} data in either
the \gls{JDR} or the \gls{AJR} file, but instead it creates a reference
to the original file. You can't edit the actual bitmap data in
\FlowframTk. However you can scale, rotate or shear the link
using the \gls{affine-transformation} functions described in 
\sectionref{sec:affinetrans} or by directly editing the
bitmap's \gls{bitmap.transformation-matrix}. 

\begin{important}
If you change the location of the file containing the bitmap, when
\FlowframTk\ reloads the \gls*{JDR} or \gls*{AJR} file it will
prompt you to either provide the new location or discard the reference.
\end{important}

\menudef{menu.bitmap.insert}

To insert a \gls{bitmap} into your picture, first make sure you are using
the \tool{select} (and no shapes are
being edited or distorted), and then select the menu item
\menu{bitmap.insert} and a file selector dialog box will appear in which
you can choose the required \gls{bitmap}. The \gls{bitmap} will initially appear
in the top left hand corner of the \gls{canvas} but can be
\hyperref[sec:moveobjects]{moved} to a new location.  If your
operating system supports \gls{drag-and-drop}, you can also drag a
\gls{bitmap} file onto the \gls{canvas} (in \selectmode) and it will
be inserted at the drop location.

If there is insufficient memory in the \gls{jre} to load a bitmap,
\FlowframTk\ will revert to draft mode to display that bitmap.  For
example, in \figureref{fig:draftbitmap} several photos have been
inserted into an image. Since photos tend to be quite large, there
is insufficient memory to load the final photo, so it is displayed
in draft mode instead. Note that draft mode will also be used when
printing or when \hyperref[sec:exportpng]{exporting to PNG}. Since \LaTeX\ files
only contain a link to the bitmap, draft mode should not affect
exporting to \LaTeX\ files or to formats that use \app{latex} or
\app{pdflatex} as an intermediate step.

Note that the amount of memory available to any Java application is
set at startup. The default maximum value can be changed via the
\gls{jre} command line options.  If you run \FlowframTk\ from the
shell script \app{flowframtk}, then you can set the environment
variable \gls{JDR_JVMOPTS} to change the default configuration. See
\sectionref{sec:cmdargs} for further details. If you are running
\FlowframTk\ from Windows, you will need to check the \gls*{jre}
documentation.

\FloatFig
  {fig:draftbitmap}
  {\includeimg{draftBitmap}}
  [Bitmaps Are Displayed in Draft Mode When There is Insufficient Memory in the JRE]
  {Bitmaps are displayed in draft mode
when there is insufficient memory in the \gls{jre}. The area taken up by
the image is displayed as a semi-transparent light \manmsg{grey} rectangle
with the bitmap's file name in square brackets.}

\menudef{menu.bitmap.refresh}

If you use another application to edit the bitmap whilst
you have a picture with a link to it displayed in \FlowframTk, you will
need to select \menu{bitmap.refresh} to update the image.

\menudef{menu.bitmap.properties}

The \menu{bitmap.properties} menu item will open the 
\dialog{bitmap_properties} dialog (see \sectionref{sec:bitmapprops}).

\menudef{menu.bitmap.vectorize}

The \menu{bitmap.vectorize} function is an experimental
feature. It's only available if \app{flowframtk} is invoked with
the \switch{experimental} switch.

Currently undocumented and may be removed.

\subsection{Properties}\label{sec:bitmapprops}

\widgetdef{bitmap_properties.title}

To change a \gls{bitmap}['s] properties (file reference, alternative
\LaTeX\ path, or \gls{bitmap.transformation-matrix}), \select\
the required \gls{bitmap} and select the \menu{bitmap.properties}
menu item. This will open up the \dialog{bitmap_properties} dialog box shown in
\figureref{fig:bitmapprops}. If you want to change the path name to
the bitmap, you can either type it directly into the
\widget{label.filename} field or click on the
\widget{browsebitmap.browse} button.

You can also use the \dialog{bitmap_properties} dialog to change the
\gls{bitmap.transformation-matrix} applied to the bitmap link.
If you want to reset the \gls{bitmap.transformation-matrix}, it's
quicker to use the \menu{transform.reset} menu item.

\FloatFig
 {fig:bitmapprops}
 {\includeimg{bitmapprops}}
 {Bitmap Properties Dialog}

If you want to \filefn{export} your picture to a \LaTeX\ file or
to a format that uses \app{latex} or \app{pdflatex} as an intermediate
step, the \LaTeX\ command can either be \gls{pgfimage} or
\gls{includegraphics} and is specified in the
\widget{bitmap_properties.command} field. The command argument in
either case must use a \gls{forwardslash} as the directory divider. If
the \widget{bitmap_properties.auto_latexfilename} \gls*{checkbox}
is selected, this substitution will be performed automatically by
the export function. Alternatively, you can unselect
the \widget{bitmap_properties.auto_latexfilename} \gls*{checkbox}
which will enable the
\widget{bitmap_properties.latexfilename} field in which you
can enter the argument to be used by the image command. If you use the
export to PostScript or \gls{svg} function, \FlowframTk\ will
attempt to create an EPS version of the bitmap (if it doesn't
already exist) since \app{latex} (as opposed to
\app{pdflatex}) can't include bitmap formats, such as PNG and
JPEG.

\seealsorefs{sec:bitmapconfig}

\subsection{Vectorizing}\label{sec:vectorize}

The \menu{bitmap.vectorize} function is an experimental
feature. It's only available if \FlowframTk\ is invoked with
the \switch{experimental} switch.

Currently undocumented and may be removed.


\section{From SVG Specs}\label{sec:newfromsvg}

\menudef{menu.tools.create_path_from_svg}

It's also possible to create a \gls+{path} by using the same syntax
as the \gls+{svg} path \qtt{d} property. Use the \menu{tools.create_path_from_svg}
menu item to open the \dialog{svg_path} dialog.
(You will need to be in \selectmode\ with no selected
\glspl{object}.)

\widgetdef{svg_path.title}

The \dialog{svg_path} dialog has an upper panel that's used to draw
the \gls{svg} path so that you can check it before adding it to the
\gls{canvas}. The lower panel has a text box in which you can type
in the data. For example: 
\begin{compactcodebox}
M 100 100 L 300 400
\end{compactcodebox}
This would create a path consisting of a single line segment.
Note that the sample panel will shift the path to the top left
corner so that you don't need to scroll to find it. When the actual path
is added to the \gls{canvas}, it will be placed at the calculated
\glspl{co-ordinate}.

\begin{warning}
Arcs are currently not implemented.
\end{warning}

\widgetdef{svg_path.data_coords}

\gls{svg} data normally uses a right-handed \gls{co-ordinate} system.
That is, the origin is at the bottom left and $y$ increases upwards.
The \gls{canvas} uses a left-handed \gls{co-ordinate} system
with the origin at the top left and $y$ increases downwards.
The \gls{co-ordinate} system needs to be set before creating the
draft path.

\widgetdef{svg_path.data_coords.righthand}

If the \widget{svg_path.data_coords.righthand} button is selected,
the \glspl{co-ordinate} will be converted from right-handed to
left-handed. This will take the current paper size into account.

\widgetdef{svg_path.data_coords.lefthand}

If the \widget{svg_path.data_coords.lefthand} button is selected,
no \gls{co-ordinate} conversion will be applied.

\widgetdef{svg_path.unit}

Select the unit of measurement in the \inlineglsdef{svg_path.unit} 
\gls{dropdown} box. This should be done before creating the draft
path.

\begin{important}
If you change either the \gls{co-ordinate} system
or unit after the draft path has been created, you will need to recreate the
draft path to update the \glspl{co-ordinate}.
\end{important}

\widgetdef{svg_path.dotask}

Click on the \widget{svg_path.dotask} button to create a draft path. (The current
styles will be added to the path when it's added to the canvas.)

\widgetdef{svg_path.description}

If you want the new path to have a description, enter the required 
description in the \widget{svg_path.description} text box.
Clear the box if you don't want a description.

Once you're happy with the draft path, click on the \widget{okay}
button to close the dialog and add the new \gls{path} to the \gls{canvas}.

\chapter{Selecting, Navigation and Basic Editing}\label{sec:selectobjects}

\menudef{menu.tools.select}

In order to edit an \gls{object}, you must be in \selectmode. To do
this either click on the \gls{menu.tools.select} button or use the 
\menu{tools.select} menu item. An \gls*{object} can
be selected using any of the following methods:
\begin{itemize}
\item Click on it with the \glslink{primaryclick}{primary mouse button}.

\item \Gls{doubleclick} the primary mouse button to
select the \gls*{object} \glslink{backobject}{behind} the current \gls*{object}.

\item Use \keyref{ctrl}-click (that is, \gls{click} whilst holding down the control
\keys{\keyref{ctrl}} key) if you want to add an \gls*{object} to the current
selection.

\item \Gls{click} on an empty part of the \gls{canvas} and
drag. A dashed rectangle will appear. When you release the mouse
button, any \glspl*{object} within that
region will be selected. (If you have the shift \keys{\keyref{shift}} key depressed,
only those objects which are completely inside the dashed
rectangle will be selected, but make sure you release the mouse
button before releasing the shift key.)

\item Use the \menu{navigate} menu (see \sectionref{sec:navigate}).

\end{itemize}

\menudef{menu.edit.select_all}

The \menu{edit.select_all} menu item will select all
\glspl{object}.

\menudef{menu.edit.deselect_all}

The \menu{edit.deselect_all} menu item will deselect all
\glspl{object}. You can also click on
an empty part of the \gls{canvas} to deselect all \glspl{object}.
Selecting another tool will also deselect all \glspl*{object}.

\begin{information}
To deselect an individual \gls*{object}, click on that object whilst
depressing the shift \keys{\keyref{shift}} key.
\end{information}

When an \gls{object} is selected, a dashed red\slash\manmsg{grey}
rectangle will be displayed around it. This rectangle is the 
\emph{\inlineglsdef{selection-bbox}} and may optionally have
\gls{hotspot} regions. Note that individual elements of a
\gls{group} can not be selected independently of the group.  When
you select a group, you will only see a dashed
red\slash\manmsg{grey} rectangle around the \gls{bbox} of the group,
not around the individual elements of the group.

In \selectmode\ you can \gls{drag-and-drop} \gls{JDR} or \gls{AJR}
files onto the \gls{canvas} (provided your operating system supports
drag and drop) which will add all the objects from those files to
the current image. The new objects will be added to the current
selection. You can't drag and drop if a shape is being edited or
distorted.

If text is dropped onto the \gls{canvas} in \selectmode, the text
mappings (not \manmsg{maths} mappings) will be applied. If a file is
dropped onto the \gls{canvas} in \textmode\ or \mathsmode, instead of
in \selectmode, the file path (or URI) will be added as a new \gls{textarea}.

\section{Selection Popup Menus}
\label{sec:selectpopups}

In \selectmode, you can also \gls{menuclick} to activate the
selection \gls{popupmenu}. The contents of this menu vary according to
what types of \glspl*{object} have been \selected, if any.

% COMMON POPUP MENU ITEMS

\menudef{index.menu.selected}

Common popup menu items are listed below.

\menudef{menu.selected.object_description}

To assign a description to the selected \gls{object}, use
\menu{selected.object_description}. This is the same as using the
\menu{edit.object_description} menu item from the main menu bar.
This option will only be available if there is exactly one
\gls{object} selected.

\menudef{menu.selected.cut}

Cut the selected \gls{object} (or \glspl{object}) to the clipboard.
This is the same as using the \menu{edit.cut} menu item from the
main menu bar. At least one \gls{object} needs to be selected.

\menudef{menu.selected.copy}

Copy the selected \gls{object} (or \glspl{object}) to the clipboard.
This is the same as using the \menu{edit.copy} menu item from the
main menu bar. At least one \gls{object} needs to be selected.

\menudef{menu.selected.paste}

Paste any \gls{object} or \glspl{object} from the clipboard onto the
\gls{canvas}.
This is the same as using the \menu{edit.paste} menu item from the
main menu bar.

\menudef{menu.selected.select_all}

Select all \glspl{object}.
This is the same as using the \menu{edit.select_all} menu item from the
main menu bar.

\menudef{menu.selected.deselect_all}

Deselect all \glspl{object}.
This is the same as using the \menu{edit.deselect_all} menu item from the
main menu bar. There must be at least one \gls{object} selected.

\menudef{menu.selected.group}

Group all selected \glspl{object}. There must be more than one
object selected.
This is the same as using the \menu{transform.group} menu item from the
main menu bar.

% NONE SELECTED POPUP

\menudef{index.menu.none}

\FloatFig
  {fig:selectpopups.none}
  {\includeimg{selectPopupNone}}
  {Popup Menu When No Objects are Selected}

If nothing is selected, there will only be a few options available
(\figureref{fig:selectpopups.none}).

\menudef{menu.none.image_description}

To assign a description to the whole image, use
\menu{none.image_description}. This is the same as using the
\menu{file.image_description} menu item from the main menu bar.

\menudef{menu.none.find_by_description}

To select an \gls{object} by its description, use
\menu{none.find_by_description}. This is the same as using the
\menu{navigate.by_description} menu item.

\menudef{menu.none.insert_bitmap}

To insert a \gls{bitmap}, use \menu{none.insert_bitmap}. This
is the same as using the \menu{bitmap.insert} menu item from the main menu bar.

The \menu{selected.select_all} and \menu{selected.paste} common menu
items are also available.

% PATH POPUP

\menudef{index.menu.selectedpath}

\FloatFig
  {fig:selectpopups.path}
  {\includeimg{selectPopupPath}}
  {Popup Menu when only Paths are Selected}

\menudef{menu.selectedpath.path_description}

To set or edit the \gls{path}['s] description, use
\menu{selectedpath.path_description}. This is the same as
the general \menu{selected.object_description} menu item but has a more specific label.

In addition to the \gls{index.menu.selected},
if a path is selected then the following options will be available
(\figureref{fig:selectpopups.path}).

\menudef{menu.selectedpath.edit}

To edit the path, use \menu{selectedpath.edit}. This is the same as using
the \menu{edit.path.edit} menu item from the main menu bar.
This option won't be available if there is more than one
path selected.

\menudef{menu.selectedpath.distort}

To distort the path, use \menu{selectedpath.distort}. This is the same as using
the \menu{transform.distort} menu item from the main menu bar.
This option won't be available if there is more than one
path selected.

\menudef{menu.selectedpath.line_colour}

To change the path's \pathattr{line-paint}, use
\menu{selectedpath.line_colour}. This is the same as using the
\menu{edit.path.line_colour} menu item from the main menu bar.

\menudef{menu.selectedpath.fill_colour}

To change the path's \pathattr{fill-paint}, use
\menu{selectedpath.fill_colour}. This is the same as using the
\menu{edit.fill_colour} menu item from the main menu bar.

\menudef{menu.selectedpath.all_styles}

To change all the path styles for the selected paths,
use \menu{selectedpath.all_styles}. This is the same as using the
\menu{edit.path.style.all_styles} menu item from the main menu bar.

\menudef{menu.selectedpath.linewidth}

To change the line width for the selected paths,
use \menu{selectedpath.linewidth}. This is the same as using the
\menu{edit.path.style.linewidth} menu item from the main menu bar.

\menudef{menu.selectedpath.dashpattern}

To change the line pattern (dash or solid) for the selected paths,
use \menu{selectedpath.dashpattern}. This is the same as using the
\menu{edit.path.style.dashpattern} menu item from the main menu bar.

\menudef{menu.selectedpath.capstyle}

To change the cap style for the selected paths,
use the \menu{selectedpath.capstyle} sub menu. This is the same as using the
\menu{edit.path.style.capstyle} sub menu from the main menu bar.

\menudef{menu.selectedpath.joinstyle}

To change the join style for the selected paths,
use \menu{selectedpath.joinstyle}. This is the same as using the
\menu{edit.path.style.joinstyle} menu item from the main menu bar.

To change the winding rule for the selected paths,
use the \menu{selectedpath.windingrule} sub menu. This is the same as using the
\menu{edit.path.style.windingrule} sub menu from the main menu bar.

\menudef{menu.selectedpath.marker}

The \menu{selectedpath.marker} sub menu has the following options:

\menudef{menu.selectedpath.marker.all}

To change all the path markers to the same type for the selected paths,
use \menu{selectedpath.marker.all}. This is the same as using the
\menu{edit.path.style.all_markers} menu item from the main menu bar.

\menudef{menu.selectedpath.marker.start}

To change the start marker for the selected paths,
use \menu{selectedpath.marker.start}. This is the same as using the
\menu{edit.path.style.startarrow} menu item from the main menu bar.

\menudef{menu.selectedpath.marker.mid}

To change the mid marker for the selected paths,
use \menu{selectedpath.marker.mid}. This is the same as using the
\menu{edit.path.style.midarrow} menu item from the main menu bar.

\menudef{menu.selectedpath.marker.end}

To change the end marker for the selected paths,
use \menu{selectedpath.marker.end}. This is the same as using the
\menu{edit.path.style.endarrow} menu item from the main menu bar.


% TEXT POPUP

\menudef{index.menu.selectedtext}

\FloatFig
  {fig:selectpopups.text}
  {\includeimg{selectPopupText}}
  {Popup Menu when only Text-Areas are Selected}

\menudef{menu.selectedtext.textarea_description}

To set or edit the \gls{path}['s] description, use
\menu{selectedtext.textarea_description}. This is the same as
the general \menu{selected.object_description} menu item but has a more specific label.

In addition to the \gls{index.menu.selected},
if a \gls{textarea} is selected then the following options will be available
(\figureref{fig:selectpopups.text}).

\menudef{menu.selectedtext.edit}

To edit the \gls{textarea}['s] displayed text or \LaTeX\
alternative, use \menu{selectedtext.edit}. This is the same as using
the \menu{edit.textarea.edit} menu item from the main menu bar.
This option won't be available if there is more than one
\gls{textarea} selected.

\menudef{menu.selectedtext.colour}

To change the \gls{textarea}['s] pen (or \textattr{outline}) \textattr{paint}, use
\menu{selectedtext.colour}. This is the same as using the
\menu{edit.textarea.colour} menu item from the main menu bar.

\menudef{menu.selectedtext.outline}

To toggle \textattr{outline} mode for the \gls{textarea}, use \menu{selectedtext.outline}.
This is the same as using the \menu{edit.textarea.outline} menu item
from the main menu bar.

\menudef{menu.selectedtext.fill_colour}

To change the \gls{textarea}['s] \textattr{fill-paint}, use
\menu{selectedtext.fill_colour}. This is the same as using the
\menu{edit.fill_colour} menu item from the main menu bar.
This action is only available if the \textattr{outline} setting is on.

\menudef{menu.selectedtext.all_styles}

To change all the text styles for the selected \glspl{textarea},
use \menu{selectedtext.all_styles}. This is the same as using the
\menu{edit.textarea.font.all_styles} menu item from the main menu bar.

\menudef{menu.selectedtext.family}

To change just the font family for the selected \glspl{textarea},
use \menu{selectedtext.family}. This is the same as using the
\menu{edit.textarea.font.family} menu item from the main menu bar.

\menudef{menu.selectedtext.size}

To change just the font size for the selected \glspl{textarea},
use \menu{selectedtext.size}. This is the same as using the
\menu{edit.textarea.font.size} menu item from the main menu bar.

\menudef{menu.selectedtext.shape}

To change just the font shape for the selected \glspl{textarea},
use \menu{selectedtext.shape}. This is the same as using the
\menu{edit.textarea.font.shape} menu item from the main menu bar.

\menudef{menu.selectedtext.series}

To change just the font series (weight) for the selected \glspl{textarea},
use \menu{selectedtext.series}. This is the same as using the
\menu{edit.textarea.font.series} menu item from the main menu bar.

\menudef{menu.selectedtext.anchor}

To change just the \textattr{anchor} (horizontal, vertical or both) for the
selected \glspl{textarea}, use the \menu{selectedtext.anchor}
sub-menu. This is the same as using the
\menu{edit.textarea.font.anchor.both} sub-menu from the main menu
bar.

\menudef{menu.selectedtext.reset}

To reset the \gls{textarea}['s] transformation matrix, use 
\menu{selectedtext.reset}. This is the same as using the 
\menu{transform.reset} menu item from the main menu bar.
This option won't be available if there is more than one
\gls{textarea} selected.

% TEXT-PATH POPUP

\menudef{index.menu.selectedtextpath}

\FloatFig
  {fig:selectpopups.textpath}
  {\includeimg{selectPopupTextPath}}
  {Popup Menu when a Text-Path is Selected}


If a text-path has been selected then the
\gls{index.menu.selectedtextpath} is very similar to the
\gls{index.menu.selectedtext} but additionally has the
\menu{selectedpath.edit} menu item to switch on edit mode for the
underlying path.

\menudef{menu.selectedtextpath.textpath_description}

To set or edit the \gls{textpath}['s] description, use
\menu{selectedtextpath.textpath_description}. This is the same as
the general \menu{selected.object_description} menu item but has a more specific label.

% BITMAP POPUP

\menudef{index.menu.selectedbitmap}

\FloatFig
  {fig:selectpopups.bitmap}
  {\includeimg{selectPopupBitmap}}
  {Popup Menu when only Bitmaps are Selected}

\menudef{menu.selectedbitmap.bitmap_description}

To set or edit the \gls{bitmap}['s] description, use
\menu{selectedbitmap.bitmap_description}. This is the same as
the general \menu{selected.object_description} menu item but has a more specific label.

In addition to the \gls{index.menu.selected},
if a \gls{bitmap} is selected then the following options will be available
(\figureref{fig:selectpopups.bitmap}).

\menudef{menu.selectedbitmap.properties}

To edit the \gls{bitmap}['s] properties, use
\menu{selectedbitmap.properties}. This is the same as using
the \menu{bitmap.properties} menu item from the main menu bar.
This option won't be available if there is more than one
\gls{bitmap} selected.

\menudef{menu.selectedbitmap.reset}

To reset the \gls{bitmap}['s]
transformation matrix, use \menu{selectedbitmap.reset}. This is the
same as using the \menu{transform.reset} menu item from the main menu
bar.

\menudef{menu.selectedbitmap.insert}

To insert another \gls{bitmap}, use \menu{selectedbitmap.insert}. This is the
same as using the \menu{bitmap.insert} menu item from the main menu
bar.

% GROUPS OR MIXTURE

\menudef{index.menu.selectedgroup}

\FloatFig
  {fig:selectpopups.other}
  {\includeimg{selectPopupOther}}
  {Popup Menu when Groups or Mixture are Selected}

\menudef{menu.selectedgroup.group_description}

To set or edit a selected \gls{group}['s] description, use
\menu{selectedgroup.group_description}. This is the same as
the general \menu{selected.object_description} menu item but has a more specific label.

In addition to the \gls{index.menu.selected},
if any \glspl{group} or mixture of \glspl{object} are selected 
then following option will be available
(\figureref{fig:selectpopups.other}).

\menudef{menu.selected.ungroup}

To ungroup any selected \glspl{group}, use
\menu{selected.ungroup}. This is the same as using the
\menu{transform.ungroup} menu item from the main menu bar.
This option won't be available if there are no
\glspl{group} selected.

\menudef{menu.selected.path}

If any \glspl{path} have been selected or if any selected
\glspl{group} contain any \glspl{path}, then the
\menu{selected.path} sub menu will be available. This has the same
menu items as \gls{index.menu.selectedpath}.

\menudef{menu.selected.textarea}

If any \glspl{textarea} have been selected or if any selected
\glspl{group} contain any \glspl{textarea}, then the
\menu{selected.textarea} sub menu will be available. This has the same
menu items as \gls{index.menu.selectedtext}.

\menudef{menu.selected.fill_colour}

If any \glspl{path} have been selected or if any \glspl*{textarea}
have been selected with \textattr{outline} mode on, then the
\menu{selected.fill_colour} menu item will be available. This is the
same as using the \menu{edit.fill_colour} menu item from the main
menu bar.

\menudef{menu.selected.bitmap}

The \menu{selected.bitmap} sub menu has the same
menu items as \gls{index.menu.selectedbitmap}.

\menudef{menu.selected.justify}

To justify the contents of any selected \glspl{group}, use the
\menu{selected.justify} sub menu. This is the same as using the
\menu{transform.justify} sub menu from the main menu bar.
This option won't be available if there are no
\glspl{group} selected.


\section{Navigation Menu}\label{sec:navigate}

\menudef{menu.navigate}

The \menu{navigate} menu provides a way to navigate around the
\gls{canvas} and can help to \select\ \glspl{object}
in a cluttered image.

\menudef{menu.navigate.goto}

The \menu{navigate.goto} menu item opens the
\inlineglsdef{goto.title} dialog (\figureref{fig:goto}).  Enter the
$x$ and $y$ co-ordinates in the \widget{coordinates.x} and
\widget{coordinates.y} fields if you are using a rectangular grid,
or enter the angle and radius in the \widget{coordinates.angle} and
\widget{coordinates.radius} fields, if you are using a radial grid.

\FloatFig
  {fig:goto}
  {\includeimg{goto}}
  {Go To Co-ordinate Dialog Box}

If your system allows applications to move the cursor
(via the \gls{robot}), the cursor will be moved to the entered
co-ordinates (scrolling the \gls{canvas} if necessary).

\menudef{menu.navigate.select}

The \menu{navigate.select} menu item 
\selects\ the next \gls{object} in the \gls{stack}. (Starting from the
\gls{front} and heading towards the \gls{back}.) This will cycle back to
the start when it reaches the end of the \gls{stack}.

\menudef{menu.navigate.skip}

The \menu{navigate.skip} menu item will deselect the
selected \gls{object} closest to the \gls{back}, and \select\
the next \gls{object} in the \gls{stack} (heading towards the \gls{back}). This
will cycle back to the start when it reaches the end of the stack.
If you have more than one \gls{object} selected, the remaining
\glspl*{object} will stay selected.

\menudef{menu.navigate.add_next}

The \menu{navigate.add_next} menu item will add
the next \gls{object} in the \gls{stack} to the selection (starting from
the \gls{front} and heading towards the \gls{back}). This will cycle back to
the start when it reaches the end of the stack.

\menudef{menu.navigate.find}

If an \gls{object} is already \selected, the \menu{navigate.find}
menu item will scroll the \gls{canvas} to ensure the \gls{object} is
in the viewport. If your system allows applications to move the
cursor (via the \gls{robot}), the cursor will be moved to the top left corner of the
\gls{object}['s] bounding box.

\menudef{menu.navigate.by_description}

\plabel[Find by Description]{mi:findbydesc}%
The \menu{navigate.by_description} menu item will open the
\dialog{findbydescription} dialog box. 

\widgetdef{findbydescription.title}

\FloatFig
 {fig:findbydescription}
 {\includeimg{findbydesc}}
 {Find By Description Dialog (Filter Widgets Visible)}

The \dialog{findbydescription} dialog has all the
\glspl{object} (that are visible and are not part of a \gls{group}) listed by their
description.  If an object doesn't have the description set, a
generic description is used. 

The generic description starts with the object type followed by a
colon and a space. The part after that depends on the object type.
For example, a \gls{textarea} and a \gls{textpath} will show the
text followed by the \LaTeX\ text in parentheses. A path will show
the number of segments. The exception to this is when an object has
associated \gls{flowframe} data, in which case the generic
description will be the frame type followed by the frame label.

Select the required row (or rows) and
click \btn{okay}.  This will first deselect any currently selected
\glspl{object} and then select each object corresponding to the
selected row or rows.

\widgetdef{findbydescription.filter}

If your image has many \glspl{object}, you may find it difficult
searching through the list. In this case, you may prefer to filter
the list. This may be done by selecting the \widget{findbydescription.filter}
checkbox, which will show the filter widgets (see \figureref{fig:findbydescription}).

\begin{important}
Remember that \keys{\keyref{return}} will be equivalent to using the
\widget{okay} button, which will search for the \glspl{object}
corresponding to the selected items in the list. If you change the
filter settings, you need to use the \widget{findbydescription.update} button or the
mnemonic \mnemonic{findbydescription.update}.
\end{important}

\widgetdef{findbydescription.match}
There are three conditional rows: a match on the object type, a
match on the object's description (or generic description if not
set), and a match on the object's tag. The \widget{findbydescription.match}
radio buttons indicate whether or not all three conditional rows
must match or whether only at least one should match.

\widgetdef{findbydescription.match.all}
If the \widget{findbydescription.match.all} button is selected then
all three conditional rows must be true.

\widgetdef{findbydescription.match.any}
If the \widget{findbydescription.match.any} button is selected then
one or more of the three conditional rows must be true.

\widgetdef{findbydescription.object_type}
The first conditional row is a match on the object type. If the
object matches any of the selected checkboxes in this row, then the
conditional for this row is true. Note that for
\glspl{compositeshape}, the type refers to the outermost shape not
the underlying shape.

\widgetdef{findbydescription.match_description}
The second conditional row is a match on the description or on the
generic description. 

\widgetdef{findbydescription.match_tag}
The third conditional row is a match on the tag. 

For both the second and third row, the 
\inlineglsdef{findbydescription.str_match_op} \gls{dropdown} determines
the test criteria.

\widgetdef{findbydescription.str_match_op.any}
The \widget{findbydescription.str_match_op.any} operand
automatically makes the conditional row true.

\widgetdef{findbydescription.str_match_op.set}
The \widget{findbydescription.str_match_op.set} operand makes the
conditional row
true if the object's description (for the second row) or the
object's tag (for the third row) has been set to a non-empty value.

\widgetdef{findbydescription.str_match_op.not_set}
The \widget{findbydescription.str_match_op.not_set} operand makes the
conditional row
true if the object's description (for the second row) or the
object's tag (for the third row) has not been set to a non-empty value.

\widgetdef{findbydescription.str_match_op.equals}
The \widget{findbydescription.str_match_op.equals} operand makes the
conditional row
true if the displayed description (for the second row) or the
object's tag (for the third row) has been set to the text provided
in the next field (which should automatically become visible when
this operand is selected).

The displayed description is the description shown in the selection
list. (That is, the object's description, if set, or the generic
description, otherwise.)

\widgetdef{findbydescription.str_match_op.not_equals}
The \widget{findbydescription.str_match_op.not_equals} operand makes the
conditional row
true if the displayed description (for the second row) or the
object's tag (for the third row) is not equal to the text in the
next field (which should automatically become visible when
this operand is selected).

\widgetdef{findbydescription.str_match_op.contains}
The \widget{findbydescription.str_match_op.contains} operand makes the
conditional row
true if the displayed description (for the second row) or the
object's tag (for the third row) contains the text provided
in the next field (which should automatically become visible when
this operand is selected).

\widgetdef{findbydescription.str_match_op.regex}
The \widget{findbydescription.str_match_op.regex} operand makes the
conditional row
true if the displayed description (for the second row) or the
object's tag (for the third row) matches the anchored regular
expression provided in the next field (which should automatically
become visible when this operand is selected).

For example, if an object has its tag set to \code{window} then
the regular expression \code{.*in.*} will match but \code{.*in} won't.

\widgetdef{findbydescription.update}

Once you have setup the filter criteria, click on the
\widget{findbydescription.update} button to the right to update the
list of matching objects.

\widgetdef{findbydescription.reset}
The \widget{findbydescription.reset} button will reset the filter
criteria back to its default settings.

\menudef{menu.navigate.add_description}

The \menu{navigate.add_description} menu item will open the
\inlineglsdef{addbydescription.title} dialog box. This is the same
as the \dialog{findbydescription} dialog box, but in this case any
existing selection won't first be deselected.

\section{Moving an Object Up or Down the Stacking Order}\label{sec:moveupordown}

\Glspl{object} are \glslink{drawing-on-canvas}{painted} on the
\gls{canvas} according to the
\maingls{stackingorder}. This means that objects can
partially or wholly obscure other objects in the same location.
The first object to be \glslink{drawing-on-canvas}{painted}
is the \maingls{backobject} (behind any other object in the same
location) and the last object to be \glslink{drawing-on-canvas}{painted}
is the \maingls{frontobject}.

For example, in \figureref{fig:stackingordera} the green rectangle is
at the bottom (\gls{back}) of the stack ($z=0$), the blue circle is in
the middle of the stack ($z=1$) and the yellow triangle is at the
top (\gls{front}) of the stack ($z=2$). The stacking order has
been reversed in \figureref{fig:stackingorderb}, with the green
rectangle now at the top (front) of the stack ($z=2$) and
the yellow triangle now at the bottom (back) of the stack
($z=0$).

\FloatSubFigs{fig:stackingorder}
{
  {fig:stackingordera}{\includeimg{stackingordera}}{},
  {fig:stackingorderb}{\includeimg{stackingorderb}}{}
}
{Stacking Order}

If \glspl{object} don't overlap or if they don't have a
\gls{index.fill-colour}, the \gls{stackingorder} may not be
immediately apparent, but the order is important when you're
defining frames for the \sty{flowfram} package. You can cycle the
selection in reverse order from front to back of the stack using the
\menu{navigate.select} menu item.

\menudef{menu.edit.front}

Each new \gls{object} is automatically added to the \gls{front} when it is
created, but \glspl{object} can also be moved to the \gls{front} 
with the \menu{edit.front} menu item.

\menudef{menu.edit.back}

A selected \gls{object} can be moved to the
\gls{back} of the \gls{stack} (so that other \glspl{object} in the
same location obscure it) with the \menu{edit.back} menu item.

\menudef{menu.edit.moveup}

An object can be moved up the \gls{stackingorder} using
the \menu{edit.moveup} menu item.

\menudef{menu.edit.movedown}

An object can be moved down the \gls{stackingorder} using
the \menu{edit.movedown} menu item.


\section{Grouping and Ungrouping Objects}\label{sec:grouping}

A \gls{group} is a collection of \glspl{object} that are treated as
though they are a single entity. When you select a \gls{group}, you
will only see the \gls{bbox} of the entire group, not the
\glspl*{bbox} of each individual object within the group. If a
\gls{group} is \hyperref[sec:rotateobjects]{rotated},
\hyperref[sec:scaleobjects]{scaled} or \hyperref[sec:shearobjects]{sheared}, each
\gls*{object} within the group will maintain its relative position.
Objects within a \gls{group} may also be
\hyperref[sec:alignobjects]{aligned}.  Note that a \gls{group} can
not be edited. Grouping and ungrouping \glspl*{object} may change
the \gls{stackingorder}.

\menudef{menu.transform.group}

To group \glspl*{object}, first \select\
all the objects you want in the \gls{group}, and then select the
\menu{transform.group} menu item.

\menudef{menu.transform.ungroup}

To \inlineglsdef{ungroup} a group, first \select\ the
group, and then select the \menu{transform.ungroup} menu item. Note
that this function is not recursive: if a group contains other
groups when you ungroup the outer group, the inner groups will
remain.  Any description assigned to a group will be lost when it's
ungrouped.

\begin{warning}
Note that if you ungroup an \gls*{object} containing
\hyperref[sec:flowframe]{flowframe} related
data, the \gls{flowframe} information will be lost. If you group objects
containing flowframe data, and then assign that group flowframe data,
any flowframe data assigned to the contents of that group will be
removed.
\end{warning}

\seealsorefs{
 sec:rotateobjects,
 sec:scaleobjects,
 sec:shearobjects,
 sec:moveupordown,
 sec:alignobjects
}


\section{Aligning Objects}\label{sec:alignobjects}

\menudef{menu.transform.justify}

It is only possible to align \glspl{object} that form part of a
\gls{group}. Objects within a group can be aligned vertically or
horizontally using the \menu{transform.justify} sub menu.

Note that alignment is not recursive: if a group contains another
group, the contents of the sub group will not be aligned, each
element in the sub group will be moved by the same amount.

\menudef{menu.transform.justify.left}

The \menu{transform.justify.left} menu item will move all objects
within the \gls{group} so that the left edge of each object's \gls{bbox}
lies along the left edge of the group's \gls*{bbox}.  (See
\figureref{fig:alignex1b}.)

\menudef{menu.transform.justify.centre}

The \menu{transform.justify.centre} menu item will move all objects
within the \gls{group} so that they are \manmsg{centred} horizontally
within the group's \gls*{bbox}.  (See \figureref{fig:alignex1c}.)

\menudef{menu.transform.justify.right}

The \menu{transform.justify.right} menu item will move all objects
within the \gls{group} so that the right edge of each object's \gls*{bbox}
lies along the right edge of the group's \gls*{bbox}.  (See
\figureref{fig:alignex1d}.)

\menudef{menu.transform.justify.top}

The \menu{transform.justify.top} menu item will move all objects
within the \gls{group} so that the top of each object's \gls*{bbox} lies along the
top of the group's \gls*{bbox}.

\menudef{menu.transform.justify.middle}

The \menu{transform.justify.middle} menu item will move all objects
within the \gls{group} so that they are \manmsg{centred} vertically
within the group's \gls{bbox}.

\menudef{menu.transform.justify.bottom}

The \menu{transform.justify.bottom} menu item will move all objects
within the \gls{group} so that the bottom of each object's \gls*{bbox} lies
along the bottom of the group's \gls*{bbox}.

\FloatSubFigs{fig:alignex1}
{
  {fig:alignex1a}{\includeimg{alignex1a}}{},
  {fig:alignex1b}{\includeimg{alignex1b}}{},
  {fig:alignex1c}{\includeimg{alignex1c}}{},
  {fig:alignex1d}{\includeimg{alignex1d}}{}
}
[Aligning a Group Consisting of Three Objects]
{Aligning a group consisting of three objects: 
\subfigref{fig:alignex1a} original; 
\subfigref{fig:alignex1b} left justified; 
\subfigref{fig:alignex1c} \manmsg{centre} justified; 
\subfigref{fig:alignex1d} right justified.}

If the \widget{textconfig.anchor} \gls{checkbox} in the
\hyperref[sec:texconfig]{TeX Configuration Settings Dialog} is
selected, any \glspl{textarea} that are contained in a group that is
justified will automatically have their \textattrpl{anchor} changed.
For example, in \figureref{fig:alignex1} one of the objects is a
\gls*{textarea}.  If the auto anchor update facility is enabled, the
\gls*{textarea} in \figureref{fig:alignex1b} will have its
horizontal \textattr{anchor} changed to \widget{font.anchor.left},
in \figureref{fig:alignex1c} it will have its horizontal
\textattr{anchor} changed to \widget{font.anchor.hcentre} and in
\figureref{fig:alignex1d} it will have its horizontal
\textattr{anchor} changed to \widget{font.anchor.right}. Similarly,
applying a vertical alignment will change the vertical
\textattr{anchor} to one of: \widget{font.anchor.top},
\widget{font.anchor.vcentre} or \widget{font.anchor.bottom}.

\begin{information}
Note that there is no way of aligning \glspl{textarea} along their
baseline. (However it is possible that the baseline may coincide
with the bottom of the \gls*{textarea} if the \gls*{textarea} doesn't contain
any characters with descenders.)
\end{information}

\strong{Tip:} Sometimes you might want to \manmsg{centre} an
\gls{object} relative to another thinner object. In this case it's
better to create a \hyperref[sec:rectangles]{rectangle}
\manmsg{centred} on the thin object that encompasses all the objects
you want to justify.  Include this rectangle in the \gls{group},
justify, ungroup and then delete the rectangle. For example, the
image shown in \figureref{fig:alignex2a} has a \gls{textarea} below
the middle line. It would look better if the text was
\manmsg{centred} below the line, so I grouped the middle line and
\gls{textarea} and justified them using
\menu{transform.justify.centre}. The result is shown in
\figureref{fig:alignex2b}. Although the \gls{textarea} and line are
now \manmsg{centred} relative to each other, the line was moved to
the \manmsg{centre} of the \gls{textarea}, not the other way round.
This was not what was intended. Instead, in
\figureref{fig:alignex2c}, I created a new rectangle that is
\manmsg{centred} on the line. Since the line is on a tick mark and
the grid lock is on, it is relatively easy to create this rectangle
(much easier than trying to move the \gls{textarea} to manually
align it). I then grouped the rectangle, the middle line and the
text area and justified them using \menu{transform.justify.centre}.
The result is shown in \figureref{fig:alignex2d}. The justified
objects were then ungrouped and the rectangle was deleted to
produced \figureref{fig:alignex2e}.

\FloatSubFigs{fig:alignex2}
{
  {fig:alignex2a}{\includeimg{alignex2a}}{},
  {fig:alignex2b}{\includeimg{alignex2b}}{},
  {fig:alignex2c}{\includeimg{alignex2c}}{},
  {fig:alignex2d}{\includeimg{alignex2d}}{},
  {fig:alignex2e}{\includeimg{alignex2e}}{}
}
[Aligning a Wider Object Relative to a Thinner Object]
{Aligning a wider object relative to a thinner object:
\subfigref{fig:alignex2a} original image;
\subfigref{fig:alignex2b} middle line and text area have
been grouped and justified;
\subfigref{fig:alignex2c} rectangle added to original
image \manmsg{centred} on the middle line;
\subfigref{fig:alignex2d} rectangle, middle line
and text area have been grouped and justified;
\subfigref{fig:alignex2e} justified
objects have been ungrouped and the rectangle has been deleted.}

\seealsorefs{
  sec:grouping,
  sec:texconfig,
  sec:neuronexample
}

\section{Cut}\label{sec:cutobjects}

\menudef{menu.edit.cut}

To cut a \selection\ of \glspl{object} to the
clipboard, use \menu{edit.cut} menu item. Note that it will be stored
on the clipboard as a \code{JDRGroup} Java object, not as text or
\gls{rastergraphics}, so you won't be able to paste it into a different
application.  If you want to cut a piece of text
from a \gls{textarea}, you will need to use the
\hyperref[sec:edittext]{edit text area} function.
Note that the \hyperref[sec:preamble]{preamble panes} have
their own cut button.

\section{Copy}\label{sec:copyobjects}

\menudef{menu.edit.copy}

To copy a \selection\ of \glspl{object} to the
clipboard, use \menu{edit.copy}. Note that it will be stored
on the clipboard as a \code{JDRGroup} Java object, not as text or
\gls{rastergraphics}, so you won't be able to paste it into a different
application.  If you want to copy a piece of text from a
\gls{textarea}, you will need to use the
\hyperref[sec:edittext]{edit text area} function.
Note that the \hyperref[sec:preamble]{preamble panes} have
their own copy button.

\section{Paste}\label{sec:pasteobjects}

\menudef{menu.edit.paste}

To paste a \selection\ of \glspl{object} from the clipboard, use
\menu{edit.paste}. If you want to copy text from another
application, and paste it into a \gls{textarea} in \FlowframTk, you
will have to \hyperref[sec:newtext]{create a new text area}, and
use the \gls{index.menu.textarea} to paste the text into the
\gls*{textarea}.  If you want to paste plain text into an existing
\gls*{textarea}, you will need to use the
\hyperref[sec:edittext]{edit text area} function.  Note that the
\hyperref[sec:preamble]{preamble panes} have their own paste button.

\section{Object Description}\label{sec:objectdescription}

\menudef{menu.edit.object_description}

You can assign a description to a \selected\ \gls*{object} using the
\menu{edit.object_description} menu item. This will display the
dialog box shown in \figureref{fig:objectDescription}. Type the
description into the text field, and click on \btn{okay} or press
\keys{\keyref{return}}.  Note that the \gls{menu.edit.object_description}
menu item is only available if exactly one object is \selected.

\FloatFig
  {fig:objectDescription}
  {\includeimg{objectDescription}}
  {Setting an Object's Description}

The description will not appear in the image, but it can be used to
locate and select \glspl*{object} on the canvas using the
\menu{navigate.by_description} or
\menu{navigate.add_description} menu items. The description
may also be used as a comment or in the object markup commands when
\hyperref[sec:exportimage]{exporting images}, depending on the
export options.

\begin{important}
If you assign a description to a \gls{group},
you will lose the description if you later ungroup it.
\end{important}

\section{Object Tag}\label{sec:objecttag}

\menudef{menu.edit.object_tag}

You can assign a tag to \selected\ \glspl*{object} using the
\menu{edit.object_tag} menu item.  This will display the
\dialog{tag} dialog box. Type the tag into the text field and click
on \btn{okay} or press \keys{\keyref{return}}. The tag will
automatically be trimmed.

\begin{important}
Tag are restricted to alphanumerics, spaces, and the following
punctuation characters: \code{+} (plus), \code{-} (hyphen), 
\code{|} (pipe), and \code{.} (period).
\end{important}

For example, \figureref{fig:objectTag} shows the house
image from \sectionref{sec:houseexample} where the four squares
representing windows have been selected and assigned the tag
\qt{window}.

\FloatFig
 {fig:objectTag}
 {\includeimg{house-tag}}
 {Setting the Tag for Selected Objects}

\begin{information}
If you have selected more than one \gls{object} with different tags,
the tags will be combined in the text field. You may then edit the
field as required.
\end{information}

The tag will not appear in the image but may be included in
object markup when \hyperref[sec:exportimage]{exporting images},
depending on the export options. You can also use tags to filter the
list of objects when using \menu{navigate.by_description}
or \menu{menu.navigate.by_description}.

\begin{important}
If you assign a tag to a \gls{group},
you will lose the information if you later ungroup it.
\end{important}

\chapter{Paint (\Glsentrytext{manual.colour} and Shading)}
\label{sec:paintcolourandshading}

\Inlineglsdef{index.paint} is the \inlineglsdef{index.colour} or
\inlineglsdef{index.gradient-paint} (shading) used for
\dglspl{text-colour}, \dglspl{line-colour} and \dglspl{fill-colour}. When selecting a
\dgls{paint} for a particular attribute, you may have a choice of:
\glsname{transparent}, a \dgls{paint.solid-colour} or a \dgls{gradient-paint}.
(Some attributes, such as marker \gls{index.marker.colour},
only support a \gls{index.paint.solid-colour}.)

\section{Paint Selector}\label{sec:paint}

\widget{paintselector.title}

The \widget{paintselector.title} panel is used in various \gls{index.paint}
selection dialog boxes.
In most cases, the \widget{paintselector.single} option is the default
(such as the \pathattr{line-paint}).  However, the
\pathattr{fill-paint} defaults to \widget{paintselector.transparent}.
Where only a \gls{index.paint.solid-colour} is supported, the radio
buttons will be omitted and only the \widget{paintselector.single} panel
will be available.

\begin{warning}
The \dglspl{colour} you see on the screen may not exactly match
\dglspl{colour} produced by your printer due to the non-invertible
mapping between \dgls{colour} spaces.
\end{warning}

\widget{paintselector.transparent}

Selecting the \widget{paintselector.transparent} radio button indicates
\inlineglsdef{transparent}. For example, if a \pathattr{line-paint} is set to
\widget{paintselector.transparent} then this indicates that the \gls{shape}
outline should not be \glslink{drawing-on-canvas}{drawn} or if a
\pathattr{fill-paint} is set to \widget{paintselector.transparent} then
this indicates that the \gls{shape} should not be filled.

If you require \gls{translucency} (where there is some \dgls{paint}
but \glspl{object} behind show \manmsg{through}) then select one of
the other \dgls{paint} options and adjust the alpha channel.

\widget{paintselector.single}

\FloatFig{fig:paint-solid}
{\includeimg{paint-solid}}
{Solid \Manmsg{colour} Selector}

Selecting the \widget{paintselector.single} radio button indicates a
\inlineglsdef{index.colour.solid} \dgls{colour} and enables the
\widget{paintselector.single} panel (see \figureref{fig:paint-solid}). 

A \dgls{paint.solid-colour} may be expressed as
\inlineglsdef{index.colour.rgb} (red, green, blue),
\inlineglsdef{index.colour.cmyk} (cyan, magenta, yellow, black),
\inlineglsdef{index.colour.hsb} (hue, saturation, brightness) or
\inlineglsdef{index.colour.greyscale}. In each case,
\inlineglsdef{index.colour.transparency} may be added by adjusting
the alpha channel.  If the alpha value is 100\% then the
\dgls{colour} is opaque.  Smaller values increase
\gls{translucency}, allowing \glspl{object} behind to show
\manmsg{through}.

The parameters are specified as integer values between 0 and 100,
or between 0 and 359 in the case of hue.
You can type in the number in the appropriate box, or use
the slider bars. Alternatively, you can click on one of the predefined swatches
which are to the right of the \widget{paintselector.single} panel 
and can be used to quickly set a \manmsg{colour}. Click on the 
appropriate swatch and the \manmsg{colour} specification will be
filled in.

\widget{paintselector.gradient}

\FloatFig{fig:paint-linear-gradient}
{\includeimg{paint-linear-gradient}}
{Gradient Paint Selector (Linear Selected)}

Selecting the \widget{paintselector.gradient} radio button indicates a 
\inlineglsdef{index.gradient-paint} and enables the
\widget{paintselector.gradient} panel (see
\figureref{fig:paint-linear-gradient}). 

A \gls{index.gradient-paint} is a shading that smoothly transitions
from a \inlineglsdef{index.gradient-paint.start-colour} to an
\inlineglsdef{index.gradient-paint.end-colour}.  There is a choice
of \gls{index.gradient-paint.linear} or
\gls{index.gradient-paint.radial}. Both are a shading that
transitions from one \dgls{colour} (the
\inlineglsdef{index.gradient-paint.start-colour}) to another (the
\inlineglsdef{index.gradient-paint.end-colour}).  The
\inlineglsdef{paintselector.start} and \inlineglsdef{paintselector.end} selectors
each have the same interface as the \widget{paintselector.single} panel.

\FloatSubFigs{fig:shadingex}
{
 {fig:linearshading}{\includeimg{linear-shading}}{Linear},
 {fig:radialshading}{\includeimg{radial-shading}}{Radial}
}
{Gradient Shading}

\widget{paintselector.linear}

A \inlineglsdef{index.gradient-paint.linear} shading transitions in
a band from the \gls{index.gradient-paint.start-colour} to the
\gls{index.gradient-paint.end-colour} in the given direction. There
are eight directions which are enabled when the
\widget{paintselector.linear} radio button is selected: North, North-East,
East, South-East, South, South-West, West, and North-West.  The
direction buttons can either be clicked on or selected with the
keystrokes \keys{\keyref{alt}+\actualkey{1}} \ldots\
\keys{\keyref{alt}+\actualkey{8}}.

For example, \figureref{fig:linearshading} has a solid black
\pathattr{line-paint} but the \pathattr{fill-paint} is a linear
gradient paint from yellow to magenta. The direction is set to North
so the bottom of the shape is yellow and the shading transitions to
magenta at the top of the shape.

\widget{paintselector.radial}

A \inlineglsdef{index.gradient-paint.radial} shading radiates
outwards from a starting location. There are nine locations which
become enabled with the \widget{paintselector.radial} radio button is
selected. These are arranged in a three by three grid referencing
regions of a \gls*{shape}['s] \gls{bbox}.
The location buttons can either be clicked on or
selected with the keystrokes \keys{\keyref{alt}+\actualkey{1}} \ldots\
\keys{\keyref{alt}+\actualkey{9}} (starting from the bottom left).

For example, \figureref{fig:radialshading} has a solid black
\pathattr{line-paint} but the \pathattr{fill-paint} is a radial
gradient paint from yellow to magenta. The location is set to the
middle bottom location. So the middle bottom area of the \gls{shape}
is yellow but the transition to magenta radiates outwards from there
in all directions (clipped by the shape).

\seealsorefs{
 sec:linepaint,
 sec:fillpaint,
 sec:textpaint,
 sec:convertcolspace,
 sec:fade,
 sec:removetrans
}

\section{\Glsentrytext{manual.colour} Space Conversions}\label{sec:convertcolspace}

\menudef{menu.edit.adjustcol}

\FlowframTk\ supports the
\inlineglsdef{index.colour.rgb} (red, green, blue),
\inlineglsdef{index.colour.cmyk} (cyan, magenta, yellow, black),
\inlineglsdef{index.colour.hsb} (hue, saturation, brightness) and
\gls{index.colour.greyscale} \manmsg{colour} spaces.

\Glspl{index.line-colour}, \glspl{index.fill-colour} and
\glspl{index.text-colour} can be converted to a different
\manmsg{colour} space.

\menudef{menu.edit.adjustcol.togrey}

\Glspl{index.line-colour}, \glspl{index.fill-colour} and
\glspl{index.text-colour} can be reduced to
\inlineglsdef{index.colour.greyscale} using
\menu{edit.adjustcol.togrey}.  Only selected \glspl{path} and
\glspl{textarea} will be affected. If you want to reduce a
\gls{bitmap} to \gls{index.colour.greyscale} you will need to use a
bitmap editor.

\menudef{menu.edit.adjustcol.rgb}

The \menu{edit.adjustcol.rgb} menu item will convert to
\gls{index.colour.rgb}.

\menudef{menu.edit.adjustcol.cmyk}

The \menu{edit.adjustcol.cmyk} menu item will convert to
\gls{index.colour.cmyk}.

\menudef{menu.edit.adjustcol.hsb}

The \menu{edit.adjustcol.hsb} menu item will convert to
\gls{index.colour.hsb}.

\begin{warning}
Note that \manmsg{colour} space conversions are not exact. You may
not end up with the desired effect. Some \filefn{export} functions
may not support the chosen \manmsg{colour} space and may convert
during the export process.
\end{warning}

\seealsorefs{
 sec:fade,
 sec:removetrans,
 sec:linepaint,
 sec:fillpaint,
 sec:textpaint
}

\section{Fade}\label{sec:fade}

\menudef{menu.edit.adjustcol.fade}

\Glspl{index.line-colour}, \glspl{index.fill-colour} and
\glspl{index.text-colour} can be faded (\gls{translucency} increased)
using the \menu{edit.adjustcol.fade} menu item. Only selected
\glspl{path} and \glspl{textarea} will be affected. If you want to
fade a \gls{bitmap} you will need to use a bitmap editor that
provides that function.

\seealsorefs{
 sec:convertcolspace,
 sec:removetrans,
 sec:linepaint,
 sec:fillpaint,
 sec:textpaint
}

\section{Removing Translucency}\label{sec:removetrans}

\menudef{menu.edit.adjustcol.removetrans}

\Glspl{index.line-colour}, \glspl{index.fill-colour} and
\glspl{index.text-colour} can have the \gls{translucency} removed using
the \menu{edit.adjustcol.removetrans} menu item. Only selected
\glspl{shape} and \glspl{textarea} will be affected. This function
sets the paint to none (completely \gls{transparent}) if the alpha value
is less than 0.5 otherwise it sets the alpha value to 1 (opaque).
For example, \figureref{fig:removetransa} shows three shapes: a
filled rectangle with alpha set to 100\%, a blue filled circle with
alpha set to 60\% and a yellow filled circle with alpha set to 40\%.
In \figureref{fig:removetransb}, the circles have had their
translucency removed. The blue filled circle now has the alpha set
to 100\% but the other circle, which formerly had a yellow interior,
has had its \gls{index.fill-colour} removed.

\FloatSubFigs{fig:removetrans}
{
 {fig:removetransa}{\includeimg{removetransa}}{},
 {fig:removetransb}{\includeimg{removetransb}}{},
}
[Removing Translucency]
{Removing Translucency: \subfigref{fig:removetransa} original shapes;
  \subfigref{fig:removetransb} translucency removed.}

\begin{warning}
Note that PostScript doesn't support transparency so the
alpha channel will be ignored if you \filefn{export} to PostScript.
\end{warning}

\seealsorefs{
 sec:convertcolspace,
 sec:fade,
 sec:linepaint,
 sec:fillpaint,
 sec:textpaint
}

\chapter{Text}\label{sec:text}

\Glspl{textarea} consist of a single line of text. Alternative
\LaTeX\ code may be provided to use instead when the image
is \hyperref[sec:exportimage]{exported} to a \TeX-related format.
New \glspl{textarea} can be created with the
\texttool\ or \mathstool, as described in \sectionref{sec:newtext}.
An existing \gls{textarea} can be edited (\sectionref{sec:edittext}),
converted to a \gls{textpath} (\sectionref{sec:textpath}), or
converted to an \textattr{outline} (\sectionref{sec:textoutline}).

To change text style attributes (font and \textattr{anchor}) see
\sectionref{sec:textstyle}.

\section{Editing Text Areas}\label{sec:edittext}

\menudef{menu.edit.textarea.edit}

To insert or delete characters from a \gls{textarea} or \gls{textpath} first
\select\ the \gls*{textarea} or \gls*{textpath}, and then
select the \menu{edit.textarea.edit} menu item.  (Note
that you should not have any other \glspl{object} selected.) This
will display the \inlineglsdef{edittext.title} dialog box
(\figureref{fig:edittexta}) in which you can modify the text as
appropriate. If you are editing the text of a \gls{textpath}, there
will be an extra panel visible, shown in
\figureref{fig:edittextb}.

\begin{information}
You can not edit a \gls*{textarea} or \gls*{textpath} if
it belongs to a \gls{group}. Deleting all the characters within a
\gls*{textarea} or \gls*{textpath} isn't permitted and will result
in the error message \qt{\errmsg{empty_string}}.
\end{information}

\FloatSubFigs{fig:edittext}
{
  {fig:edittexta}{\includeimg{editText}}{},
  {fig:edittextb}{\includeimg{editTextPath}}{}
}
[Edit Text Dialog Box]
{Edit Text Dialog Box: \subfigref{fig:edittexta} regular text area;
\subfigref{fig:edittextb} text-path}

The \gls{index.menu.textarea} is available in the top text field.
It has the same items as for the text input field used when a \gls{textarea}
is under construction.

If you want to specify alternative text to appear in a \LaTeX\
document, click on the button marked \widget{edittext.different},
and enter the alternative in the bottom field (see
\figureref{fig:edittextb}). The \gls{index.menu.textarea} is not
available in this field, but you can still use
\accelerator{menu.textarea.select_all},
\accelerator{menu.textarea.copy}, \accelerator{menu.textarea.cut}
and \accelerator{menu.textarea.paste} to select all the text, copy
to the clipboard, cut to the clipboard or paste from the clipboard,
respectively. Note that the \hyperref[sec:exportpgf]{exported} text
may occupy a larger or smaller area in the \LaTeX\ document than it
does in \FlowframTk, so you may also need to change the
\textattr{anchor} or set the image \glspl{image.typeblock}
(see \sectionref{sec:exportdoc}).

You can use the \widget{edittext.remap} button to generate
the alternative text in the bottom field by applying
\glspl{textarea-mapping} to the text in the top field (see
\sectionref{sec:texconfigtext}). If
the original alternative text starts and ends with a \gls{mshift}
symbol, the \mathsmode\ mappings will be used, otherwise the
\textmode\ mappings will be used. If the original alternative text is
empty, you can just type a \glssymbol{mshift} symbol in it and click on the
\widget{edittext.remap} button to generate a \mathsmode\
mapping. The original alternative text will be completely replaced by the text
from the top field with the appropriate mappings applied. You can
then edit this if necessary.

\widgetdef{edittext.textpath}

The \LaTeX-related \filefn{export} functions use the \sty{pgf} text
decoration to implement \glspl*{textpath}. This allows you to insert
declarations, such as \csfmt{large}, part way through the text by
placing them between \glspl{pgf.delimiter}. By default these delimiters are the
vertical bar (pipe) character \glssymbol{pipe} but this can be changed in
the \widget{edittext.textpath.left_delim} and
\widget{edittext.textpath.right_delim} fields (see
\figureref{fig:edittextb}). Note that the vertical \textattr{anchor}
setting is ignored by the \LaTeX\ export functions. It's best to avoid
\manmsg{maths} in \glspl{textpath}. See the \sty{pgf} manual for
further details about text decorations.

\begin{important}
The alternative text may not be used by \filefn{export} functions if
the \gls*{textpath} has been made an \textattr{outline} or if the
\gls*{textarea}\slash\gls*{textpath} has a gradient paint.
The export \manmsg{behaviour} under those circumstances is dependent on
the \hyperref[sec:texconfigtext]{\LaTeX\ text settings}.
The alternative text is not used when exporting to PNG or when
\gls{printing}.
\end{important}

\seealsorefs{
 sec:texconfig,
 sec:newtext,
 sec:textpath,
 sec:textoutline,
 sec:textpaint,
 sec:textstyle,
 sec:splittext,
 sec:outlinetopath,
 sec:neuronexample
}

\section{Text Transformation Matrix}\label{sec:textmatrix}

You can scale, rotate or shear text
using the \gls{affine-transformation} functions described in 
\sectionref{sec:affinetrans} or by directly editing the
\inlineglsdef{index.text-attribute.transformation-matrix}.

\menudef{menu.edit.textarea.matrix}

The \menu{edit.textarea.matrix} menu item will open the \dialog{settransform}
dialog.
Note that if you want to reset a \textattr{transformation-matrix}, 
it's quicker to use \menu{transform.reset}.

\widgetdef{settransform.title}

The \dialog{settransform} dialog has six editable fields in which
you can edit the scaling, shearing and translation elements of the
\textattr{transformation-matrix}.

The \textattr{transformation-matrix} for a \gls*{textarea} is
applied relative to the top left corner of the \gls{canvas}. The
transformation matrix for a \gls{textpath} is applied relative to
the point along the underlying path where each character should be
positioned.

Once a \gls*{textarea} has been combined with a \gls{path} to form a
\gls{textpath}, the text can only be transformed by editing the
transformation matrix.  For example, \figureref{fig:textmatrix}
shows a \gls*{textpath} in edit mode (so that you can see the
underlying path) with different values of the transformation matrix.
In \figureref{fig:textmatrixa}, the transformation matrix is
set to the identity matrix, shown in
\figureref{fig:textmatrixb}.  In
\figureref{fig:textmatrixc}, the transformation matrix is set
as shown in \figureref{fig:textmatrixd}, (the vertical
translation has been set to 10, which is in terms of the
\gls{storageunit}). The text is no longer flush against
the path. In \figureref{fig:textmatrixe}, the transformation
matrix has been set as shown in \figureref{fig:textmatrixf},
(the horizontal shear element has been set to $-1$).

\FloatSubFigs{fig:textmatrix}
{
  {fig:textmatrixa}{\includeimg{textmatrixa}}{},
  {fig:textmatrixb}{\includeimg{textmatrixb}}{},
  {fig:textmatrixc}{\includeimg{textmatrixc}}{},
  {fig:textmatrixd}{\includeimg{textmatrixd}}{},
  {fig:textmatrixe}{\includeimg{textmatrixe}}{},
  {fig:textmatrixf}{\includeimg{textmatrixf}}{}
}
[Text-Path Transformation Matrix]
{Text-path transformation matrix:
\subfigref{fig:textmatrixa} the text-path with transformation matrix shown in
\subfigref{fig:textmatrixb};
\subfigref{fig:textmatrixc} the text-path with transformation matrix shown
in \subfigref{fig:textmatrixd};
\subfigref{fig:textmatrixe} the text-path with transformation matrix
shown in \subfigref{fig:textmatrixf}.}

\section{Combining a Text Area and Path to Form a Text-Path}\label{sec:textpath}

\menudef{menu.transform.textpath}

A \gls{textarea} and a \gls{path} can be combined to form a
\gls{textpath}. Ensure that only a single \gls{textarea} and a
single \gls{path} are selected and use the \menu{transform.textpath}
menu item. The text from the original \gls{textarea} will then follow
the shape of the original path (which will now be the underlying
path).

The underlying path will not be visible (except in \editpathmode).
If the original \gls*{textarea} was in \textattr{outline} mode, the new
\gls*{textpath} will also be in \textattr{outline} mode, possibly with a 
\textattr{fill-paint}, depending on the original \gls*{textarea} and \gls*{path}
fill paint. (If the original \gls*{textarea} didn't have a
\textattr{fill-paint}, the \gls*{path} \pathattr{fill-paint} will be applied.)

The horizontal \textattr{anchor} determines
whether the text should start at the first \gls{controlpt} of the
underlying path or if it should be \manmsg{centred} along the path or if
it should be right aligned at the end \gls*{controlpt}. The vertical
\textattr{anchor} determines whether the base, bottom, top or middle of the
text should be aligned on the path. 

\begin{important}
The vertical \textattr{anchor} isn't implemented by the
\filefn{export} \TeX-related filters. Note that if the text is
longer than the path, the text will be truncated.
\end{important}

For example, the \gls{textarea} and \gls{path} in
\figureref{fig:textpatha} are combined to form a \gls*{textpath}.
The original \gls*{textarea}['s] horizontal \textattr{anchor} was
set to left, so the text along the path starts at the first
\gls{controlpt} in \figureref{fig:textpathb}. In
\figureref{fig:textpathc} the horizontal \textattr{anchor} has been
changed to \manmsg{centre}, and in \figureref{fig:textpathc} the
horizontal \textattr{anchor} has been changed to right.

\FloatSubFigs{fig:textpath}
{
 {fig:textpatha}{\includeimg{textandpath}}{},
 {fig:textpathb}{\includeimg{textpathleft}}{},
 {fig:textpathc}{\includeimg{textpathcentre}}{},
 {fig:textpathd}{\includeimg{textpathright}}{}
}
[Combining a Text Area and Path to Form a Text-Path]
{Combining a \gls{textarea} and \gls{path} to form a \gls{textpath}:
\subfigref{fig:textpatha} the original \gls{textarea} and \gls{path};
\subfigref{fig:textpathb} the resulting \gls{textpath} with left horizontal 
\textattr{anchor}; 
\subfigref{fig:textpathc} \manmsg{centred} \textattr{anchor}; 
\subfigref{fig:textpathd} right \textattr{anchor}. 
(The \glspl{textpath} are in edit mode to show the underlying path.)}

Once a \gls{path} has been combined with a \gls{textarea}, the line
style \glspl{index.path-attribute} are lost as the path is only used
as a guide to position the text. The \gls{cag} functions, such as
\transformfn{union}, are applied to the underlying path and the text
is adjusted to follow the new path.  Transformations using the
\transformfn{rotate}, \transformfn{scale} and \transformfn{shear}
functions are applied to the underlying path not the text. You can
either transform the text using the transformation functions before
combining it with a path or transform it after combining by changing
the text \textattr{transformation-matrix}.

Note there is a difference between applying \gls{symmetry} to a
\gls{textpath} and converting a \gls*{textarea} and
\gls{symmetricshape} to a \gls*{textpath}. For example, consider the
\gls{textarea} and \gls{path} in \figureref{fig:textpathsyma}. If
you first combine them to form a \gls*{textpath}
(\figureref{fig:textpathsymb}) and then add symmetry
(\figureref{fig:textpathsymc}), the result is a \gls*{textpath}
where the text is reflected across the \gls{line-of-symmetry}.
Conversely, applying \gls{symmetry} to the path first
(\figureref{fig:textpathsymd}) and then combining with the
\gls*{textarea} yields a \gls*{textarea} where only the underlying
path has \gls{symmetry} (\figureref{fig:textpathsyme}).

A similar effect applies with other types of \glspl{compositeshape}.

\FloatSubFigs*{fig:textpathsym}
{%
 {fig:textpathsyma}{\includeimg{textpath-syma}}{},
 {fig:textpathsymb}{\includeimg{textpath-symb}}{},
 {fig:textpathsymc}{\includeimg{textpath-symc}}{},
 {fig:textpathsymd}{\includeimg{textpath-symd}}{},
 {fig:textpathsyme}{\includeimg{textpath-syme}}{}
}
[Symmetric Text-Paths]
{Symmetric \glspl{textpath}:
\subfigref{fig:textpathsyma} original \gls{textarea} and \gls{path};
\subfigref{fig:textpathsymb} \gls{textarea} and \gls{path} in 
\subfigref{fig:textpathsyma} have been combined to
form a \gls{textpath};
\subfigref{fig:textpathsymc} the \gls{textpath} in \subfigref{fig:textpathsymb} 
has had \gls{symmetry} applied to it in \editpathmode; 
\subfigref{fig:textpathsymd} the \gls{path} in
\subfigref{fig:textpathsyma} has had \gls{symmetry} applied to it;
\subfigref{fig:textpathsyme} the \gls{textarea} and symmetric path in 
\subfigref{fig:textpathsymd} have been combined to form a
\gls{textpath}.}

\begin{warning}
Restrictions apply to \glspl*{textpath} with the
\filefn{export} \TeX-related filters as some \gls*{textpath}
effects aren't emulated in \LaTeX, such as the vertical \textattr{anchor},
\gls{index.gradient-paint} and \textattrpl{outline}. You can determine 
the \manmsg{behaviour} on export via the \dialog{texconfig} dialog.
\end{warning}

\seealsorefs{
 sec:edittext,
 sec:separate,
 sec:patterns
}

\section{Text Outlines}\label{sec:textoutline}

\menudef{menu.edit.textarea.outline}

A \gls{textarea} or \gls{textpath} can be rendered as an
\inlineglsdef{index.text-attribute.outline} by
selecting it and then using the \menu{edit.textarea.outline}
menu item. For example, \figureref{fig:textoutlinea} shows a
standard \gls*{textarea} and \figureref{fig:textoutlineb} shows
that \gls*{textarea} rendered as an outline. If the outline mode is
set, you can apply a \gls{index.fill-colour} using
\menu{edit.fill_colour}.

\begin{warning}
Note that although \glspl*{textpath} can be rendered with an outline in \FlowframTk,
the \LaTeX\ \filefn{export} functions can't emulate
this and will either export the \gls*{textpath} without the outline
setting or will export it as a path (in which case the alternative
text will be ignored) depending on your
\hyperref[sec:texconfig]{\TeX\ Configuration Setting}.
\end{warning}

\FloatSubFigs{fig:textoutline}
{
 {fig:textoutlinea}{\includeimg{outlinea}}{},
 {fig:textoutlineb}{\includeimg{outlineb}}{},
}
[Text Outline]
{Text Outline: \subfigref{fig:textoutlinea} original text area;
  \subfigref{fig:textoutlineb} outline.}

When exporting to a document class, package or a complete document,
the custom command \gls{jdroutline} will automatically be defined.
This is used to create the outlined effect. If you 
\hyperref[sec:exportpgf]{export} to a file containing \sty{pgf}
code to be input by another document, you will need to inspect the 
created \ext{tex} file for further information.

\seealsorefs{sec:outlinetopath}

\section{Splitting Text Areas}\label{sec:splittext}

\menudef{menu.transform.split}

A \gls{textarea} or \gls{textpath} can be split into a \gls{group}
containing \glspl{textarea} each consisting of a single character.
The original alternative \LaTeX\ text will be lost. (No mappings
will be used.) First \select\ the required \glspl{textarea} or
\glspl{textpath} (no other type of \gls{object} should be selected)
and then use the \menu{transform.split} menu item.

For example, in \figureref{fig:splitex1a} there is a single 
\gls{textarea} containing the seven characters that make up the word
\qt{Rainbow}.  This text area was then converted into a group of
seven \glspl*{textarea} using \menu{transform.split}. The group was
then \hyperref[sec:grouping]{ungrouped} (see \figureref{fig:splitex1b}) 
and each \gls{textarea} was then given a different
\gls{index.text-colour} resulting in the image
shown in \figureref{fig:splitex1c}.

\FloatSubFigs*{fig:splitex1}
{
  {fig:splitex1a}{\includeimg{splitex1a}}{},
  {fig:splitex1b}{\includeimg{splitex1b}}{},
  {fig:splitex1c}{\includeimg{splitex1c}}{}
} 
[Splitting a Text Area]
{Splitting a text area:
\subfigref{fig:splitex1a} original text area;
\subfigref{fig:splitex1b} split and ungroup;
\subfigref{fig:splitex1c} apply separate \textattr{paint} 
to each of the new text areas.}

Note that if you split a \gls*{textpath}, you will lose the
underlying path as the result will be a group of \glspl{textarea}.
For example, the \gls*{textpath} shown in
\figureref{fig:splittextpatha} was split to create a group
containing seven \glspl*{textarea}.

\FloatSubFigs*{fig:splittextpath}
{
  {fig:splittextpatha}{\includeimg{splittextpatha}}{},
  {fig:splittextpathb}{\includeimg{splittextpathb}}{},
  {fig:splittextpathc}{\includeimg{splittextpathc}}{}
}
[Splitting a Text Path]
{Splitting a text path:
\subfigref{fig:splittextpatha} original text path;
\subfigref{fig:splittextpathb} split and ungroup;
\subfigref{fig:splittextpathc} apply
separate \textattr{paint} to each of the new text areas.}

\seealsorefs{sec:outlinetopath}

\chapter{Affine Transformations}\label{sec:affinetrans}

\FlowframTk\ provides functions to perform 
\inlineglsdef{affine-transformation} on \glspl{object}:
\affinetrans{translation} (\sectionref{sec:moveobjects}), 
\affinetrans{rotation} (\sectionref{sec:rotateobjects}), 
\affinetrans{scaling} (\sectionref{sec:scaleobjects}) and 
\affinetrans{shearing} (\sectionref{sec:shearobjects}).

\Glspl{shape} may also be modified using other functions
that are not available for certain other types of \gls{object}. Those
functions are described in \sectionref{sec:modshape}.

\section{Moving an Object}\label{sec:moveobjects}

To move an \gls{object} or \glspl*{object}
(\inlineglsdef{affine-transformation.translation}), first \select\ the
\glspl*{object} you want to move and then depress the
\glslink{primaryclick}{primary mouse button} somewhere inside the
selection, and drag the mouse.  Release the mouse button when the
\glspl*{object} have reached their required location.

\begin{important}
If the \gridlock\ is on, the \selected\
\gls{object} (or \glspl{object}) will move
in increments of the minor tick distance.
\end{important}

If you only want to move the object by a very small amount, and your
mouse is very sensitive or you have difficulties with fine motor
co-ordination, depress the mouse button and instead of dragging use
the arrow keys to move the pointer. (This will require the
\gls{robot} to be available.)

\menudef{menu.edit.moveby}

An alternative if you need to move a small amount or if you need to
move by an exact amount is to use the \menu{edit.moveby} menu item.
This will open the \dialog{moveby} dialog box (\figureref{fig:moveby}).
In the field marked \widget{coordinates.x} enter the horizontal
displacement, and in the field marked \widget{coordinates.y}
enter the vertical (\strong{downward}) displacement. For example, to move the
selected \glspl*{object} 10 units to the right and 20 units down,
type 10 in the \widget{coordinates.x} field and 20 in the
\widget{coordinates.y} field. To move left or up, use a negative
value.

\begin{information}
The \menu{edit.moveby} function is unaffected by the \gridlock.
\end{information}

\FloatFig
  {fig:moveby}
  {\includeimg{moveby}}
  {Move Selected Objects Dialog Box}


\section{Rotating Objects}\label{sec:rotateobjects}

\menudef{menu.transform.rotate}

Selected \glspl{object} can be rotated with the
\menu{transform.rotate} menu item. This will display the
\dialog{rotate} dialog box.

\widgetdef{rotate.title}

In the \dialog{rotate} dialog,
you can specify the angle of
\inlineglsdef{affine-transformation.rotation}.

Notes:
\begin{itemize}
\item Individual \glspl{object}
will be rotated relative to the \manmsg{centre} of the \gls{object}.

\item \Glspl*{object} within a
\gls{group} will be rotated relative to the \manmsg{centre} of the
group.

\item Rotating a \gls{textpath} will rotate the path and the text
will adjust to follow the transformed path.

\item Rotating a \gls*{textarea} and \gls*{path} and then combining
them to form a \gls*{textpath} is not the same as first combining
and then rotating.

\end{itemize}

To illustrate this, in \figureref{fig:rotateex1a} there are three
\glspl*{object} selected.  The selection is then rotated
\degrees{90}.  The result is shown in \figureref{fig:rotateex1b}.

\FloatSubFigs{fig:rotateex1}
{
 {fig:rotateex1a}{\includeimg{rotateex1a}}{},
 {fig:rotateex1b}{\includeimg{rotateex1b}}{}
}
[Three Selected Objects Rotated by 90 Degrees]
{Three selected objects rotated by 90 degrees: 
\subfigref{fig:rotateex1a} before;
\subfigref{fig:rotateex1b} after.}

In \figureref{fig:rotateex2}, the three objects in
\figureref{fig:rotateex1} were first \hyperref[sec:grouping]{grouped}
(\figureref{fig:rotateex2a}) and then rotated \degrees{90}
(\figureref{fig:rotateex2b}).

\FloatSubFigs{fig:rotateex2}
{
 {fig:rotateex2a}{\includeimg{rotateex2a}}{},
 {fig:rotateex2b}{\includeimg{rotateex2b}}{}
}
[A Group Consisting of Three Objects Rotated by 90 Degrees]
{A group consisting of three objects rotated by 90 degrees:
\subfigref{fig:rotateex2a} before; \subfigref{fig:rotateex2b} after.}

In \figureref{fig:rotatetextpath}, the \gls*{path} and
\gls*{textarea} in \figureref{fig:rotatetextpatha} are
combined into a \gls*{textpath}, shown in
\figureref{fig:rotatetextpathb}. This \gls*{textpath} is then
rotated by \degrees{90} resulting in
\figureref{fig:rotatetextpathc}. Note that this is different
from first rotating the original \gls*{path} and \gls*{textarea},
shown in \figureref{fig:rotatetextpathd}, and then combining
them to form a \gls*{textpath}, shown in
\figureref{fig:rotatetextpathe}.

\FloatSubFigs*{fig:rotatetextpath}
{
 {fig:rotatetextpatha}{\includeimg{rotatetextpatha}}{},
 {fig:rotatetextpathb}{\includeimg{rotatetextpathb}}{},
 {fig:rotatetextpathc}{\includeimg{rotatetextpathc}}{},
 {fig:rotatetextpathd}{\includeimg{rotatetextpathd}}{},
 {fig:rotatetextpathe}{\includeimg{rotatetextpathe}}{}
}
[Rotating a Text-Path]
{Rotating a text-path: 
\subfigref{fig:rotatetextpatha} original text area and path; 
\subfigref{fig:rotatetextpathb} text area and path in
\subfigref{fig:rotatetextpatha} combined to form a text-path;
\subfigref{fig:rotatetextpathc} text-path in
\subfigref{fig:rotatetextpathb} rotated by 45 degrees;
\subfigref{fig:rotatetextpathd} text area and path in
\subfigref{fig:rotatetextpatha} rotated by 45 degrees;
\subfigref{fig:rotatetextpathe} rotated text area and
path in \subfigref{fig:rotatetextpathd} combined to form a text-path.}

If you prefer to rotate an \gls{object} using the mouse (which is
less precise), you first need to \hyperref[mi:hotspots]{enable the hotspots}.
Then drag the bottom left hotspot to rotate. Note that even if you
have more than one object selected, only the object whose hotspot you
are dragging will be transformed.

\seealsorefs{
 sec:grouping,
 sec:moveobjects,
 sec:scaleobjects,
 sec:shearobjects,
 sec:textpath
}


\section{Scaling Objects}\label{sec:scaleobjects}

\menudef{menu.transform.scale}

Selected \glspl{object} can be scaled with the
\menu{transform.scale} menu item. This will open up the
\dialog{scale} dialog box.

\widgetdef{scale.title}

In the \dialog{scale} dialog, you can specify the
\inlineglsdef{affine-transformation.scaling} factor.

\widgetdef{scale.both}

Select the \widget{scale.both} radio button to scale both the
$x$ and $y$ dimension by the same amount.

\widgetdef{scale.x}

Select the \widget{scale.x} radio button to scale just the
$x$ dimension.

\widgetdef{scale.y}

Select the \widget{scale.y} radio button to scale just the
$y$ dimension.

Notes:
\begin{itemize}
\item \Inlineglsdef{affine-transformation.reflection} can be
achieved with a negative scale factor.

\item Individual \glspl*{object} will be
scaled relative to the top left corner of the
object's \gls{bbox}.

\item \Glspl*{object} within a
\gls{group} will be scaled relative to the top left corner
of the group's \gls*{bbox}.

\item Scaling a \gls{textpath} will scale the path and the text
will adjust to follow the transformed path. Note that the text
itself will not be scaled.

\item Scaling a \gls*{textarea} and \gls*{path} and then combining
them to form a \gls*{textpath} is not the same as first combining
and then scaling.
\end{itemize}

To illustrate this, in \figureref{fig:scaleex1a} there are three
\glspl*{object} selected.
The selection is then scaled by a factor of 2.
The result is shown in \figureref{fig:scaleex1b}.

\FloatSubFigs{fig:scaleex1}
{
 {fig:scaleex1a}{\includeimg{scaleex1a}}{},
 {fig:scaleex1b}{\includeimg{scaleex1b}}{},
}
[Three Selected Objects Scaled by a Factor of 2]
{Three selected objects scaled by a factor of 2:
\subfigref{fig:scaleex1a} before;
\subfigref{fig:scaleex1b} after.}

In \figureref{fig:scaleex2}, the three objects in
\figureref{fig:scaleex1} were first
\hyperref[sec:grouping]{grouped} (\figureref{fig:scaleex2a})
and then scaled by a factor of 2 (\figureref{fig:scaleex2b}).

\FloatSubFigs{fig:scaleex2}
{
 {fig:scaleex2a}{\includeimg{scaleex2a}}{},
 {fig:scaleex2b}{\includeimg{scaleex2b}}{}
}
[A Group Consisting of Three Objects Scaled by a Factor of 2]
{A group consisting of three objects scaled by a factor of 2:
\subfigref{fig:scaleex2a} before;
\subfigref{fig:scaleex2b} after.}

In \figureref{fig:scaletextpath}, the \gls*{path} and
\gls*{textarea} in \figureref{fig:scaletextpatha} are combined
into a \gls*{textpath}, shown in
\figureref{fig:scaletextpathb}. This \gls*{textpath} is then
scaled by a factor of 2 resulting in
\figureref{fig:scaletextpathc}. Note that this is different
from first scaling the original \gls*{path} and \gls*{textarea},
shown in \figureref{fig:scaletextpathd}, and then combining
them to form a \gls*{textpath}, shown in
\figureref{fig:scaletextpathe}.

\FloatSubFigs*{fig:scaletextpath}
{
 {fig:scaletextpatha}{\includeimg{scaletextpatha}}{},
 {fig:scaletextpathb}{\includeimg{scaletextpathb}}{},
 {fig:scaletextpathc}{\includeimg{scaletextpathc}}{},
 {fig:scaletextpathd}{\includeimg{scaletextpathd}}{},
 {fig:scaletextpathe}{\includeimg{scaletextpathe}}{}
}
[Scaling a Text-Path]
{Scaling a text-path:
\subfigref{fig:scaletextpatha} original text area and path;
\subfigref{fig:scaletextpathb} text area and path in
\subfigref{fig:scaletextpatha} combined to form a text-path;
\subfigref{fig:scaletextpathc} text-path 
in \subfigref{fig:scaletextpathb} scaled by a factor of 2;
\subfigref{fig:scaletextpathd} text area and path 
in \subfigref{fig:scaletextpatha} scaled by a factor of 2;
\subfigref{fig:scaletextpathe} scaled text area and path 
in \subfigref{fig:scaletextpathd} combined to form a text-path.}

If you prefer to scale an \gls{object} using the mouse (which is
less precise), you first need to \hyperref[mi:hotspots]{enable the
hotspots}. Then drag the bottom \manmsg{centre} hotspot to scale
vertically, the bottom right hotspot to scale in both directions or
the middle right hotspot to scale horizontally. Note that even if
you have more than one object selected, only the object whose
hotspot you are dragging will be transformed.


\seealsorefs{
 sec:grouping,
 sec:moveobjects,
 sec:rotateobjects,
 sec:shearobjects,
 sec:textpath
}


\section{Shearing Objects}\label{sec:shearobjects}

\menudef{menu.transform.shear}

Selected \glspl{object} can be sheared with
the \menu{transform.shear} menu item. This will open up the
\dialog{shear} dialog box.

\widgetdef{shear.title}

In the \dialog{shear} dialog, you can specify the
\inlineglsdef{affine-transformation.shearing} factors.

\widgetdef{shear.x}
Enter the $x$ shear factor ($s_x$) in the \widget{shear.x} field.

\widgetdef{shear.y}
Enter the $y$ shear factor ($s_y$) in the \widget{shear.y} field.

The shearing transformation is given by:
\TeXParserLibToImage
[div=displaymath,alt={
 (
   [ 1 , sX ]
   [ sY , 1 ]
 )
 (
   [ x ]
   [ y ]
 )
=
 (
   [ x + sX \texttimes\ y ]
   [ y + sY \texttimes\ x ]
 )
}]
{
\[
  \left(
  \begin{array}{cc}
  1 & s_x\\
  s_y & 1
  \end{array}
  \right)
  \left(
  \begin{array}{c}
  x\\
  y
  \end{array}
  \right)
  =
  \left(
  \begin{array}{l}
  x + s_x y\\
  y + s_y x
  \end{array}
  \right)
  \]
}

Notes:
\begin{itemize}
\item Individual \glspl*{object}
will be sheared relative to the bottom left corner of the
object's \gls{bbox}.

\item \Glspl*{object} within a 
\gls{group} will be sheared relative to the bottom
left corner of the group's \gls*{bbox}.

\item Shearing a \gls{textpath} will shear the path and the text
will adjust to follow the transformed path. Note that the text
itself will not be sheared.

\item Shearing a \gls*{textarea} and \gls*{path} and then combining
them to form a \gls*{textpath} is not the same as first combining
and then shearing. 

\item Shearing a \gls{pattern} will shear the underlying path not
the complete shape.
\end{itemize}

To illustrate this, in \figureref{fig:shearex1a} there are three
\glspl*{object} selected.  The selection is then sheared with shear
factors $s_x=1$ and $s_y=0$.  The result is shown in
\figureref{fig:shearex1b}.

\FloatSubFigs{fig:shearex1}
{
 {fig:shearex1a}{\includeimg{shearex1a}}{},
 {fig:shearex1b}{\includeimg{shearex1b}}{}
}
[Two Selected Objects Sheared Horizontally]
{Two selected objects sheared horizontally:
\subfigref{fig:shearex1a} before;
\subfigref{fig:shearex1b} after.}

In \figureref{fig:shearex2}, the three objects in
\figureref{fig:shearex1} were first \hyperref[sec:grouping]{grouped}
(\figureref{fig:shearex2a}) and then sheared with shear factors
$s_x=1$ and $s_y=0$ (\figureref{fig:shearex2}).

\FloatSubFigs{fig:shearex2}
{
 {fig:shearex2a}{\includeimg{shearex2a}}{},
 {fig:shearex2b}{\includeimg{shearex2b}}{}
}
[A Group Consisting of Two Objects Sheared Horizontally]
{A group consisting of two objects sheared horizontally:
\subfigref{fig:shearex2a} before;
\subfigref{fig:shearex2b} after.}

In \figureref{fig:sheartextpath}, the \gls*{path} and
\gls*{textarea} in \figureref{fig:sheartextpatha} are combined into
a \gls*{textpath}, shown in \figureref{fig:sheartextpathb}. This
\gls*{textpath} is then sheared with shear factors $s_x=1$ and
$s_y=0$ (\figureref{fig:sheartextpathc}). Note that this is
different from first shearing the original \gls*{path} and
\gls*{textarea}, shown in \figureref{fig:sheartextpathd}, and then
combining them to form a \gls*{textpath}, shown in
\figureref{fig:sheartextpathe}.

\FloatSubFigs*{fig:sheartextpath}
{
 {fig:sheartextpatha}{\includeimg{sheartextpatha}}{},
 {fig:sheartextpathb}{\includeimg{sheartextpathb}}{},
 {fig:sheartextpathc}{\includeimg{sheartextpathc}}{},
 {fig:sheartextpathd}{\includeimg{sheartextpathd}}{},
 {fig:sheartextpathe}{\includeimg{sheartextpathe}}{}
}
[Shearing a Text-Path]
{Shearing a text-path:
\subfigref{fig:sheartextpatha} original text area and path; 
\subfigref{fig:sheartextpathb} text area and path 
in \subfigref{fig:sheartextpatha} combined to form a text-path; 
\subfigref{fig:sheartextpathc} text-path 
in \subfigref{fig:sheartextpathb} sheared horizontally; 
\subfigref{fig:sheartextpathd} text area and path 
in \subfigref{fig:sheartextpatha} sheared horizontally; 
\subfigref{fig:sheartextpathe} sheared text area and path 
in \subfigref{fig:sheartextpathd} combined to form a text-path.}

In \figureref{fig:shearpatterna}, a \gls*{path} created using the
ellipse tool has been converted into a rotational pattern with two
replicas. This pattern is then sheared with shear factors $s_x=1$
and $s_y=0$, shown in \figureref{fig:shearpatternb}. This is
different from the effect obtained by applying the same shear
factors to a complete path rather than a pattern.
\figureref{fig:shearpatternc} is a full path version of
\figureref{fig:shearpatternd}. This path is then sheared using the
same factors and the result is shown in
\figureref{fig:shearpatternd}.

\FloatSubFigs{fig:shearpattern}
{
 {fig:shearpatterna}{\includeimg{shearpatternexa}}{},
 {fig:shearpatternb}{\includeimg{shearpatternexb}}{},
 {fig:shearpatternc}{\includeimg{shearpatternexa}}{},
 {fig:shearpatternd}{\includeimg{shearpatternexd}}{}
}
[Shearing a Pattern]
{Shearing a pattern: 
\subfigref{fig:shearpatterna} a pattern consisting of an
ellipse that has 2 rotational replicas; 
\subfigref{fig:shearpatternb} the pattern 
in \subfigref{fig:shearpatterna} has been sheared horizontally;
\subfigref{fig:shearpatternc} the pattern 
in \subfigref{fig:shearpatterna} has been converted to a full path; 
\subfigref{fig:shearpatternd} the path 
in \subfigref{fig:shearpatternc} has been sheared horizontally.}

If you prefer to shear an \gls{object} using the mouse,
you first need to \hyperref[mi:hotspots]{enable the hotspots}.
Then drag the top right hotspot to shear vertically
or the top left hotspot to shear horizontally. Note that even if you
have more than one object selected, only the object whose hotspot you
are dragging will be transformed.

\seealsorefs{
 sec:grouping,
 sec:moveobjects,
 sec:rotateobjects,
 sec:scaleobjects,
 sec:textpath
}

\section{Resetting a Transformation Matrix}\label{sec:resetmatrix}

\menudef{menu.transform.reset}

The \gls{transformation-matrix} for \glspl{textarea}, \glspl{textpath}
and \glspl{bitmap} can be reset via the
\menu{transform.reset} menu item. This will reset the scale
and shear factors (but not the translation) for \glspl{textarea},
and will reset all elements for \glspl{textpath} and \glspl{bitmap}.

\chapter{Modifying Shapes}\label{sec:modshape}

\Glspl{shape} are defined by their segment types (line, \gls{curve}
or \glspl{gap}) and \glspl{controlpt}, which may be adjusted in edit
path mode (see \sectionref{sec:editpath}). It's also possible to
modify \glspl{shape} using \glspl{affine-transformation} (see
\sectionref{sec:affinetrans}), \gls{cag} (see \sectionref{sec:cag}),
distortion (see \sectionref{sec:distort}), reversing the order of
the \glspl{controlpt} and segments (see \sectionref{sec:reversing}), merging paths (see
\sectionref{sec:mergepaths}), or converting into one or more other
\glspl{shape} (see \sectionref{sec:converttopolygon},
\sectionref{sec:separate}, \sectionref{sec:patterns},
\sectionref{sec:converttofullpath} and
\sectionref{sec:outlinetopath}). 

\section{Edit Path Mode}\label{sec:editpath}

\menudef{menu.edit.path.edit}

\Glspl{path} consist of a sequence of lines, curves and \glspl{gap} 
that are defined by \glspl{controlpt}. These \glspl{controlpt} may be adjusted in
\emph{\inlineglsdef{edit-path-mode}} which can be switched on and off
with the \menu{edit.path.edit} toggle menu item.

\begin{information}
Edit mode can't be enabled for a \gls{shape} that is part of a \gls{group}.
If the selected shape is a \gls{compositeshape}, edit mode will allow the
underlying path to be edited.
\end{information}

The \gls{menu.edit.path.edit} menu item
is only available if exactly one \gls{shape} and no other
\gls{object} is \selected.

\subsection{Control Points}\label{sec:editcontrolpt}

The \glspl{controlpt} that define a \gls{shape} only become visible
and interactive when the shape is in \editpathmode.
To move, delete or add \glspl{controlpt}, open or close
\glspl{path}, or to convert segments from one form (line, \gls{gap}, cubic
\gls{Bezier-curve}) to another, first \select\ the \gls*{shape}, and
then either click on the \gls{menu.edit.path.edit} icon or select
\menu{edit.path.edit}.

The \gls*{path} will then be displayed in draft format.  The
currently selected \gls*{controlpt} and the currently selected
segment will appear in red. The other \glspl*{controlpt} will be
orange.

\begin{information}
The \manmsgpl{colour} can be changed via the \widget{graphics.title}
tab in the \dialog{configui} dialog. The size of the
\glspl{controlpt} can be changed in the \widget{controls.title} tab
of the \dialog{config} dialog. You may also want to adjust the
\widget{editpathui.title} in the \widget{graphics.title} tab of the
\dialog{configui} dialog.
\end{information}

\Glspl{compositeshape} may also be edited with 
the \gls{menu.edit.path.edit} function. The
\glspl{controlpt} will only be those on the underlying path and 
the special controls that define the \gls{compositeshape}.

A \gls{textpath} object can have its underlying path edited in the
same way as a normal \gls{path}, but in edit mode you will also see
the text (without \gls{anti-aliasing}).  Note that you can not edit
a \gls{path} if it belongs to a \gls{group}; you must first
\hyperref[sec:grouping]{ungroup it}.

\begin{information}
\Glspl{controlpt} rather than segments are selectable. The segment
that the selected \gls{controlpt} belongs to will then be
highlighted. You can either select a \gls{controlpt} with the mouse
or use the \gls{menu.editpath.next_control} or \gls{menu.editpath.prev_control}
items in the \gls{index.menu.editpath}.
\end{information}

A selected \gls{controlpt} can be moved by dragging with the mouse.
In a cluttered image with overlapping \glspl{controlpt} it can be
difficult to select and move the desired \gls{controlpt}.
If two or more points coincide
with the location of the mouse, the point with the lowest
\glslink{ptindex}{index} will be selected.
You may find it easier to use the \gls{index.menu.editpath}.

Dragging doesn't automatically select a \gls{controlpt} otherwise it
would be easy to accidentally select a coincident \gls{controlpt}
when trying to move a currently selected \gls{controlpt}.
This means that you can initiate dragging outside of the selected
\gls*{controlpt}, but make sure that you
first click to change the selection before initiating a drag or you
may move the wrong control.

\begin{important}
With the \widget{editpathui.canvasclick} option on, if you
click outside of any \gls{controlpt} the path edit mode will be
switched off. Otherwise you will need to toggle the
\menu{edit.path.edit} menu item to switch off path edit mode.
\end{important}

If the \gridlock\ is on, mouse clicks will be translated to the
nearest tick mark, so even if the pointer is positioned over a
control point, the nearest tick mark may be outside the control
point bounds. Enabling the \widget{editpathui.ignorelock} option in 
the \widget{graphics.title} panel will ignore the \gridlock\ for the
purposes of selecting \glspl{controlpt}.

\menudef{index.menu.editpath}

In path edit mode, the \gls{popupmenu} will change from the usual
\selectmode\ menus to provide functions to edit the \gls{path}.

\FloatFig{fig:editPathPopup}
 {\includeimg{editPathPopup}}
 {Edit Path Popup Menu}

\menudef{menu.editpath.next_control}

The \menu{editpath.next_control} menu item will select the next \gls{controlpt}
(wrapping round to the start from the final \gls{controlpt}).
This is an alternative to using the mouse to select a point.

\menudef{menu.editpath.prev_control}

The \menu{editpath.prev_control} menu item will select the previous \gls{controlpt}
(wrapping round to the end from the first \gls{controlpt}).
This is an alternative to using the mouse to select a point.

\menudef{menu.editpath.delete_control}

The \menu{editpath.delete_control} menu item will delete the current
\gls{controlpt}. 
Note that certain \glspl{controlpt}, such as curvature controls or points
the define a \gls{compositeshape}, can't be deleted.

If the \gls{controlpt} is the first or last point in an open path
this function will delete the corresponding segment, otherwise it
will replace two adjacent segments with a single segment.  If the
path is open and only has one segment, or if the path is closed and
has two segments, deleting a control point will delete the
\gls{shape} or the \gls{textpath} object. (The text will also be lost when
the \gls{textpath} is deleted.)

\menudef{menu.editpath.add_control}

The \menu{editpath.add_control} menu item will add a new
\gls{controlpt} in the middle of the currently selected segment.
This actually replaces the selected segment with two new segments of 
half the length of the original that maintain the same shape.
This function is only available for normal path segments and not for
segments used to alter \glspl{compositeshape}.

\menudef{menu.editpath.convert_to_line}

The \menu{editpath.convert_to_line} menu item will convert the
current segment to a line. This function will be unavailable if the
current segment is already a line or if it isn't a normal path segment.

\menudef{menu.editpath.convert_to_curve}

The \menu{editpath.convert_to_curve} menu item will convert the
current segment to a \gls{Bezier-curve}. The new curvature 
\glspl{controlpt} can then be moved as required.
This function will be unavailable if the
current segment is already a \gls{Bezier-curve} or if it isn't a normal path segment.

\menudef{menu.editpath.convert_to_move}

The \menu{editpath.convert_to_move} menu item will convert the
current segment to a \gls{gap} (\qt{move to}). This function will be
unavailable if the current segment is already a \gls{gap} or if it
isn't a normal path segment.
If you want to close a sub path and move to the start of a new sub
path, change the \gls{move-to} segment to a \gls{closing-move}
segment with the \menu{editpath.close_sub_path} menu item.

\menudef{menu.editpath.symmetry}

The \menu{editpath.symmetry} sub menu can be used to add or remove
\gls{symmetry}.
See \sectionref{sec:symmetric} for further details.

\menudef{menu.editpath.continuity}

If the selected segment is a \gls{Bezier-curve}, the
\menu{editpath.continuity} sub menu provides functions that adjust
the curvature \gls*{controlpt} to ensure that the gradient at the
nearest join is continuous. This sub menu isn't available if it's not
possible to do this (for example, if the nearest join is an end
point). See \sectionref{sec:continous} for further details.

\menudef{menu.editpath.open_path}

The \menu{editpath.close_path} sub menu provides functions to open a
closed path.

\menudef{menu.editpath.open_path.remove_last}

The \menu{editpath.open_path.remove_last} menu item
opens the path, removing the last segment (\figureref{fig:openpathb}).

\menudef{menu.editpath.open_path.keep_last}

The \menu{editpath.open_path.keep_last} menu item
opens the path, but keeps the last segment (\figureref{fig:openpathb}).

\FloatSubFigs{fig:openpath}
{
 {fig:openpatha}{\includeimg{open-patha}}{},
 {fig:openpathb}{\includeimg{open-pathb}}{},
 {fig:openpathc}{\includeimg{open-pathc}}{}
}
  [Opening a Path]
  {Opening a path: \subfigref{fig:openpatha} the original closed path;
   \subfigref{fig:openpathb} the path in \subfigref{fig:openpatha} was opened,
   removing the final segment; \subfigref{fig:openpathc} the path in 
   \subfigref{fig:openpatha} was opened, keeping the last segment.}

\menudef{menu.editpath.close_path}

The \menu{editpath.close_path} sub menu provides functions to join
the end of the \gls{shape} to its start to close an open path.

\menudef{menu.editpath.close_path.line}

The \menu{editpath.close_path.line} menu item will
close the path with a line between the last and first
\glspl*{controlpt} of the original path (\figureref{fig:closepatha}).

\menudef{menu.editpath.close_path.cont}

The \menu{editpath.close_path.cont} menu item will
close the path with a \gls{Bezier-curve} between the last and first
\glspl*{controlpt} such that the curve is continuous at the join
between the first and last segments of the original path
(\figureref{fig:closepathb}).

\menudef{menu.editpath.close_path.merge}

The \menu{editpath.close_path.merge} menu item will
close the path, merging the last \gls*{controlpt} of the original
path with the first \gls*{controlpt} (\figureref{fig:closepathc}).

\FloatSubFigs {fig:closepath}
{%
  {fig:closepatha}{\includeimg{close-patha}}{},
  {fig:closepathb}{\includeimg{close-pathb}}{},
  {fig:closepathc}{\includeimg{close-pathc}}{},
  {fig:closepathd}{\includeimg{close-pathd}}{}
}
[Closing a Path]
{Closing a path: \subfigref{fig:closepatha} the original path;
\subfigref{fig:closepathb}
the path in \subfigref{fig:closepatha} was closed with a line;
\subfigref{fig:closepathc} the path in \subfigref{fig:closepatha} was closed with a
curve continuous at the join between adjacent segments;
\subfigref{fig:closepathd} the path in \subfigref{fig:closepatha} was closed, merging
the end points}

\menudef{menu.editpath.close_sub_path}

If a \gls{move-to} segment is selected or if the final segment of a
\gls{path} is selected, then the \menu{editpath.close_sub_path} menu
item can be used to close a \gls+{sub-path}.

In the first case, where a \gls{move-to} segment is selected, the
existing segment will be replaced with a special \gls+{closing-move}
segment, which will draw a line from its starting \gls{controlpt} to the
start of the \gls{sub-path} and then move to the \gls{controlpt} at the start of
the next \gls{sub-path}. The line will move if the \gls{controlpt} at the
start of the \gls{sub-path} is moved. The path will still be considered
open if it was previously open.

In the second case, if the final segment is selected but isn't a \gls{move-to}, a
new \gls{closing-move} segment will be added and its end
\gls{controlpt} will be merged to the \gls{path}['s] first
\gls{controlpt}. The path will then be considered closed.

To open a closed \gls{sub-path}, simply select the \gls{closing-move}
segment and use the \menu{editpath.convert_to_move} menu item to 
convert it to a normal \gls{move-to} segment (or convert to a line
or a \gls{Bezier-curve}).

TODO

\menudef{menu.editpath.coordinates}

The \menu{editpath.coordinates} menu item will display the
\inlineglsdef{coordinates.title} dialog box in which you can set the
\gls{controlpt}['s] $x$ and $y$ values (instead of dragging the
point to the required location).  Note that rounding errors may
occur if the unit used in this dialog doesn't have a convenient
conversion factor with the \gls{storageunit}.

\plabel[Segment Details]{mi:segmentinfo}% HelpSet id
\menudef{menu.editpath.info}

The \menu{editpath.info} menu item will option the 
\inlineglsdef{segmentinfo.title} dialog box shown in
\figureref{fig:segmentinfo}, which describes the segment type and
provides numeric fields in which to adjust the co-ordinates of the
segment. Note that the end \gls{controlpt} won't be enabled unless 
it's the end point of an open path.

Any changes made in this dialog won't take effect until you click on
the \btn{okay} button. The \btn{cancel} button will discard all the
changes (after prompting for confirmation). Use the 
\widget{segmentinfo.default} button to revert the working segment
back to its current state in the actual path.

\FloatFig{fig:segmentinfo}
{\includeimg{segmentinfo}}
{Segment Details Dialog}

\menudef{menu.editpath.snap}

The \menu{editpath.snap} menu item will
move the currently selected \gls*{controlpt} to the nearest
tick mark.

\plabel[Breaking a Path]{mi:breakpath}
\menudef{menu.editpath.break_path}

The \menu{editpath.break_path} menu item will split the current path
into two distinct \glspl{path} at the \emph{end} of the currently
selected segment (not at the currently selected \gls*{controlpt}).
One path will remain in \editpathmode. 
If the object is a \gls*{textpath}, the new \glspl*{textpath} will
both have the same text (that is, the text is not broken between
them).

\seealsorefs{
 sec:reversing,
 sec:mergepaths,
 sec:pathunion,
 sec:xorpath,
 sec:pathintersect,
 sec:pathsubtract,
 sec:outlinetopath,
 sec:linepaint,
 sec:fillpaint,
 sec:styles,
 sec:toastexample,
 sec:busexample,
 sec:accesstutorial
}

\subsection{Gradient Continuity}\label{sec:continous}

Joins between \gls{path} segments, where one of both segments is a
\gls{Bezier-curve}, can be made continuous (a smooth join)
in \editpathmode\ with the \menu{editpath.continuity} sub menu.

\menudef{menu.editpath.continuity.equi}

The \menu{editpath.continuity.equi} menu item will move the selected
curvature \gls*{controlpt} so that it has the same gradient
direction and magnitude as the gradient vector on the other side of
the join.
This function is only available if the selected \gls{controlpt} is
a curvature control.

\menudef{menu.editpath.continuity.relative}

The \menu{editpath.continuity.relative} menu item will move the
selected curvature control so that it has the same direction as the
gradient on the other side of the join, but its magnitude will
remain unchanged. (See \figureref{fig:continuous}.)
This function is only available if the selected \gls{controlpt} is
a \gls{curvature-controlpt}.

\menudef{menu.editpath.continuity.anchor}

The \menu{editpath.continuity.anchor} menu item is only available
when a \gls*{controlpt} on the join between two \glspl{Bezier-curve}
has been selected. If this item is selected, when you adjust one of
the adjacent \glspl{curvature-controlpt}, the corresponding curvature
control on the other segment will be adjusted to maintain
\gls{continuity}. An \gls{continuity.anchor} image will appear in the control joining the
two segments when this setting is on (as shown in
\figureref{fig:continuityanchor}).

For example, in \figureref{fig:continuous} the path was originally
an open line \gls{path} with three line segments.  The middle segment was
selected and converted to a \gls{Bezier-curve} using the
\menu{editpath.convert_to_curve} function
(\figureref{fig:continuousa}). The
\menu{editpath.continuity.relative} function was then
used to change the starting \gls{gradient} of the \gls{Bezier-curve} to make
a smooth join between the first two segments
(\figureref{fig:continuousb}).  The \gls{Bezier-curve}['s] third
\gls*{controlpt}, which governs the end curvature, was selected, and
the \menu{editpath.continuity.relative} function was
again used to change the end \gls{gradient} of the \gls{Bezier-curve} to
make a smooth join between the last two segments
(\figureref{fig:continuousc}).

\FloatSubFigs{fig:continuous}
{
 {fig:continuousa}{\includeimg{continuous1a}}{},
 {fig:continuousb}{\includeimg{continuous1b}}{},
 {fig:continuousc}{\includeimg{continuous1c}}{}
}
[Making the Join Between Segments Continuous]
{Making the join between segments continuous: 
\subfigref{fig:continuousa} the middle segment of
an open line path has been converted into a \gls{Bezier-curve};
\subfigref{fig:continuousb} the gradient at the start of the curve is now the same as
the gradient at the end of the previous segment; 
\subfigref{fig:continuousc} the
gradient at the end of the curve is now the same as the gradient at
the start of the next segment.}

\FloatFig
  {fig:continuityanchor}
   {\includeimg{continuityanchor}}
   {Continuity Anchor}

\seealsorefs{sec:editpath}

\subsection{Symmetric Shapes}\label{sec:symmetric}

\Glspl{symmetricshape} are created by applying
\inlineglsdef{symmetry} to an existing \gls{shape} in 
\editpathmode\ via the \menu{editpath.symmetry} sub menu.

\FloatSubFigs{fig:symmetric}
{
  {fig:symmetrica}{\includeimg{symmetrica}}{},
  {fig:symmetricb}{\includeimg{symmetricb}}{},
  {fig:symmetricc}{\includeimg{symmetricc}}{},
  {fig:symmetricd}{\includeimg{symmetricd}}{},
  {fig:symmetrice}{\includeimg{symmetrice}}{}
}
[Adding Symmetry to a Path]
{Adding Symmetry to a Path: \subfigref{fig:symmetrica} original path;
\subfigref{fig:symmetricb} symmetry added to path in \subfigref{fig:symmetrica} the
two blue controls govern the line of symmetry;
\subfigref{fig:symmetricc} the line of symmetry has been moved, altering the
overall appearance of the shape; \subfigref{fig:symmetricd} the end anchor
constraint has been removed and the end control has been moved
away from the line of symmetry; \subfigref{fig:symmetrice} the joining segment
has been converted to a curve with only one curvature control.}

\menudef{menu.editpath.symmetry.has_symmetry}

The \menu{editpath.symmetry.has_symmetry} menu item can be toggled
to add or remove \gls{symmetry}. Adding symmetry will replace the existing
\gls{shape} with a \gls{symmetricshape}. This has extra
\glspl{controlpt} that govern the \inlineglsdef{line-of-symmetry}.
Removing \gls{symmetry} will replace the existing \gls{symmetricshape}
with its underlying \gls{shape}.

For example, \figureref{fig:symmetrica} shows a \gls*{path}
in \editpathmode, and \figureref{fig:symmetricb} shows the
path with \gls{symmetry} applied to it. There are now two extra
\glspl{controlpt} (\manmsg{coloured} blue). These points govern the 
\gls{line-of-symmetry}. In \figureref{fig:symmetricc}, these two controls
have been moved.

\begin{information}
The \gls{line-of-symmetry} extends infinitely though the two controls,
but only the part of the line between the two points is actually
displayed in edit mode.
\end{information}

If you later decide to remove the symmetry, deselect
\menu{editpath.symmetry.has_symmetry}.

\begin{warning}
Adding \gls{symmetry} to a closed shape may cause unexpected
results as the shape will be first opened (without removing the
last segment), the \gls{symmetry} will be added, and then the symmetric
shape will be closed, merging the end points.
\end{warning}

\menudef{menu.editpath.symmetry.join_anchor}

The \menu{editpath.symmetry.join_anchor} menu item can be toggled to
determine whether or not the reflection is
\glslink{line-of-symmetry.anchor}{anchored} to the underlying
path at its end point. If this option is on, the end \gls{controlpt}
will be constrained to the \gls{line-of-symmetry}.  That is, the end
\gls{controlpt} can only move along the line defined by the two blue
\glspl*{controlpt}.  In \figureref{fig:symmetricd}, the
\menu{editpath.symmetry.join_anchor} item was deselected, and the
end control was then moved away from the \gls{line-of-symmetry}.

Note that this function places a \gls{gap} (move) segment between the
end control and its symmetric counterpart, which will produce an
unsymmetric effect if the path is then closed. This gap can be changed to
a line or curve, using \menu{editpath.convert_to_line} or
\menu{editpath.convert_to_curve}, as described in
\sectionref{sec:editpath}. In \figureref{fig:symmetrice},
the join has been changed to a curve. Unlike the \glspl{Bezier-curve}
in the non-symmetric paths, this curve only has one 
\gls{curvature-controlpt}.

The \gls{menu.editpath.symmetry.join_anchor} function is only available
if \gls{menu.editpath.symmetry.has_symmetry} is on.

\menudef{menu.editpath.symmetry.close_anchor}

The \menu{editpath.symmetry.close_anchor} menu item can be toggled
to determine whether or not the reflection is
\glslink{line-of-symmetry.anchor}{anchored} to the
underlying path at is start point.  If this option is on, the start
\gls{controlpt} will be constrained to the \gls{line-of-symmetry}.  This
function is only available if
\gls{menu.editpath.symmetry.has_symmetry} is on and the
underlying \gls{path} is closed.

For example, \figureref{fig:closedsymmetrica} shows a closed
symmetric path (a closed version of \figureref{fig:symmetrice}). The
\gls{line-of-symmetry.anchor} constraint on the first control was
then removed and the control was moved to the left
(\figureref{fig:closedsymmetricb}). As with the join segment (above)
the closing segment between the start control and its reflection can
be changed to a curve with one \gls{curvature-controlpt}
(\figureref{fig:closedsymmetricc}).

\FloatSubFigs{fig:closedsymmetric}
{
 {fig:closedsymmetrica}{\includeimg{closedsymmetrica}}{},
 {fig:closedsymmetricb}{\includeimg{closedsymmetricb}}{},
 {fig:closedsymmetricc}{\includeimg{closedsymmetricc}}{}
}
[Closed Symmetric Path]
{Closed symmetric path: \subfigref{fig:closedsymmetrica} the symmetric path in
\figureref{fig:symmetrice} has been closed\dash the
first control is now anchored to the line of symmetry;
\subfigref{fig:closedsymmetricb} deselecting the close anchor constraint allows
the start control to be moved away from the line of symmetry;
\subfigref{fig:closedsymmetricc} the segment closing the symmetric path has been
changed to a curve.}

\begin{warning}
Take care with closed symmetric paths. Unexpected results
may occur, particularly if the path contains any gaps. This may
cause the stroked or filled shape to appear unsymmetric.
For example, \figureref{fig:symgapa} shows the original
(non-symmetric path). This was then given a line of symmetry and
the path appears symmetric, as shown in \figureref{fig:symgapb}. In
\figureref{fig:symgapc}, two of the line segments have been
converted to gaps. The shape still appears symmetric although the
filled area has changed, but in \figureref{fig:symgapd} the path
has been closed with a line so although the control points that
make up right side of the complete path are a reflection of the
original points on the left side, the shape no longer appears
symmetric.
\end{warning}

\FloatSubFigs{fig:symgap}
{
  {fig:symgapa}{\includeimg{symgapa}}{},
  {fig:symgapb}{\includeimg{symgapb}}{},
  {fig:symgapc}{\includeimg{symgapc}}{},
  {fig:symgapd}{\includeimg{symgapd}}{}
}
[Symmetric Path with Gaps]
{Symmetric Path with Gaps:
\subfigref{fig:symgapa} the original path;
\subfigref{fig:symgapb} symmetry has been added;
\subfigref{fig:symgapc} two line segments have been replaced with gaps;
\subfigref{fig:symgapd} the path has been closed.}

\seealsorefs{
 sec:editpath,
 sec:patterns,
 sec:rosetutorial
}

\section{Merging Paths}\label{sec:mergepaths}

\menudef{menu.transform.merge}

Multiple \glspl{shape} can be merged into a single \gls*{shape}
using the \menu{transform.merge} menu item. Note that this is not
the same as \hyperref[sec:grouping]{grouping}.  A \gls{gap} (move
to) will be placed between the last \gls{controlpt} of one path and
the first \gls*{controlpt} of the next path. Any \gls{pattern} in
the selection will be first \hyperref[sec:converttofullpath]{converted
to a full path} before merging.

\begin{information}
To split an existing \gls{path} into two separate \glspl{path}, use the
\menu{editpath.break_path} popup menu item in \editpathmode.
\end{information}

Once the shape has been merged, it can then be edited as usual in
\editpathmode.  If the original shapes had different styles, the new
shape will retain the style of the first shape (the lowest one in
the \gls{stack}). For example, in \figureref{fig:mergea} there are
two \glspl{path} with different styles. \figureref{fig:mergeb} shows
the single \gls{path} created from merging the two original paths.
Since the first path used the even-odd winding rule, the new shape
has a hole in it.

\FloatSubFigs{fig:merge}
{
  {fig:mergea}{\includeimg{mergepatha}}{},
  {fig:mergeb}{\includeimg{mergepathb}}{}
}
[Merging Two Paths]
{Merging two paths:
\subfigref{fig:mergea} the first path has a solid line pattern, a
green fill \manmsg{colour} and even-odd winding rule, and the second
path has a dashed line pattern and a yellow fill \manmsg{colour};
\subfigref{fig:mergeb} resulting merged path has a solid line
pattern, green fill \manmsg{colour} and even-odd winding rule.}

The same applies if one or more of the selected \glspl*{object} is a
\gls{textpath}. For example, in \figureref{fig:mergetextpathsa}
there are two \glspl*{textpath}.  These are merged to form a single
\gls*{textpath} shown in \figureref{fig:mergetextpathsb}. Note that
the text from the second \gls{textpath} is lost. The resulting path
is shown in \editpathmode\ in \figureref{fig:mergetextpathsc} to
illustrate the underlying path. A mixture of \glspl*{path} and
\glspl*{textpath} can be merged. The resulting \gls*{object} will be
a \gls*{textpath} if the first object to be merged is a
\gls*{textpath}, otherwise it will be a \gls*{path}.

\FloatSubFigs{fig:mergetextpaths}
{
  {fig:mergetextpathsa}{\includeimg{mergetextpathsa}}{},
  {fig:mergetextpathsb}{\includeimg{mergetextpathsb}}{},
  {fig:mergetextpathsc}{\includeimg{mergetextpathsc}}{}
}
[Merging Two Text-Paths]
{Merging two text-paths:
\subfigref{fig:mergetextpathsa} the first path is on the left and
the second path is on the right;
\subfigref{fig:mergetextpathsb} resulting merged path;
\subfigref{fig:mergetextpathsc} resulting merged path in
edit mode to illustrate the underlying path}

\Glspl{path} are merged according to their \gls{stackingorder}. For
example, in \figureref{fig:merge2a} there are two \glspl{path}, both
with a bar start marker, and an arrow end marker. The path on the
right is further back in terms of the \gls{stackingorder}. (That is,
it gets \glslink{painting}{painted} on the \gls{canvas} before the
other path.) \figureref{fig:merge2b} shows the result of merging the
two paths\dash the left hand path has been appended to the right
hand path. \figureref{fig:merge2c} shows the same two paths as in
\figureref{fig:merge2a} except that now the left path is the
\gls{back}. There is no visible difference between
\figureref{fig:merge2a} and \figureref{fig:merge2c}, but the result
of merging the paths in \figureref{fig:merge2c} (see
\figureref{fig:merge2d}) is different to
\figureref{fig:merge2b}\dash the right hand path has been appended
to the left hand path.

\FloatSubFigs{fig:merge2}
{
  {fig:merge2a}{\includeimg{mergepath2a}}{},
  {fig:merge2b}{\includeimg{mergepath2b}}{},
  {fig:merge2c}{\includeimg{mergepath2a}}{},
  {fig:merge2d}{\includeimg{mergepath2d}}{}
}
[Paths Are Merged According to the Stacking Order]
{Paths are merged according to the stacking order:
\subfigref{fig:merge2a} two straight line paths where the path 
on the right is at the back of the stack;
\subfigref{fig:merge2b} new single path resulting from merging 
the two paths in \subfigref{fig:merge2a};
\subfigref{fig:merge2c} same as \subfigref{fig:merge2a} but the path on the left
is at the back of the stack;
\subfigref{fig:merge2d} new single path resulting from merging 
the two paths in \subfigref{fig:merge2c}.}

\seealsorefs{
 sec:pathunion,
 sec:xorpath,
 sec:pathintersect,
 sec:pathsubtract,
 sec:reversing,
 sec:moveupordown,
 sec:cheeseexample
}

\section{Reversing a Path's Direction}\label{sec:reversing}

\menudef{menu.transform.reverse}

The direction of a \gls{path} or \gls{textpath} can be reversed
using the \menu{transform.reverse} menu item. For example, the path
in \figureref{fig:reverse} has a bar start marker, pointed arrow
mid-markers and a \LaTeX\ style arrow end marker.
\figureref{fig:reversea} shows the original path, and
\figureref{fig:reverseb} shows the reversed path. Note that all the
\glspl{controlpt} are in the same place, but their ordering has
changed, so that what was originally the first \gls{controlpt} is
now the last \gls{controlpt}.

\FloatSubFigs{fig:reverse}
{
  {fig:reversea}{\includeimg{reverse1a}}{},
  {fig:reverseb}{\includeimg{reverse1b}}{}
}
[Reversing the Direction of a Path]
{Reversing the direction of a path:
\subfigref{fig:reversea} original path;
\subfigref{fig:reverseb} reversed path\dash
the vertices are in the same location, but the order has been
reversed.}

In \figureref{fig:reversetextpath}, the \gls*{textpath} in
\figureref{fig:reversetextpatha} is reversed to form 
\figureref{fig:reversetextpathb}. Note that the text now starts
from the right instead of the left, since the first \gls*{controlpt}
is now on the right, and it is upside-down.

\FloatSubFigs{fig:reversetextpath}
{
  {fig:reversetextpatha}{\includeimg{reversetextpatha}}{},
  {fig:reversetextpathb}{\includeimg{reversetextpathb}}{}
}
[Reversing the Direction of a Text-Path]
{Reversing the direction of a text-path:
\subfigref{fig:reversetextpatha} original text-path;
\subfigref{fig:reversetextpathb} reversed text-path\dash 
the vertices are in the same location, but the order has been
reversed so the text starts from the other end.}

\section{Convert to Polygon}\label{sec:converttopolygon}

If you want to convert a single \gls{curve} segment to a single
line segment, you can simply enable \editpathmode, and use the 
\menu{editpath.convert_to_line} item from the popup menu.
However, if you want to replace every curve with one or more straight
lines then you may prefer to use the \transformfn{convert_to_polygon}
function.

\menudef{menu.transform.convert_to_polygon}

The \gls{curve} segments of a \gls{path} (or underlying path)
can be converted into a series of straight line segments with the
\menu{transform.convert_to_polygon} menu item, which will result in
a polygonal shape. The number of lines used to replace an individual
curve segment is determined by the \emph{flatness} parameter.

\begin{information}
There is a maximum limit of 1024 replacement line segments per
\gls{curve}.
\end{information}

First \select\ the \gls{shape} with \glspl{curve} that need to be transformed.
For example, in \figureref{fig:converttopolygona} a closed \gls{path}
with four \gls{curve} segments has been selected.

\FloatSubFigs{fig:converttopolygon}
{
  {fig:converttopolygona}{\includeimg{converttopolygona}}{},
  {fig:converttopolygonb}{\includeimg{converttopolygonb}}{}
}
[Converting a Shape With Curves to a Polygon]
{Converting a shape with curves to a polygon:
\subfigref{fig:converttopolygona} original shape with four
curve segments;
\subfigref{fig:converttopolygonb} converted shape (flatness 4.0) 
with fourteen line segments.}


\widgetdef{polygon.title}

The \menu{transform.convert_to_polygon} menu item will open the
\dialog{polygon} dialog, shown in \figureref{fig:polygondialog}.
This will show a draft outline of the selected shape (in this case,
the shape from \figureref{fig:converttopolygona}).

\FloatFig{fig:polygondialog}
{\includeimg{polygondialog}}
{Convert to Polygon Dialog}

\widgetdef{polygon.flatness}

The \widget{polygon.flatness} numeric field should be set to the
flatness parameter. This is the maximum allowable distance (in \gls{bp})
between the \glspl{controlpt} and the flattened \gls{curve}. A small
value will create a series of line segments that are as close to the
original curve as possible. This may result in many short line
segments depending on the curvature of the original \gls{curve}.

\widgetdef{polygon.dotask}

Once you have set the desired flatness parameter, click on the
\widget{polygon.dotask} button. This will draw the calculated
polygon over the original shape for comparison. For example, 
\figureref{fig:polygondialog1} shows the calculated polygon with
the flatness parameter set to 1.

\FloatFig{fig:polygondialog1}
{\includeimg{polygondialog1}}
{Convert to Polygon Dialog: Result with 1.0 Flatness}

On the right-hand side of the \dialog{polygon} dialog is an
information panel that details the number of lines used, the length
of the polygon's perimeter, the polygon's area and the \gls{xor} area.
It also lists the path's definition where \qt{M} indicates a move to
(followed by the co-ordinate pair to move to), \qt{L} indicates a line to
(followed by the co-ordinate pair to draw a line to), and \qt{Z}
indicates close path.

If the result isn't quite satisfactory, you can adjust the flatness
parameter and click on the \widget{polygon.dotask} button again.
For example, I changed the flatness to 4 and recalculated. This
produced the polygon shown in \figureref{fig:polygondialog2} which
has fewer line segments with a greater deviation from the original
shape.

\FloatFig{fig:polygondialog2}
{\includeimg{polygondialog2}}
{Convert to Polygon Dialog: Result with 4.0 Flatness}

\widgetdef{polygon.reload}

You can clear the dialog and reset it back to just the original
selected shape with the \widget{polygon.reload} button.
There is also a zoom widget on the bottom left which can be used to
adjust the magnification.

If you want to replace the selected path with the
calculated polygon, click on the \widget{okay} button.  For example,
\figureref{fig:converttopolygonb} is the result with the flatness set
to 4. Note that this new polygonal shape has more segments that the 
original curving shape.

\begin{information}
The \widget{okay} button is only enabled once a polygon has been
calculated. If you change you mind you can click on the \widget{cancel}
button to discard the draft. You will be prompted for confirmation
if a polygon has been calculated.
\end{information}


\section{Constructive Area Geometry (CAG)}\label{sec:cag}

\Glsxtrfull{cag} is the process of creating new geometric objects by
performing logical operations on existing objects. These functions
replace two or more \selected\ \glspl*{shape} with a new single
\gls{shape}.

\subsection{Path Union}\label{sec:pathunion}

\menudef{menu.transform.union}

Area \inlineglsdef{cag.addition} can be performed on
\glspl{shape} with the \menu{transform.union} menu item. That is,
multiple \glspl{shape} can be combined into a single \gls*{shape} by
performing a union on all the selected \glspl*{shape}.

At least two \glspl*{shape} must be selected to perform this
function. As with the \hyperref[sec:mergepaths]{merge path function}, the
new shape has the same styles as the \glslink{back}{backmost} path
in the selection.

For example, in \figureref{fig:pathuniona}, there are three
overlapping paths.  In \figureref{fig:pathunionb} the paths have
been replaced by a single path created using the path union
function. For comparison, the same three paths in
\figureref{fig:pathuniona} were replaced using the
\hyperref[sec:mergepaths]{merge function}. The result is shown in
\figureref{fig:pathunionc}.

\FloatSubFigs*{fig:pathunion}
{
  {fig:pathuniona}{\includeimg{geom}}{},
  {fig:pathunionb}{\includeimg{pathunion}}{},
  {fig:pathunionc}{\includeimg{geommerge}}{}
}
[Path Union]
{Path union:
\subfigref{fig:pathuniona} original paths (the rear path has an
orchid fill \manmsg{colour} 2bp line width and round join style);
\subfigref{fig:pathunionb} the three paths in
\subfigref{fig:pathuniona} have been replaced by a single path using
the path union function;
\subfigref{fig:pathunionc} for comparison, the three paths in
\subfigref{fig:pathuniona} have been replaced by a single path using
the merge paths function.}

In \figureref{fig:textpathunion}, a \gls*{textpath} and a
\gls*{path} are combined: \figureref{fig:textpathuniona} shows
the original objects and \figureref{fig:textpathunionb} shows
the resulting object. In this case, the resulting object is a
\gls*{textpath} since the \glslink{back}{backmost} path in
\figureref{fig:textpathuniona} was the \gls*{textpath} object.

\FloatSubFigs{fig:textpathunion}
{
  {fig:textpathuniona}{\includeimg{textpathuniona}}{},
  {fig:textpathunionb}{\includeimg{textpathunionb}}{}
}
[Text-Path Union]
{Text-path union: \subfigref{fig:textpathuniona} original text-path
and path; \subfigref{fig:textpathunionb} objects in
\subfigref{fig:textpathuniona} have been replaced with text-path.}

Any \gls{pattern} in the selection will first be converted to a full
\gls{path} before the union is applied. For example, in
\figureref{fig:patternunion}, two patterns are combined:
\figureref{fig:patternuniona} shows the original patterns (both have
a rotational pattern with 2 replicas) and
\figureref{fig:patternunionb} shows the resulting path. This path is
illustrated in edit mode in \figureref{fig:patternunionc} to show
that it is now a full path.

\FloatSubFigs*{fig:patternunion}
{
  {fig:patternuniona}{\includeimg{patternunionexa}}{},
  {fig:patternunionb}{\includeimg{patternunionexb}}{},
  {fig:patternunionc}{\includeimg{patternunionexc}}{}
}
[Pattern Union]
{Pattern union: \subfigref{fig:patternuniona} original patterns;
\subfigref{fig:patternunionb} patterns in
\subfigref{fig:patternuniona} have been combined to form a full
path; \subfigref{fig:patternunionc} result shown in edit mode.}

\seealsorefs{
 sec:mergepaths,
 sec:xorpath,
 sec:pathintersect,
 sec:pathsubtract,
 sec:reversing,
 sec:busexample
}

\subsection{Exclusive Or Function}\label{sec:xorpath}

\menudef{menu.transform.xor}

Area \inlineglsdef{cag.xor} can be performed on \glspl{shape} with
the \menu{transform.xor} menu item. That is, multiple \glspl{shape}
can be combined into a single \gls*{shape} by performing an
\gls{cag.xor} operation on all the selected \glspl*{shape}.  At
least two \glspl*{shape} must be selected to perform this function.
As with the \hyperref[sec:mergepaths]{merge path function}, the new
\gls*{shape} has the same styles as the \glslink{back}{backmost}
path in the selection and \glspl{pattern} will be converted to full
\glspl{path}.

For example, in \figureref{fig:xorpatha}, there are three
overlapping paths.  The rear path has a non-zero winding rule. In
\figureref{fig:xorpathb} the paths have been replaced by a
single path created using the \transformfn{xor} function. For comparison,
the same three paths in \figureref{fig:xorpatha} were replaced
using the \hyperref[sec:mergepaths]{merge function}. The result is
shown in \figureref{fig:xorpathc}. Both paths in
\figureref{fig:xorpathb} and \figureref{fig:xorpathc} use
a non-zero winding rule, since that was used by the rear path in
\figureref{fig:xorpatha}.

\FloatSubFigs*{fig:xorpath}
{
 {fig:xorpatha}{\includeimg{geom}}{},
 {fig:xorpathb}{\includeimg{xorpaths}}{},
 {fig:xorpathc}{\includeimg{geommerge}}{}
}
[Exclusive Or Function]
{Exclusive Or function: 
\subfigref{fig:xorpatha} original paths (the rear path has 
a non-zero winding rule, orchid
fill \manmsg{colour} and round join style);
\subfigref{fig:xorpathb} the three paths in
\subfigref{fig:xorpatha} have been replaced by 
a single path using the exclusive or function; 
\subfigref{fig:xorpathc} for comparison, the three paths in
\subfigref{fig:xorpatha} have been replaced by 
a single path using the merge paths function.}

\seealsorefs{
 sec:mergepaths,
 sec:pathunion,
 sec:pathintersect,
 sec:pathsubtract,
 sec:reversing
}

\subsection{Path Intersection}\label{sec:pathintersect}

\menudef{menu.transform.intersect}

Area \inlineglsdef{cag.intersection} can be performed on \glspl{shape} with
the \menu{transform.intersect} menu item. That is, multiple \glspl{shape}
can be combined into a single \gls*{shape} by performing an
\gls{cag.intersection} operation on all the selected \glspl*{shape}.  At
least two \glspl*{shape} must be selected to perform this function, 
and at least two of the shapes (or underlying path
in the case of a \gls{textpath}) must overlap.
As with the \hyperref[sec:mergepaths]{merge path function}, the new
\gls*{shape} has the same styles as the \glslink{back}{backmost}
path in the selection and \glspl{pattern} will be converted to full
\glspl{path}.

For example, in \figureref{fig:pathintersecta},
there are three overlapping paths.  In
\figureref{fig:pathintersectb} the paths have been replaced by
a single path created using the path intersect function.

\FloatSubFigs{fig:pathintersect}
{
  {fig:pathintersecta}{\includeimg{geom}}{},
  {fig:pathintersectb}{\includeimg{intersectpaths}}{}
}
[Path Intersection Function]
{Path intersection function: 
\subfigref{fig:pathintersecta} original paths (the rear path has 
an orchid fill \manmsg{colour} and round join style); 
\subfigref{fig:pathintersectb} the three paths 
in \subfigref{fig:pathintersecta} have been
replaced by a single path using the path intersect function.}

\seealsorefs{
 sec:mergepaths,
 sec:pathunion,
 sec:xorpath,
 sec:pathsubtract,
 sec:reversing
}

\subsection{Path Subtraction}\label{sec:pathsubtract}

\menudef{menu.transform.subtract}

Area \inlineglsdef{cag.subtraction} can be performed on \glspl{shape} with
the \menu{transform.subtract} menu item. That is, multiple \glspl{shape}
can be combined into a single \gls*{shape} by performing a
\gls{cag.subtraction} operation on all the selected \glspl*{shape}.  At
least two \glspl*{shape} must be selected to perform this function.
The new shape is the \glslink{back}{backmost} selected shape with
the other selected shapes subtracted from it. Any \glspl{pattern} in
the selection will be converted to full paths.

For example, in
\figureref{fig:pathsubtracta}, there are three overlapping
paths.  In \figureref{fig:pathsubtractb} the paths have been
replaced by a single path created using the path subtraction
function.

The new path will be a \gls*{textpath} if the backmost selected
object was a \gls*{textpath} and the text will adjust to fit the
new underlying path. For example, in
\figureref{fig:textpathsubtracta}, there is a \gls*{textpath}
and a \gls*{path}. The \gls*{textpath} is the backmost path.
In \figureref{fig:textpathsubtractb}, the two objects have
been replaced by a single \gls*{textpath} using the path subtraction
function.

\FloatSubFigs{fig:pathsubtract}
{
  {fig:pathsubtracta}{\includeimg{geom}}{},
  {fig:pathsubtractb}{\includeimg{subtractpaths}}{}
}
[Path Subtraction Function]
{Path subtraction function:
\subfigref{fig:pathsubtracta} original paths (the rear path 
has an orchid fill \manmsg{colour} and round join style);
\subfigref{fig:pathsubtractb} the three paths 
in \subfigref{fig:pathsubtracta} have
been replaced by a single path using the path subtraction function.}

\FloatSubFigs{fig:textpathsubtract}
{
  {fig:textpathsubtracta}{\includeimg{subtracttextpatha}}{},
  {fig:textpathsubtractb}{\includeimg{subtracttextpathb}}{}
}
[Subtracting From a Text-Path]
{Subtracting from a text-path: 
\subfigref{fig:textpathsubtracta} original text-path and path; 
\subfigref{fig:textpathsubtractb} the path has been 
subtracted from the underlying path of the text-path.}

\seealsorefs{
 sec:mergepaths,
 sec:pathunion,
 sec:xorpath,
 sec:pathintersect,
 sec:reversing,
 sec:busexample
}

\section{Distorting Shapes}\label{sec:distort}

\menudef{menu.transform.distort}

A selected \gls{path} (not a \gls{compositeshape}) can be distorted using the
\menu{transform.distort} menu item. While this toggle
button\slash item is on, the \gls{path} is in distortion mode.
This has four round controls that are initially located at each
corner of the path's \gls{bbox}. These controls can be moved to
distort the path.  Note that this modifies the location of the
path's \glspl{controlpt}. The stroke attributes, such as the line
width, aren't modified. Once you have finished distorting the shape,
uncheck the \menu{transform.distort} menu item (or the
button on the horizontal \gls{toolbar}) or click
anywhere outside the (original) bounding box.

For example, \figureref{fig:distortpatha} shows a circle in 
\editpathmode. In \figureref{fig:distortpathb}, the \editpathmode\ is now off and
the circle is selected. In \figureref{fig:distortpathc}, the
distortion mode has now been switched on. The round distortion
controls are initialised to each corner of the \gls{bbox}. The
controls that define the path aren't visible. (Note that the
\hyperref[sec:graphics]{rendering hints} have been set to speed
and no anti-aliasing while in distortion mode.)

In \figureref{fig:distortpathd}, three of the round distortion
controls have been moved. The original bounding box is still
visible, even though it no longer encompasses the distorted shape.
In \figureref{fig:distortpathe}, the distortion mode has been
switched off and normal select mode has resumed. The modified path
is now showing with its new \gls{bbox}. The distortion moved the
path's \glspl{controlpt}, as can be seen when the path is put back into
\editpathmode\ in \figureref{fig:distortpathf}. If this path is
returned to distortion mode, the distortion controls will be reinitialised to
the corners of the new bounding box. You can't invert the distortion
to restore the path to its original shape.

\FloatSubFigs{fig:distortpath}
{
  {fig:distortpatha}{\includeimg{distortpatha}}{},
  {fig:distortpathb}{\includeimg{distortpathb}}{},
  {fig:distortpathc}{\includeimg{distortpathc}}{},
  {fig:distortpathd}{\includeimg{distortpathd}}{},
  {fig:distortpathe}{\includeimg{distortpathe}}{},
  {fig:distortpathf}{\includeimg{distortpathf}}{}
}
[Distorting a Path]
{Distorting a Path: 
\subfigref{fig:distortpatha} original path in edit mode;
\subfigref{fig:distortpathb} original path selected;
\subfigref{fig:distortpathc} distortion mode on;
\subfigref{fig:distortpathd} distortion in progress;
\subfigref{fig:distortpathe} distorted shape (distortion mode off);
\subfigref{fig:distortpathf} distorted shape in edit mode.}

\section{Converting a Path or Text-Path into a Pattern}\label{sec:patterns}

\menudef{menu.transform.pattern}
Patterns can be created, modified or removed with the
\menu{transform.pattern} sub menu. The following pattern types
are available:
\begin{deflist}
\itemtitle{\glslink{rotationalpattern}{Rotational}}

\begin{itemdesc}
The replicates will be rotated around the original
shape. For example, if you specify an angle of \degrees{90} and 4
replicas, the first replicate with be created by rotating a copy of
the original by \degrees{90}, the second replicate by \degrees{180},
the third by \degrees{270} and the fourth replicate by
\degrees{360}, which will superimpose it over the original.
In this case, the fourth replicate is redundant if the original path
is shown, so it would be better to set the number of replicas to 3.

The point of rotation is initially set to the \manmsg{centre} of the original
shape, but can be moved to a different location when the shape is in
\editpathmode. (See \figureref{fig:patternrot}.)

\end{itemdesc}

\itemtitle{\glslink{scaledpattern}{Scaled}}

\begin{itemdesc}
The replicates will be scaled versions of the original
shape. There are two \glspl{controlpt} that govern the pattern: the
anchor, which can be freely moved, and the offset, which is
constrained to lie along the scaling axis. (See
\figureref{fig:patternscale}.)
\end{itemdesc}

\itemtitle{\glslink{spiralpattern}{Spiral}}

\begin{itemdesc}
The replicates will be placed in a spiral around the
original with the given incremental angle. There are again two
\glspl{controlpt} that govern the pattern: the anchor and offset,
which can both be moved freely. (See \figureref{fig:patternspiral}.)
\end{itemdesc}

\end{deflist}

\FloatSubFigs{fig:patternrot}
{
  {fig:patternrota}{\includeimg{patternrota}}{},
  {fig:patternrotb}{\includeimg{patternrotb}}{},
  {fig:patternrotc}{\includeimg{patternrotc}}{},
  {fig:patternrotd}{\includeimg{patternrotd}}{}
}
[A Rotational Pattern]
{A rotational pattern: 
\subfigref{fig:patternrota} original path; 
\subfigref{fig:patternrotb} the path 
in \subfigref{fig:patternrota} has a rotational pattern applied with 3~replicas, 
\degrees{90} angle of rotation, with the original path visible; 
\subfigref{fig:patternrotc} the pattern 
in \subfigref{fig:patternrotb} in edit path mode:
the green control indicates the point of rotation;
\subfigref{fig:patternrotd} the
point of rotation has been move to the right, changing the shape of
the pattern.}

\FloatSubFigs*{fig:patternscale}
{
  {fig:patternscalea}{\includeimg{patternscalea}}{},
  {fig:patternscaleb}{\includeimg{patternscaleb}}{},
  {fig:patternscalec}{\includeimg{patternscalec}}{}
}
[A Scaled Pattern]
{A scaled pattern. The original path is the same as in
\figureref{fig:patternrota}:
\subfigref{fig:patternscalea} the path has a scaled pattern applied with two replicas, 
the horizontal scale factor set to 2 and the vertical scale factor 
set to 1.5;
\subfigref{fig:patternscaleb} the pattern 
in \subfigref{fig:patternscalea} in edit path mode: the green control is
the anchor and the cyan control is the offset;
\subfigref{fig:patternscalec} the anchor has been moved to the left.}

\FloatSubFigs*{fig:patternspiral}
{
  {fig:patternspirala}{\includeimg{patternspirala}}{},
  {fig:patternspiralb}{\includeimg{patternspiralb}}{},
  {fig:patternspiralc}{\includeimg{patternspiralc}}{}
}
[A Spiral Pattern]
{A spiral pattern. The original path is the same as in
\figureref{fig:patternrota}:
\subfigref{fig:patternspirala} the path has a
spiral pattern applied with ten replicas, the increment angle set
to \degrees{60} and a gap of 50bp; 
\subfigref{fig:patternspiralb} the pattern 
in \subfigref{fig:patternspirala} in edit path mode: the green control is
the anchor and the cyan control is the offset;
\subfigref{fig:patternspiralc} the anchor has been moved down.}

\menudef{menu.transform.pattern.set}

A \gls{path} or \gls{textpath} can be converted into a pattern using
the \menu{transform.pattern.set} menu item. First \select\ the
required \gls{path} or \gls{textpath} (ensure that nothing else is
selected) and use the \menu{transform.pattern.set} menu item to open
the \dialog{pattern} dialog.

\menudef{menu.transform.pattern.edit}

An existing \gls{pattern} can be edited with the \menu{transform.pattern.edit}
menu item. First \select\ the required pattern (ensure that nothing else is
selected) and use the \menu{transform.pattern.edit} menu item to open
the \dialog{pattern} dialog where you can adjust the pattern
parameters.

\menudef{menu.transform.pattern.remove}

If you want to remove the pattern specifications, \select\ the
required pattern (ensure that nothing else is selected) and use the
\menu{transform.pattern.remove} menu item.  This will replace the
selected \gls{pattern} with its underlying path.

\widgetdef{pattern.title}

The \dialog{pattern} dialog allows you to set up (or edit) the pattern
specifications (see \figureref{fig:patterndialog}).

\FloatSubFigs{fig:patterndialog}
{
  {fig:patterndialog-rotational}{\includeimg{patterndialog-rotational}}{},
  {fig:patterndialog-scaled}{\includeimg{patterndialog-scaled}}{},
  {fig:patterndialog-spiral}{\includeimg{patterndialog-spiral}}{}
}
[Pattern Dialog]
{Pattern dialog:
\subfigref{fig:patterndialog-rotational} rotational tab;
\subfigref{fig:patterndialog-scaled} scaled tab;
\subfigref{fig:patterndialog-spiral} spiral tab.}

\widgetdef{pattern.replicas}

Specify the number of replicates in the \widget{pattern.replicas} field.

\widgetdef{pattern.show_original}

Toggle the  \widget{pattern.show_original} checkbox to set whether
or not the original \gls*{path} or \gls*{textpath} should be
displayed. For example, if you specify 4 replicates and show the
original, there will be 5 versions of the shape: the original and
the 4 replicas.

\widgetdef{pattern.rotational}

For a \gls{rotationalpattern}, select the
\widget{pattern.rotational} tab in which you can specify the degrees
of rotation in the \inlineglsdef{pattern.rotate} field.

\widgetdef{pattern.scaled}

For a \gls{scaledpattern}, select the \widget{pattern.scaled} tab
in which you can enter the horizontal scaling in the
\inlineglsdef{pattern.scale.x} field and the vertical scaling in 
the \inlineglsdef{pattern.scale.y} field.
Either scale factor may be negative but neither may be zero.

\widgetdef{pattern.spiral}

For a \gls{spiralpattern}, select the \widget{pattern.spiral} tab.
This also has a \widget{pattern.rotate} field, as for the
\widget{pattern.rotational} tab, but the \widget{pattern.spiral} tab
also has the \inlineglsdef{pattern.spiral.distance} field.

\widgetdef{pattern.mode}

All patterns have two modes:
\begin{deflist}
\itemtitle{\inlineglsdef{pattern.mode.single}}
\begin{itemdesc}
The pattern is drawn as a single path (see \figureref{fig:patternmodeb}).
Select \widget{pattern.mode.single} for single mode.
\end{itemdesc}

\itemtitle{\inlineglsdef{pattern.mode.multi}}
\begin{itemdesc}
The original (if shown) and each replicate are drawn as 
independent shapes (see \figureref{fig:patternmodec}).
Select \widget{pattern.mode.multi} for multi mode.
\end{itemdesc}

\end{deflist}

\FloatSubFigs*{fig:patternmode}
{
  {fig:patternmodea}{\includeimg{patternmodea}}{},
  {fig:patternmodeb}{\includeimg{patternmodeb}}{},
  {fig:patternmodec}{\includeimg{patternmodec}}{}
}
[Single vs Multi-Mode Patterns]
{Single vs multi-mode patterns:
\subfigref{fig:patternmodea} original path
has a bar start marker, a triangle end-marker and a gradient fill paint;
\subfigref{fig:patternmodeb} the path in \subfigref{fig:patternmodea} has
a rotational pattern applied with single mode set;
\subfigref{fig:patternmodec} the same pattern 
as \subfigref{fig:patternmodeb} but with multi-mode.}

Note that a \gls{textpath} created by applying text to a multi-mode
pattern produces a different result to applying the same multi-mode
pattern to a \gls{textpath}. (See \figureref{fig:patterntextpath}.)

\FloatSubFigs{fig:patterntextpath}
{
  {fig:patterntextpatha}{\includeimg{patterntextpatha}}{},
  {fig:patterntextpathb}{\includeimg{patterntextpathb}}{},
  {fig:patterntextpathc}{\includeimg{patterntextpathc}}{},
  {fig:patterntextpathd}{\includeimg{patterntextpathd}}{},
  {fig:patterntextpathe}{\includeimg{patterntextpathe}}{},
  {fig:patterntextpathf}{\includeimg{patterntextpathf}}{}
}
[Text-Path Patterns]
{Text-path multi-mode patterns:
\subfigref{fig:patterntextpatha} original text area and path;
\subfigref{fig:patterntextpathb} text area and path in
\subfigref{fig:patterntextpatha} combined to form a text-path;
\subfigref{fig:patterntextpathc} a scaled
multi-mode pattern is applied to the text-path with 2 replicas and scale
factors 2.0 and 1.5;
\subfigref{fig:patterntextpathd} the path in \subfigref{fig:patterntextpatha} has
the same scaled multi-mode pattern applied;
\subfigref{fig:patterntextpathe} the text area and
pattern in \subfigref{fig:patterntextpathd} have been combined to form a
text-path;
\subfigref{fig:patterntextpathf} the pattern in \subfigref{fig:patterntextpathb} has
been changed from multi-mode to single-mode.}

\seealsorefs{
  sec:textpath,
  sec:rosetutorial
}

\section{Separating Compound Shapes}\label{sec:separate}

\menudef{menu.transform.separate}

\Glspl{compositeshape} can be separated into its constituent parts
according to their type using the \menu{transform.separate} menu
item.  For example, in \figureref{fig:separatepatterna} a
\gls{rotationalpattern} with four replicas has been selected. In
\figureref{fig:separatepatternb} the pattern is shown in
\editpathmode\ for illustration. This mode needs to be switched off
to separate the component parts. The \transformfn{separate} function
was then used to replace the original selected \gls{pattern} with a
group containing the original path and each of the four replicas as
separate \glspl{path}. The group was then ungrouped
(\figureref{fig:separatepatternc}).

\FloatSubFigs{fig:separatepattern}
{
  {fig:separatepatterna}{\includeimg{separatepatterna}}{},
  {fig:separatepatternb}{\includeimg{separatepatternb}}{},
  {fig:separatepatternc}{\includeimg{separatepatternc}}{}
}
[Separating a Pattern]
{Separating a pattern:
\subfigref{fig:separatepatterna} selected pattern with four
replicas;
\subfigref{fig:separatepatternb} the pattern in \subfigref{fig:separatepatterna}
is shown in edit path mode to show the underlying path;
\subfigref{fig:separatepatternc} the pattern in \subfigref{fig:separatepatterna}
was separated into a group of paths and then ungrouped.}

A \gls{textpath} can similarly be separated into a group containing the
\gls{textarea} and \gls{path} that made up the \gls*{textpath}.
Note that any line styles that were applied to the path before
combining it with the text area will be lost, and the resulting
path will use the default styles with the \gls{index.line-colour} the same
as the \gls{index.text-colour} from the \gls*{textpath}.

For example, in \figureref{fig:separate} the \gls*{textarea} and
\gls*{path} in \figureref{fig:separatea} are combined to
form the \gls*{textpath} in \figureref{fig:separateb}. The
\gls*{textpath} is the separated into a group containing a
\gls*{textarea} and a \gls*{path}. Note that the new path has
lost the line style shown in \figureref{fig:separatea}
and is now the same \manmsg{colour} as the text.

\FloatSubFigs*{fig:separate}
{
  {fig:separatea}{\includeimg{separatea}}{},
  {fig:separateb}{\includeimg{separateb}}{},
  {fig:separatec}{\includeimg{separatec}}{}
}
[Separating the Text and Path from a Text-Path]
{Separating the text and path from a text-path: 
\subfigref{fig:separatea} original path and text area;
\subfigref{fig:separateb} path and text area 
in \subfigref{fig:separatea} combined to form a text-path;
\subfigref{fig:separatec} text-path 
in \subfigref{fig:separateb} separated into
a group containing a text area and a path.}

You may have noticed from \figureref{fig:separate} that the 
\pathattr{fill-paint} has been retained. This is because it may be needed if the
\textattr{outline} mode is on.  If a non-outline \gls{textpath} is switched to
\textattr{outline} mode with a filled interior, that \manmsg{colour} will be applied
to the new \gls{path}, as illustrated in \figureref{fig:separateoutline}.

\FloatSubFigs*{fig:separateoutline}
{
  {fig:separateoutlinea}{\includeimg{separateoutlinea}}{},
  {fig:separateoutlineb}{\includeimg{separateoutlineb}}{},
  {fig:separateoutlinec}{\includeimg{separateoutlinec}}{},
}
[Separating the Text and Path from an Outline Text-Path]
{Separating the text and path from an outline text-path: 
\subfigref{fig:separateoutlinea} original path and
outline text area;
\subfigref{fig:separateoutlineb} path and outline text area 
in \subfigref{fig:separateoutlinea} combined to
form an outline text-path;
\subfigref{fig:separateoutlinec} outline text-path in 
\subfigref{fig:separateoutlineb} separated into
a group containing an outline text area and a path.}

\seealsorefs{
 sec:textpath,
 sec:splittext,
 sec:converttofullpath,
 sec:outlinetopath
}

\section{Converting a Composite Shape to a Full Path}\label{sec:converttofullpath}

\menudef{menu.transform.convert_to_full}

A \gls{compositeshape} may be converted into a normal path with the
\menu{transform.convert_to_full} menu item.  For example,
\figureref{fig:convertpatterntofullpatha} shows a
\gls{rotationalpattern} with 6\gls{bp} \pathattr{line-width}, black
\pathattr{line-paint} and orchid \pathattr{fill-paint}.  This
pattern is shown in \editpathmode\ in
\figureref{fig:convertpatterntofullpathb}. Note that only the
underlying path's \glspl{controlpt} and the pattern
\gls{pattern.anchor} are visible. (The \editpathmode\ will then need
to be switched off.) The \transformfn{convert_to_full} function was
then used convert the \gls{pattern} info a complete \gls{path}
(\figureref{fig:convertpatterntofullpathc}).  Note that's no
noticeable difference to the way the \gls{shape} is drawn on the
\gls{canvas}. However, if \editpathmode\ is switched on again
(\figureref{fig:convertpatterntofullpathd}) it now becomes clear
that the shape is no longer a \gls{pattern}. All \glspl{controlpt}
are now showing and there's no \gls{pattern.anchor} control.

\FloatSubFigs{fig:convertpatterntofullpath}
{
  {fig:convertpatterntofullpatha}{\includeimg{convertpatterntofullpatha}}{},
  {fig:convertpatterntofullpathb}{\includeimg{convertpatterntofullpathb}}{},
  {fig:convertpatterntofullpathc}{\includeimg{convertpatterntofullpathc}}{},
  {fig:convertpatterntofullpathd}{\includeimg{convertpatterntofullpathd}}{}
}
[Converting a Pattern to a Full Path]
{Converting a pattern to a full path:
\subfigref{fig:convertpatterntofullpatha} a rotational pattern;
\subfigref{fig:convertpatterntofullpathb} the rotational pattern in
path edit mode; 
\subfigref{fig:convertpatterntofullpathc} the rotational pattern
in \subfigref{fig:convertpatterntofullpatha} has been converted to a
full path;
\subfigref{fig:convertpatterntofullpathd} the path
in \subfigref{fig:convertpatterntofullpathc} showing in edit 
path mode.}

\section{Converting an Outline to a Path}\label{sec:outlinetopath}

\menudef{menu.transform.convert}

The stroked outline of a \gls{shape}, \gls{textarea} or
\gls{textpath} may be converted to a filled path
with the \menu{transform.convert} menu item.
First \select\ the required \glspl{shape}, \glspl{textarea} or
\glspl{textpath}. The selection should not include any \glspl{group}
or \glspl{bitmap}. Then use the \menu{transform.convert} menu item.

Any \gls{shape} will be converted into a \gls{path} with 1\gls{bp}
line width that traces around the original stroked path. The new
path will be filled with the original \pathattr{line-paint} and
will have no \pathattr{line-paint}. The original
\pathattr{fill-paint} will be discarded.

For example, consider the path in \figureref{fig:outlinetopatha}.
This has a line width of 10\gls{bp}, a circle start marker,
a triangle end arrow, a gradient \pathattr{line-paint} and a yellow
\pathattr{fill-paint}. \figureref{fig:outlinetopathb} shows this
path in \editpathmode\ to show the path's defining \glspl{controlpt}. In
\figureref{fig:outlinetopathc}, the path's outline
has been converted to a path. This new path now has
a gradient \pathattr{fill-paint} with a line width of 1\gls{bp} and
no start or end arrows. The new path's defining
control points are shown in \figureref{fig:outlinetopathd}.

\FloatSubFigs{fig:outlinetopath}
{
  {fig:outlinetopatha}{\includeimg{outline2patha}}{},
  {fig:outlinetopathb}{\includeimg{outline2pathb}}{},
  {fig:outlinetopathc}{\includeimg{outline2pathc}}{},
  {fig:outlinetopathd}{\includeimg{outline2pathd}}{}
}
[Converting an Outline to a Path]
{Converting an outline to a path:
\subfigref{fig:outlinetopatha} the original path;
\subfigref{fig:outlinetopathb} the original path's defining control points;
\subfigref{fig:outlinetopathc} the new path;
\subfigref{fig:outlinetopathd} the new path's defining control points.}

Any selected \gls{pattern} will have its underlying path
converted to an outline. For example, the \gls{pattern}
from \figureref{fig:convertpatterntofullpatha} (reshown in
\figureref{fig:convertpatterntooutlinea}) has instead been
converted into an outline with the \transformfn{convert} function
(\figureref{fig:convertpatterntooutlineb}). The original orchid
\pathattr{fill-paint} has been discarded. The new
\pathattr{fill-paint} is now the original \pathattr{line-paint}
(black). The new \pathattr{line-paint} is now set to \gls{transparent}
(that is the outline isn't drawn). Switching to \editpathmode\
(\figureref{fig:convertpatterntooutlinec}) shows the new underlying
path that draws around the original stroked path. Note that the
\gls{shape} is still a \gls{pattern} and still has the pattern
\gls{pattern.anchor} in the same place (see \figureref{fig:convertpatterntofullpathb}).

\FloatSubFigs*{fig:convertpatterntooutline}
{
  {fig:convertpatterntooutlinea}{\includeimg{convertpatterntofullpatha}}{},
  {fig:convertpatterntooutlineb}{\includeimg{convertpatterntooutlineb}}{},
  {fig:convertpatterntooutlinec}{\includeimg{convertpatterntooutlinec}}{}
}
[Converting a Pattern Outline to a Path]
{Converting a pattern outline to a path:
\subfigref{fig:convertpatterntooutlinea} the original pattern (as
\figureref{fig:convertpatterntofullpatha});
\subfigref{fig:convertpatterntooutlineb} the pattern
in \subfigref{fig:convertpatterntooutlinea} has been converted to an
outline;
\subfigref{fig:convertpatterntooutlinec} the pattern
in \subfigref{fig:convertpatterntooutlineb} showing in edit path
mode.} 

Any selected \gls{textarea} or \gls{textpath} will be replaced with
a \gls{group} of \glspl{path} with 1\gls{bp} line width that trace
around the approximate shape of the original characters. These new
\glspl{path} will be filled with the original
\gls{index.text-colour} and will have no \gls{index.line-colour}.
Converting a \gls*{textarea} or \gls*{textpath} to a path allows you to:
\begin{itemize}
\item include the image in \LaTeX\ document when you don't have the
equivalent \LaTeX\ font;

\item make a \gls{parshape} or \gls{shapepar}
from the text's outline.
\end{itemize}

\begin{information}
Unlike the text \textattr{outline} mode, it's no longer possible to
edit the text once its outline has been converted to a path.
\end{information}

You will have to \hyperref[sec:grouping]{ungroup} the
\glspl*{path} before you can apply any functions that require
individual \glspl{shape} and not \glspl{group} to be selected.  If you
had a gradient paint \gls{index.text-colour} the gradient will be
applied to each \gls*{path}. You can however,
\hyperref[sec:mergepaths]{merge} the \glspl*{path}, which will apply
a single gradient resembling the original \gls*{textarea} (see
\figureref{fig:converttopath}).

\FloatSubFigs{fig:converttopath}
{
  {fig:converttopatha}{\includeimg{text2patha}}{},
  {fig:converttopathb}{\includeimg{text2pathb}}{},
  {fig:converttopathc}{\includeimg{text2pathc}}{}
}
[Converting a Text Area to a Path]
{Converting a text area to a path:
\subfigref{fig:converttopatha} original text area;
\subfigref{fig:converttopathb} converted to a path;
\subfigref{fig:converttopathc} ungroup and merge paths.}

\seealsorefs{
 sec:patterns,
 sec:separate,
 sec:textoutline
}


\chapter{Path and Text Styles}\label{sec:styles}

The way a \gls{shape} is displayed is governed by the 
\pathattr{line-paint}, the \pathattr{fill-paint}, the 
\gls{line-style} and the \pathattr{winding-rule}. 
The way a \gls{textarea} is displayed is governed by the
\gls{index.text-colour}, \gls{font}, \textattr{transformation-matrix} 
and (if \hyperref[sec:exportimage]{exporting} to a \LaTeX\ file) the
\textattr{anchor}. The way a \gls{textpath} is displayed is governed
by the \gls{index.text-colour}, \gls{font}, \textattr{anchor},
\textattr{transformation-matrix} and the underlying path. (A
\gls*{textarea} or \gls*{textpath} may also be rendered as an
\textattr{outline} optionally with a \textattr{fill-paint}, see
\sectionref{sec:textoutline}.)

\menudef{menu.settings.styles}

The current path and text styles can be set using the
\menu{settings.styles} menu item which opens the \dialog{styles}
dialog. These styles will be used for any new \glspl{object} that
are subsequently created. Existing \glspl{object} can have their
styles altered via the \menu{edit.path} and \menu{edit.textarea}
sub-menus. 

\widgetdef{styles.title}

The \dialog{styles} dialog box has a tabbed pane with five tabs,
which may be used to change the current path and text styles.
Note that changing the current path or text styles won't affect
existing \glspl{object}. 

There is a sample panel on the right hand side illustrating the
effects of the \gls{path} settings you choose, and a sample panel along
the top illustrating the effects of the \gls*{textarea} attributes
you choose.

The current styles are saved when you exit \FlowframTk, and will be in
effect next time you use \FlowframTk, unless you change the 
\widget{initsettings.title} settings in the \dialog{config} dialog
(see \sectionref{sec:initsettings}).

The \dialog{styles} dialog has the following tabs:
\begin{deflist}
\itemtitle{\widget{linepaintselector.title}}
\begin{itemdesc}
Specifies the current \pathattr{line-paint} (see
\sectionref{sec:linepaint}).
\end{itemdesc}

\itemtitle{\widget{fillpaintselector.title}}
\begin{itemdesc}
Specifies the current \pathattr{fill-paint} (see
\sectionref{sec:fillpaint}).
\end{itemdesc}

\itemtitle{\widget{linestyle.title}}
\begin{itemdesc}
Specifies the current \gls{line-style} (see
\sectionref{sec:pathstyle}).
\end{itemdesc}

\itemtitle{\widget{textpaintselector.title}}
\begin{itemdesc}
Specifies the current \gls{index.text-colour} (see
\sectionref{sec:textpaint}).
\end{itemdesc}

\itemtitle{\widget{font.title}}
\begin{itemdesc}
Specifies the current \gls{font} and \textattrpl{anchor} (see
\sectionref{sec:textstyle}).
\end{itemdesc}

\end{deflist}

The \gls{button.default} button located at the bottom right corner
of the dialog box may be used to restore the default settings.

\section{Line Paint}\label{sec:linepaint}

\menudef{menu.edit.path.line_colour}

The \menu{edit.path.line_colour} menu item opens a dialog
with a \widget{linepaintselector.title} panel in which
you can change the \inlineglsdef{index.path-attribute.line-paint} 
of all \selected\ \glspl{shape}.

\widgetdef{linepaintselector.title}

The \widget{linepaintselector.title} panel has a \dialog{paintselector} panel
(see \sectionref{sec:paint}) that may be used to set the 
\pathattr{line-paint}. This panel is also a tab
in the \dialog{styles} dialog to set the current
\pathattr{line-paint}.
The default \pathattr{line-paint} is black.

Selecting the \widget{paintselector.transparent} radio button indicates
that \gls{shape} outlines should not be drawn.  (The \pathattr{fill-paint}
will need to be set to something other than
\widget{paintselector.transparent} in order for the \glspl{shape} to be
visible.)

There is a sample panel along the top (\menu{edit.path.line_colour})
or the side (\menu{settings.styles}) illustrating the
effects of the \pathattr{line-paint} setting that you choose

\section{Fill Paint}\label{sec:fillpaint}

\menudef{menu.edit.fill_colour}

The \menu{edit.fill_colour} menu item opens a dialog with a
\widget{fillpaintselector.title} panel in which you can change the
\inlineglsdef{index.path-attribute.fill-paint} of all \selected\
\glspl{shape}. The \pathattr{fill-paint} is also used to fill
\glspl{textarea} or \glspl{textpath} in \textattr{outline} mode. 

\widgetdef{fillpaintselector.title}

The \widget{fillpaintselector.title} panel has a \dialog{paintselector} panel (see
\sectionref{sec:paint}) that may be used to set the
\pathattr{fill-paint}. This panel is also a tab in the
\dialog{styles} dialog to set the current \pathattr{fill-paint}.

The default \pathattr{fill-paint} is \gls{transparent} which indicates
that \glspl{shape} should not be filled.  (The \pathattr{line-paint}
will need to be set to something other than
\widget{paintselector.transparent} in order for the \glspl{shape} to be
visible.)

There is a sample panel along the top (\menu{edit.fill_colour})
or the side (\menu{settings.styles}) illustrating the
effects of the \pathattr{fill-paint} setting that you choose

\seealsorefs{sec:houseexample}

\section{Line Style}\label{sec:pathstyle}

\menudef{menu.edit.path.style.all_styles}

The \menu{edit.path.style.all_styles} menu item opens a dialog
with a \widget{linestyle.title} panel in which
you can change the \inlineglsdef{line-style} 
of all \selected\ \glspl{shape}.

\widgetdef{linestyle.title}

The \widget{linestyle.title} panel is also a tab
in the \dialog{styles} dialog to set the current
\gls{line-style}. The panel has the following areas:
\begin{deflist}
\itemtitle{\widget{linestyle.thickness}}
\begin{itemdesc}
Specifies the \pathattr{line-width} (\sectionref{sec:penwidth}).
\end{itemdesc}

\itemtitle{\widget{linestyle.solid}\slash\widget{linestyle.dashed}}
\begin{itemdesc}
Specifies whether the line is \gls{solid-line} or a \pathattr{dash-pattern}
(\sectionref{sec:dashpattern}).
\end{itemdesc}

\itemtitle{\widget{linestyle.cap}}
\begin{itemdesc}
Specifies the \pathattr{cap-style} (see \sectionref{sec:capstyle}).
\end{itemdesc}

\itemtitle{\widget{linestyle.join}}
\begin{itemdesc}
Specifies the \pathattr{join-style} (\sectionref{sec:joinstyle}).
\end{itemdesc}

\itemtitle{\widget{linestyle.arrow.start}}
\begin{itemdesc}
Specifies the start \pathattr{marker} (\sectionref{sec:markers}).
\end{itemdesc}

\itemtitle{\widget{linestyle.arrow.mid}}
\begin{itemdesc}
Specifies the mid \pathattr{marker} (\sectionref{sec:markers}).
\end{itemdesc}

\itemtitle{\widget{linestyle.arrow.end}}
\begin{itemdesc}
Specifies the end \pathattr{marker} (\sectionref{sec:markers}).
\end{itemdesc}

\itemtitle{\widget{linestyle.winding_rule}}
\begin{itemdesc}
Specifies the \pathattr{winding-rule} (\sectionref{sec:winding}).
\end{itemdesc}

\end{deflist}

There is a sample panel along the top (\menu{edit.path.style.all_styles})
or the side (\menu{settings.styles}) illustrating the
effects of the \gls{path} settings you choose

\begin{information}
The line styles are only applicable when the \gls{shape}
outline is \glslink{drawing-on-canvas}{drawn}. (That is, when 
the \pathattr{line-paint} is not set to \gls{transparent}.)
\end{information}

\subsection{Line Thickness (or Pen Width)}\label{sec:penwidth}

\menudef{menu.edit.path.style.linewidth}

The \menu{edit.path.style.linewidth} menu item opens a dialog
with a \widget{linestyle.thickness} panel in which
you can change the \inlineglsdef{index.path-attribute.line-width} 
of all \selected\ \glspl{shape}.

\widgetdef{linestyle.thickness}

The \widget{linestyle.thickness} panel is also in the 
\widget{linestyle.title} panel. The value is a length so it needs
both a positive decimal number and a unit. The default is 1\gls{bp}.

\begin{information}
The \pathattr{line-width} is only applicable when the \gls{shape}
outline is \glslink{drawing-on-canvas}{drawn}. (That is, when 
the \pathattr{line-paint} is not set to \gls{transparent}.)
\end{information}

\subsection{Dash Pattern}\label{sec:dashpattern}

\menudef{menu.edit.path.style.dashpattern}

The \menu{edit.path.style.dashpattern} menu item opens a dialog
with a \widget{dashpattern.title} panel in which
you can change the \inlineglsdef{index.path-attribute.dash-pattern} 
of all \selected\ \glspl{shape}.

\widgetdef{dashpattern.title}

The \widget{dashpattern.title} panel is also in the 
\widget{linestyle.title} panel. There are two radio buttons.

\widgetdef{linestyle.solid}

Select the \widget{linestyle.solid} radio button for a 
\inlineglsdef{solid-line} line.

\widgetdef{linestyle.dashed}

Select the \widget{linestyle.dashed} radio button for a
\pathattr{dash-pattern}. This will enable the \pathattr{dash-pattern}
parameters.

\widgetdef{dashpattern.dash.offset}

The \widget{dashpattern.dash.offset} is the length along the outline from the
\gls{path}['s] starting point at which the dash pattern should begin.

\widgetdef{dashpattern.dash.length}

The \widget{dashpattern.dash.length} is the length of each dash.

\widgetdef{dashpattern.dash.gap}

The \widget{dashpattern.dash.gap} is the length of the gap between
each pair of dashes.

\widgetdef{dashpattern.dash.secondary}

If the \widget{dashpattern.dash.secondary} checkbox is selected, 
a secondary dash can be specified. The dash pattern will alternate
between the primary and secondary dashes. This can be used to obtain
a dash-dot pattern.

For example, in \figureref{fig:dash} path \subfigurefmt{a} has a
solid line; path \subfigurefmt{b} has a \pathattr{dash-pattern} with
an offset of 0\gls{bp}, dash length of 10\gls{bp} and gap length of
5\gls{bp}; path \subfigurefmt{c} is the same as path
\subfigurefmt{b} except that the \pathattr{dash-pattern} has an
offset of 10\gls{bp}; path \subfigurefmt{d} has no offset, a primary
pair of dash length 10\gls{bp} and gap length 5\gls{bp}, and a
secondary pair of dash length 1\gls{bp} and gap length 5\gls{bp}
which gives a dash-dot pattern.

\FloatFig{fig:dash}
{\includeimg{dashpatterns}}
[Example Dash Patterns]
{Example dash patterns: \subfigurefmt{a}
solid line; \subfigurefmt{b} dash length 10bp and gap length 5bp;
\subfigurefmt{c} dash length 10bp, gap length 5bp and 10bp offset;
\subfigurefmt{d} primary dash length 10bp with gap length 5bp and
secondary dash length 1bp with gap length 5bp.}

\begin{information}
If you have a thick \pathattr{line-width} with a non-butt cap, the
gaps between the dashes may be obscured as the cap will be applied
to each dash. If you need a cap on either end but not on the dashes,
use a cap style start and end \pathattr{marker} instead.
\end{information}


\subsection{Cap Style}\label{sec:capstyle}

\menudef{menu.edit.path.style.capstyle}

The \inlineglsdef{index.path-attribute.cap-style} for a \selected\
path can either be set in the \menu{edit.path.style.capstyle} sub
menu or in the \inlineglsdef{linestyle.cap} \gls{dropdown} in the
\widget{linestyle.title} panel. The cap styles are more noticeable
with thick lines.

\menudef{menu.edit.path.style.capstyle.butt}

A butt cap is flush with the start and end of the \gls{path}.

\menudef{menu.edit.path.style.capstyle.round}

A round cap protrudes from the start and end of the \gls{path}.

\menudef{menu.edit.path.style.capstyle.square}

A square cap protrudes from the start and end of the \gls{path}.

\FloatFig{fig:capstyles}
{\includeimg{capstyle}}
[Cap Styles]
{Cap styles: \subfigurefmt{a} butt, \subfigurefmt{b} round,
\subfigurefmt{c} square.  Note that the round and square caps protrude from
the start and end vertices.}

\begin{information}
The cap is affected by whether the \gls{path} is open or closed. In
\figureref{fig:capopena} the path is an open path where the end
points happen to coincide; in \figureref{fig:capopenb} the path is a
closed path.
\end{information}

\FloatSubFigs{fig:capopen}
{
 {fig:capopena}{\includeimg{capopen}}{},
 {fig:capopenb}{\includeimg{capclosed}}{}
}
[The Cap Style Is Affected by Whether the Path Is Open or Closed]
{The cap style is affected by whether the path is open or
closed:
\subfigref{fig:capopena} butt cap applied to an open path;
\subfigref{fig:capopenb} butt cap applied to a closed path.}

\seealsorefs{sec:markers}

\subsection{Join Style}\label{sec:joinstyle}

\menudef{menu.edit.path.style.joinstyle}

The \menu{edit.path.style.joinstyle} menu item opens a dialog
with a \widget{linestyle.join} panel in which
you can change the \inlineglsdef{index.path-attribute.join-style} 
of all \selected\ \glspl{shape}.

\widgetdef{linestyle.join}

The \widget{linestyle.join} panel is also in the 
\widget{linestyle.title} panel. Use the \gls{dropdown} to select the
\pathattr{join-style}, which may be one of:
\inlineglsdef{linestyle.join.mitre}
(for a \inlineglsdef{index.path-attribute.join-style.mitre} join, see
\figureref{fig:joinstyles-mitre}),
\inlineglsdef{linestyle.join.round}
(for a \inlineglsdef{index.path-attribute.join-style.round} join, see
\figureref{fig:joinstyles-round}), or
\inlineglsdef{linestyle.join.bevel}
(for a \inlineglsdef{index.path-attribute.join-style.bevel} join, see
\figureref{fig:joinstyles-bevel}).

\widgetdef{linestyle.mitre_limit}

If \widget{linestyle.join.mitre} is selected, the \widget{linestyle.mitre_limit}
field will be enabled. The value must be greater than or equal to
1.0.

\FloatSubFigs{fig:joinstyles}
{
   {fig:joinstyles-mitre}{\includeimg{joinMitre}}{},
   {fig:joinstyles-round}{\includeimg{joinRound}}{},
   {fig:joinstyles-bevel}{\includeimg{joinBevel}}{}
}
[Join Styles]
{Join styles:
\subfigref{fig:joinstyles-mitre} \pathattr{join-style.mitre};
\subfigref{fig:joinstyles-round} \pathattr{join-style.round};
\subfigref{fig:joinstyles-bevel} \pathattr{join-style.bevel}.}

\subsection{Winding Rule}\label{sec:winding}

The \inlineglsdef{index.path-attribute.winding-rule} describes how a \gls{path} is
filled (if it has a \pathattr{fill-paint}). The
\pathattr{winding-rule} can be either
even-odd or non-zero. \figureref{fig:windingrule} illustrates the
difference between the two winding rules. A \gls*{path} was constructed
with a \gls{gap} between the outer and inner rectangles.
\figureref{fig:windingrulea} shows the effect using the even-odd
winding rule and \figureref{fig:windingruleb} shows the effect
using the non-zero winding rule. The winding rule is also used when
extracting the parameters for
\gls{parshape} (see \sectionref{sec:parshape}) and
\gls{shapepar} (see \sectionref{sec:shapepar}).

\FloatSubFigs{fig:windingrule}
{
 {fig:windingrulea}{\includeimg{evenodd}}{},
 {fig:windingruleb}{\includeimg{nonzero}}{}
}
[Winding Rules]
{Winding rules (arrows indicate direction of path):
\subfigref{fig:windingrulea} even-odd;
\subfigref{fig:windingruleb} non-zero.}

\menudef{menu.edit.path.style.windingrule}

The \pathattr{winding-rule} for a \selected\ path can either be set
in the \menu{edit.path.style.windingrule} sub menu or in the
\inlineglsdef{linestyle.winding_rule} \gls{dropdown} in the
\widget{linestyle.title} panel.

\menudef{menu.edit.path.style.windingrule.evenodd}

Select \editfn{path.style.windingrule.evenodd} for the even-odd 
\pathattr{winding-rule}.

\menudef{menu.edit.path.style.windingrule.nonzero}

Select \editfn{path.style.windingrule.nonzero} for the non-zero 
\pathattr{winding-rule}.

\seealsorefs{sec:cheeseexample}

\subsection{Markers}\label{sec:markers}

The start, mid and end \inlineglspluraldef{index.marker} are placed on
the start, intermediate points (mid-points) and end vertices, respectively. Some of the
markers require a size, some of them are dependent on the line width
and some of them require a size as well as being dependent on the
line width.

Markers can be specified by clicking on the \widget{button.choose}
button alongside the applicable \widget{linestyle.arrow.start},
\widget{linestyle.arrow.mid} or \widget{linestyle.arrow.end}
row in the \dialog{linestyle} panel (accessed with \menu{edit.path.style.all_styles}
to change the currently \selected\ shapes or with
\menu{settings.styles} to change the current marker styles to apply
to new \glspl{path}).

\menudef{menu.edit.path.style.all_markers}

If you want to set the start, mid and end \glspl{index.marker} to
the same type for currently \selected\ shapes, you can use
\menu{edit.path.style.all_markers} which will open a marker dialog.
When you click on the \widget{button.okay} button, the marker type
will be applied to all the markers on the \selected\ shapes.

Alternatively, you can set the start, mid and end
\glspl{index.marker} for \selected\ shapes separately.

\menudef{menu.edit.path.style.startarrow}

The \menu{edit.path.style.startarrow} will open a dialog with the
marker panel in which you can set the start \dgls{marker} for
all \selected\ shapes. Start markers are automatically reversed as
they are designed to point towards the start.

\menudef{menu.edit.path.style.midarrow}

The \menu{edit.path.style.midarrow} will open a dialog with the
marker panel in which you can set the mid \dgls{marker} for
all \selected\ shapes.

\menudef{menu.edit.path.style.endarrow}

The \menu{edit.path.style.endarrow} will open a dialog with the
marker panel in which you can set the end \dgls{marker} for
all \selected\ shapes.

The \inlineglsdef{arrow.title} panel used in each case has a sample panel along the top
illustrating the selected settings. Below the panel are two
checkboxes:

\widgetdef{arrow.composite}

The \widget{arrow.composite} is only available if secondary marker
is enabled. See \sectionref{sec:compositemarkers}.

\widgetdef{arrow.overlay}

The \widget{arrow.overlay} is only available if secondary marker
is enabled. See \sectionref{sec:compositemarkers}.

Below these checkboxes are the two main tabs:

\widgetdef{arrow.primary}

The \widget{arrow.primary} tab specifies the settings for the
primary marker.

\widgetdef{arrow.secondary}

The \widget{arrow.secondary} tab specifies the settings for the
primary marker. This tab is only available if the primary marker is
set and the \widget{arrow.composite} checkbox is selected.

The \widget{arrow.primary} and \widget{arrow.secondary} panels have
the same layout:
\begin{itemize}
\item Radio buttons to enable or disable the marker.
See \sectionref{sec:enablingmarkers}.

\item The marker \gls{index.marker.type} tabs (only available if the marker is
enabled). See \sectionref{sec:markertypes}.

\item The marker \gls{index.marker.size} (only available if
supported by the selected marker \gls{index.marker.type}).
See \sectionref{sec:markersize}.

\item The \gls{index.marker.repeating} radio buttons.
See \sectionref{sec:repeatingmarkers}.

\item The \widget{arrow.reversed} checkbox.
See \sectionref{sec:reversingmarkers}. 

\item The \widget{arrow.autoorient} checkbox.
See \sectionref{sec:markerorientation}.

\item The \widget{arrow.autooffset} checkbox.
See \sectionref{sec:markeroffset}.

\item The \widget{arrow.autogap} checkbox.
See \sectionref{sec:repeatgap}.

\item The \gls{index.marker.colour} setting.
See \sectionref{sec:markerpaint}.

\end{itemize}

\subsubsection{Enabling or Disabling a Marker}\label{sec:enablingmarkers}

\widgetdef{arrow.usemarker}

To enable a marker, select the \widget{arrow.usemarker}
radio button. This will enable the applicable widgets for the
selected marker (see \sectionref{sec:markertypes}).

\widgetdef{arrow.nomarker}

To disable a marker, select the \widget{arrow.nomarker} radio
button. This will disable all the marker settings.

\subsubsection{Marker Types}\label{sec:markertypes}

Marker \inlineglspluraldef{index.marker.type}
are divided into six categories:

\widgetdef{arrow.tab.arrows}

An arrow marker looks like an arrow head or triangle or hook.
The tips may protrude forward beyond the vertex but mostly they protrude
back from the vertex.
Available arrow markers are listed in \tableref{tab:arrowmarkers}.

\widgetdef{arrow.tab.partial}

A partial marker looks like one half of an arrow marker.
Available partial markers are listed in \tableref{tab:partialmarkers}.

\widgetdef{arrow.tab.data}

Data point style markers are mostly \manmsg{centred} on the applicable
vertex (but can be shifted with an offset).
Available data point markers are listed in \tableref{tab:datapointmarkers}.

\widgetdef{arrow.tab.bracket}

Bracket style markers which protrude back from the vertex.
Available bracket markers are listed in \tableref{tab:bracketmarkers}.

\widgetdef{arrow.tab.decorative}

Decorative markers are dingbat style shapes but also include circles
and diamonds.
Available decorative markers are listed in \tableref{tab:decorativemarkers}.

\widgetdef{arrow.tab.caps}
Cap style markers protrude forward beyond the vertex.
Available cap markers are listed in \tableref{tab:capmarkers}.

\begin{important}
The cap style markers do not replace the line \pathattr{cap-style},
but are in addition to the line \pathattr{cap-style}. However the cap style
markers generally look best in combination with the
\editfn{path.style.capstyle.butt} cap line style.
\end{important}

\FloatTable[htbp]{tab:arrowmarkers}
{%
\begin{tabular}{@{}lcccc@{}}
\bfseries Marker & \bfseries Size? &
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample\\
\widget{arrow.pointed} & Required & Dependent & No &
\includeimg{markerpointed}\\
\widget{arrow.pointed60} & Required & Dependent & No &
\includeimg{markerpointed60}\\
\widget{arrow.pointed45} & Required & Dependent & No &
\includeimg{markerpointed45}\\
\widget{arrow.cusp} & Required & Dependent & No &
\includeimg{markercusp}\\
\widget{arrow.latex} & N/A & Dependent & No &
\includeimg{markerlatex}\\
\widget{arrow.altlatex} & N/A & Dependent & No &
\includeimg{markeraltlatex}\\
\widget{arrow.altlatex_open} & N/A & Dependent & No &
\includeimg{markeraltlatexopen}\\
\widget{arrow.triangle} & Required & Dependent & No &
\includeimg{markertriangle}\\
\widget{arrow.triangle_open} & Required & Dependent & No &
\includeimg{markertriangleopen}\\
\widget{arrow.equilateral_filled} & Required & Independent
& No & \includeimg{markerequilateralfilled}\\
\widget{arrow.equilateral_open} & Required & Independent
& No & \includeimg{markerequilateralopen}\\
\widget{arrow.hooks} & Required & Dependent & No &
\includeimg{markerhooks}
\end{tabular}
}
[Available Marker Styles and Dependencies for Arrow Style Markers]
{Available marker styles and dependencies for arrow
style markers. (Line width=2bp, marker size=8bp, butt cap style.)
Markers are shown in red to distinguish them from the line.}

\FloatTable[htbp]{tab:partialmarkers}
{%
\begin{tabular}{@{}lcccc@{}}
\bfseries Marker & \bfseries Size? &
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample\\
\widget{arrow.hook_up} & Required & Dependent & No &
\includeimg{markerhookup}\\
\widget{arrow.hook_down} & Required & Dependent & No &
\includeimg{markerhookdown}\\
\widget{arrow.halfpointed_up} & Required & Dependent & No &
\includeimg{markerhalfpointedup}\\
\widget{arrow.halfpointed_down} & Required & Dependent & No &
\includeimg{markerhalfpointeddown}\\
\widget{arrow.halfpointed60_up} & Required & Dependent & No &
\includeimg{markerhalfpointed60up}\\
\widget{arrow.halfpointed60_down} & Required & Dependent & No &
\includeimg{markerhalfpointed60down}\\
\widget{arrow.halfpointed45_up} & Required & Dependent & No &
\includeimg{markerhalfpointed45up}\\
\widget{arrow.halfpointed45_down} & Required & Dependent & No &
\includeimg{markerhalfpointed45down}\\
\widget{arrow.halfcusp_up} & Required & Dependent & No &
\includeimg{markerhalfcuspup}\\
\widget{arrow.halfcusp_down} & Required & Dependent & No &
\includeimg{markerhalfcuspdown}
\end{tabular}
}
[Available Marker Styles and Dependencies for Partial Arrow
Style Markers]
{Available marker styles and dependencies for partial
arrow style markers. (Line width=2bp, marker size=8bp, butt cap
style.) Markers are shown in red to distinguish them from the line.}

\NoFloatLongTable{tab:datapointmarkers}
[\renewcommand*{\arraystretch}{1.5}]
{@{}lcccc@{}}
{%
\bfseries Marker & \bfseries Size? &
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample
}
{%
\widget{arrow.dotfilled} & Required & Independent & Yes &
\includeimg{markerdotfilled}\\
\widget{arrow.dotopen} & Required & Independent & Yes &
\includeimg{markerdotopen}\\
\widget{arrow.boxfilled} & Required & Independent & Yes &
\includeimg{markerboxfilled}\\
\widget{arrow.boxopen} & Required & Independent & Yes &
\includeimg{markerboxopen}\\
\widget{arrow.cross} & Required & Independent & Yes &
\includeimg{markercross}\\
\widget{arrow.plus} & Required & Independent & Yes &
\includeimg{markerplus}\\
\widget{arrow.star} & Required & Independent & Yes &
\includeimg{markerstar}\\
\widget{arrow.asterisk} & Required & Independent & Yes &
\includeimg{markerasterisk}\\
\widget{arrow.star5_open} & Required & Independent & Yes &
\includeimg{markerstar5open}\\
\widget{arrow.star5_filled} & Required & Independent & Yes &
\includeimg{markerstar5filled}\\
\widget{arrow.star6_open} & Required & Independent & Yes &
\includeimg{markerstar6open}\\
\widget{arrow.star6_filled} & Required & Independent & Yes &
\includeimg{markerstar6filled}\\
\widget{arrow.triangle_up_filled} & Required & Independent & Yes &
\includeimg{markertriangleupfilled}\\
\widget{arrow.triangle_up_open} & Required & Independent & Yes &
\includeimg{markertriangleupopen}\\
\widget{arrow.triangle_down_filled} & Required & Independent & Yes &
\includeimg{markertriangledownfilled}\\
\widget{arrow.triangle_down_open} & Required & Independent & Yes &
\includeimg{markertriangledownopen}\\
\widget{arrow.rhombus_filled} & Required & Independent & Yes &
\includeimg{markerrhombusfilled}\\
\widget{arrow.rhombus_open} & Required & Independent & Yes &
\includeimg{markerrhombusopen}\\
\widget{arrow.pentagon_filled} & Required & Independent & Yes &
\includeimg{markerpentagonfilled}\\
\widget{arrow.pentagon_open} & Required & Independent & Yes &
\includeimg{markerpentagonopen}\\
\widget{arrow.hexagon_filled} & Required & Independent & Yes &
\includeimg{markerhexagonfilled}\\
\widget{arrow.hexagon_open} & Required & Independent & Yes &
\includeimg{markerhexagonopen}\\
\widget{arrow.octagon_filled} & Required & Independent & Yes &
\includeimg{markeroctagonfilled}\\
\widget{arrow.octagon_open} & Required & Independent & Yes &
\includeimg{markeroctagonopen}\\
\widget{arrow.semicircle_filled} & Required & Independent & No &
\includeimg{markersemicirclefilled}\\
\widget{arrow.semicircle_open} & Required & Independent & No &
\includeimg{markersemicircleopen}
}
[Available Marker Styles and Dependencies for Data Point Style Markers]
{Available marker styles and dependencies for data
point style markers. (Line width=2bp, marker size=8bp, butt cap
style.) Markers are shown in red to distinguish them from the line.}

\FloatTable[htbp]{tab:bracketmarkers}
[\renewcommand*{\arraystretch}{1.75}]
{%
\begin{tabular}{@{}lcccc@{}}
\bfseries Marker & \bfseries Size? &
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample\\
\widget{arrow.square} & N/A & Dependent & No&
\includeimg{markersquare}\\
\widget{arrow.bar} & N/A & Dependent & Yes &
\includeimg{markerbar}\\
\widget{arrow.round} & N/A & Dependent & No &
\includeimg{markerround}\\
\widget{arrow.brace} & N/A & Dependent & No &
\includeimg{markerbrace}\\
\widget{arrow.altsquare} & Required & Dependent & No&
\includeimg{markeraltsquare}\\
\widget{arrow.altbar} & Required & Dependent & Yes &
\includeimg{markeraltbar}\\
\widget{arrow.altround} & Required & Dependent & No &
\includeimg{markeraltround}\\
\widget{arrow.altbrace} & Required & Dependent & No &
\includeimg{markeraltbrace}
\end{tabular}
}
[Available Marker Styles and Dependencies for Bracket Style Markers]
{Available marker styles and dependencies for bracket
style markers. (Line width=2bp, marker size=8bp, butt cap style.)
Markers are shown in red to distinguish them from the line.}

\clearpage

\NoFloatLongTable{tab:capmarkers}
[\renewcommand*{\arraystretch}{1.75}]
{@{}lcccc@{}}
{%
\bfseries Marker & \bfseries Size? & 
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample
}
{%
\widget{arrow.rectanglecap} & Required & Dependent & No &
\includeimg{markerrectanglecap}\\
\widget{arrow.roundcap} & Required & Dependent & No &
\includeimg{markerroundcap}\\
\widget{arrow.trianglecap} & Required & Dependent & No &
\includeimg{markertrianglecap}\\
\widget{arrow.inverttrianglecap} & Required & Dependent & No &
\includeimg{markerinverttrianglecap}\\
\widget{arrow.chevroncap} & Required & Dependent & No &
\includeimg{markerchevroncap}\\
\widget{arrow.invertchevroncap} & Required & Dependent & No &
\includeimg{markerinvertchevroncap}\\
\widget{arrow.fastcap} & Required & Dependent & No &
\includeimg{markerfastcap}\\
\widget{arrow.invertfastcap} & Required & Dependent & No &
\includeimg{markerinvertfastcap}\\
\widget{arrow.ballcap} & Required & Dependent & No &
\includeimg{markerballcap}\\
\widget{arrow.leafcap} & Required & Dependent & No &
\includeimg{markerleafcap}\\
\widget{arrow.doubleleafcap} & Required & Dependent & No &
\includeimg{markerleaf2cap}\\
\widget{arrow.tripleleafcap} & Required & Dependent & No &
\includeimg{markerleaf3cap}\\
\widget{arrow.clubcap} & Required & Dependent & No &
\includeimg{markerclubcap}\\
\widget{arrow.tripleleafforwardcap} & Required & Dependent & No &
\includeimg{markerleaf3forcap}\\
\widget{arrow.tripleleafbackcap} & Required & Dependent & No &
\includeimg{markerleaf3backcap}\\
\widget{arrow.doubleleafforwardcap} & Required & Dependent & No &
\includeimg{markerleaf2forcap}\\
\widget{arrow.doubleleafbackcap} & Required & Dependent & No &
\includeimg{markerleaf2backcap}\\
\widget{arrow.bulgecap} & Required & Dependent & No &
\includeimg{markerbulgecap}\\
\widget{arrow.cutoutbulgecap} & Required & Dependent & No &
\includeimg{markercutoutbulgecap}
}
[Available Marker Styles and Dependencies for Cap Style Markers]
{Available marker styles and dependencies for cap style
markers. (Line width=10bp, marker size=5bp, butt cap style.)
The cap style markers are designed to be flush against the line,
so they are only clearly visible for thick lines.
Markers are shown in red to distinguish them from the line.}

\FloatTable[htbp]{tab:decorativemarkers}
[\renewcommand*{\arraystretch}{1.75}]
{%
\begin{tabular}{@{}lcccc@{}}
\bfseries Marker & \bfseries Size? &
\bfseries \tablecellstack{Line Width\\Dependent?} &
\bfseries \tablecellstack{\Manmsg{centred} on\\Vertex?} &
\bfseries Sample\\
\widget{arrow.circle} & Required & Dependent & No &
\includeimg{markercircle}\\
\widget{arrow.diamond} & N/A & Dependent & No &
\includeimg{markerdiamond}\\
\widget{arrow.circle_open} & Required & Dependent & No &
\includeimg{markercircleopen}\\
\widget{arrow.diamond_open} & N/A & Dependent & No &
\includeimg{markerdiamondopen}\\
\widget{arrow.scissors_up_filled} & Required & Dependent & No &
\includeimg{markerscissorsupfilled}\\
\widget{arrow.scissors_down_filled} & Required & Dependent & No &
\includeimg{markerscissorsdownfilled}\\
\widget{arrow.scissors_up_open} & Required & Dependent & No &
\includeimg{markerscissorsupopen}\\
\widget{arrow.scissors_down_open} & Required & Dependent & No &
\includeimg{markerscissorsdownopen}\\
\widget{arrow.heart_right_filled} & Required & Independent & No &
\includeimg{markerheartrightfilled}\\
\widget{arrow.heart_right_open} & Required & Independent & No &
\includeimg{markerheartrightopen}\\
\widget{arrow.heart_filled} & Required & Independent & No &
\includeimg{markerheartfilled}\\
\widget{arrow.heart_open} & Required & Independent & No &
\includeimg{markerheartopen}\\
\widget{arrow.snowflake} & Required & Independent & Yes &
\includeimg{markersnowflake}\\
\widget{arrow.starchevron_open} & Required & Independent & Yes &
\includeimg{markerstarchevronopen}\\
\widget{arrow.starchevron_filled} & Required & Independent & Yes &
\includeimg{markerstarchevronfilled}
\end{tabular}
}
[Available Marker Styles and Dependencies for Decorative Markers]
{Available marker styles and dependencies for
decorative markers. (Line width=2bp, marker size=8bp,
butt cap style.)
Markers are shown in red to distinguish them from the line.}


\subsubsection{Marker Size}\label{sec:markersize}


\widgetdef{arrow.size}

The \widget{arrow.size} box will be enabled for only the
resizeable markers. This box can be used to vary the 
\inlineglsdef{index.marker.size},
but some markers also depend on the line width, so the size box is
only meant as a general guide.

\subsubsection{Repeating Markers}\label{sec:repeatingmarkers}

\Inlineglsdef{index.marker.repeating} markers are supported (up to
three markers, including the original). This is where the marker is
duplicated or triplicated, each copy slightly offset from the original marker.

\figureref{fig:repeatmarkers} illustrates single, double and triple
repeat markers for a path with a \LaTeX\ style end arrow. Note that
the markers are placed along the gradient vector which means that
they may not lie on the actual path. (See
\figureref{fig:bezierrepeat}.)

\widgetdef{arrow.single}

Select the \widget{arrow.single} radio button for a single marker.

\widgetdef{arrow.double}

Select the \widget{arrow.double} radio button for two markers.

\widgetdef{arrow.triple}

Select the \widget{arrow.triple} radio button for three markers.

\FloatSubFigs{fig:repeatmarkers}
{
  {fig:repeatmarkersa}{\includeimg{repeatMarker1}}{},
  {fig:repeatmarkersb}{\includeimg{repeatMarker2}}{},
  {fig:repeatmarkersc}{\includeimg{repeatMarker3}}{}
}
[Repeat Markers]
{Repeat markers:
\subfigref{fig:repeatmarkersa} single;
\subfigref{fig:repeatmarkersb} double;
\subfigref{fig:repeatmarkersc} triple.}

\FloatFig{fig:bezierrepeat}
{\includeimg{bezierrepeat}}
[Repeat Markers Are Placed Along the Gradient Vector]
{Repeat markers are placed along the gradient vector.}


\subsubsection{Reversing Markers}\label{sec:reversingmarkers}

A marker may be \inlineglsdef{index.marker.reversed} so that it
points in the opposite direction. Note that start markers are always 
automatically reversed, so reversing a start marker would make it
point in the same direction as the mid and end marker of the same
type.

\widgetdef{arrow.reversed}

Select the \widget{arrow.reversed} check box to reverse the marker
(see \figureref{fig:reversedmarkers}).

\FloatSubFigs{fig:reversedmarkers}
{
  {fig:reversedmarkersa}{\includeimg{reversedMarker1}}{},
  {fig:reversedmarkersb}{\includeimg{reversedMarker2}}{},
  {fig:reversedmarkersc}{\includeimg{reversedMarker3}}{}
}
[Reversed Markers]
{Reversed markers:
\subfigref{fig:reversedmarkersa} single reversed;
\subfigref{fig:reversedmarkersb} double reversed;
\subfigref{fig:reversedmarkersc} triple reversed.}

\subsubsection{Composite Markers}\label{sec:compositemarkers}

A \inlineglsdef{index.marker.composite} marker is formed by
combining two markers: the primary marker and a secondary marker.

\widgetdef{arrow.composite}

To combine the primary marker with another marker, select the
\widget{arrow.composite} \gls{checkbox} which will enable the
\widget{arrow.secondary} tab and the \widget{arrow.overlay} checkbox.

\widgetdef{arrow.overlay}

If the \widget{arrow.overlay} \gls*{checkbox}
is selected, the primary and secondary markers will be positioned so
that their origins coincide, otherwise the secondary marker will be
offset from the primary marker (see also the marker
\gls{index.marker.offset} in \sectionref{sec:markeroffset}). 

\figureref{fig:composite} shows two examples of composite markers:
in \figureref{fig:compositea} the start and end markers are formed
from a pointed arrow primary marker of size 5\gls{bp} and a
composite bar secondary marker, while in \figureref{fig:compositeb}
the start and end markers are formed from an open semicircle primary
marker of size 5bp with an overlaid reversed filled semicircle
secondary marker of size 5bp.

\FloatSubFigs{fig:composite}
{
 {fig:compositea}{\includeimg{composite1}}{},
 {fig:compositeb}{\includeimg{composite2}}{}
}
[Examples of Composite Markers]
{Examples of composite markers:
\subfigref{fig:compositea} a bar primary marker with a pointed secondary
marker of size 5bp;
\subfigref{fig:compositeb} an open semicircle primary marker of
size 5bp overlaid with a reversed filled semicircle secondary marker
of size 5bp.}


\subsubsection{Marker Orientation}\label{sec:markerorientation}

\widgetdef{arrow.autoorient}

If the \widget{arrow.autoorient} checkbox is selected,
the marker's \inlineglsdef{index.marker.orientation} will be
calculated to align the marker so that its $x$-axis lies along the
gradient vector at the vertex. 

If the \widget{arrow.autoorient} is not selected, the angle input
field next to it will be enabled in which you can specify the
desired angle of rotation.

\begin{important}
Remember that start markers point in the opposite direction.
\end{important}

\subsubsection{Marker Offset}\label{sec:markeroffset}

The primary marker will be placed on its origin coinciding with the
vertex. (The origin may not be on the edge of the marker's bounding
box. For example, the origin may be in the \manmsg{centre} of the
marker for most of the data point markers.)
The marker can be \inlineglsdef{index.marker.offset}
so that its origin is no longer coinciding with the vertex.

The secondary marker will be offset from the primary marker
according to whether any duplicate markers have been specified and
according to the line width.

\widgetdef{arrow.autooffset}

If the \widget{arrow.autooffset} box is selected, the marker's
\gls{index.marker.offset} from the vertex will be computed automatically. 
If this box is deselected, the marker will be offset according to
the length specified in the adjoining box, which will become
enabled.

For example, in \figureref{fig:markeroffseta} both the start and end
markers have been set to the \LaTeX\ style marker with an offset of
$-10$\gls{bp}, and in \figureref{fig:markeroffsetb} both the start
and end markers are \gls{index.marker.composite} markers formed from
a bar primary marker and a pointed secondary marker, where the
secondary marker's \gls{index.marker.offset} has been set to
2\gls{bp}.  Note that setting the secondary marker's \gls{index.marker.offset}
to 0 is equivalent to using the overlay function.

\begin{information}
Markers are placed along the \gls{path}['s] gradient
vector, so the marker may not necessarily lie on the \gls*{path}. For
example, in \figureref{fig:bezieroffset}, a marker with offset 10\gls{bp}
has been placed at the end of a \gls{Bezier-curve}. The marker's offset
has moved it along the gradient vector, away from the curve.
\end{information}

\FloatSubFigs{fig:markeroffset}
{
  {fig:markeroffseta}{\includeimg{markeroffset1}}{},
  {fig:markeroffsetb}{\includeimg{markeroffset2}}{}
}
[Disabling the Marker Auto Offset]
{Disabling the marker auto offset:
\subfigref{fig:markeroffseta} a negative offset makes the marker protrude off
the end of the line;
\subfigref{fig:markeroffsetb} the secondary marker has an offset
of 2bp so that it is only slightly behind the primary marker.}

\FloatFig{fig:bezieroffset}
{\includeimg{bezieroffset}}
[Changing a Marker's Offset Moves It Along the Gradient Vector]
{Changing a marker's offset moves it along the gradient vector.}

\subsubsection{Repeat Gap}\label{sec:repeatgap}

The \inlineglsdef{index.marker.repeat-gap} is the gap between
repeated markers.

\widgetdef{arrow.autogap}

If the \widget{arrow.autogap} box is selected, the gap
between repeat markers is given by 7 times the line width. If the
\widget{arrow.autogap} box is not selected, the gap will be given by the length specified
in the adjoining box. For example, in \figureref{fig:repeatgapa}
a line has an end marker with a triple arrow with
the auto repeat function selected. Since the line width is 1\gls{bp}, the
gap between the markers is 7\gls{bp}. In \figureref{fig:repeatgapb}
the line width is 2\gls{bp}, so the gap between the markers is 14\gls{bp}. In
\figureref{fig:repeatgapc}, the line width is 1\gls{bp} and the repeat
gap has been set to 10\gls{bp} and in \figureref{fig:repeatgapd}
the line width is 2\gls{bp} again with a repeat gap of 10\gls{bp}.

\FloatSubFigs{fig:repeatgap}
{
  {fig:repeatgapa}{\includeimg{repeatgap1}}{},
  {fig:repeatgapb}{\includeimg{repeatgap2}}{},
  {fig:repeatgapc}{\includeimg{repeatgap3}}{},
  {fig:repeatgapd}{\includeimg{repeatgap4}}{}
}
[Repeat Gap]
{Repeat gap:
\subfigref{fig:repeatgapa} line width of 1\gls{bp} and auto repeat gap;
\subfigref{fig:repeatgapb} line width of 2\gls{bp} and auto repeat gap;
\subfigref{fig:repeatgapc} line width of 1\gls{bp} and repeat gap set to 10\gls{bp};
\subfigref{fig:repeatgapd} line width of 2\gls{bp} and repeat gap set to
10\gls{bp}.}


\subsubsection{Marker \Glsentrytext{manual.colour}}\label{sec:markerpaint}

The marker \inlineglsdef{index.marker.colour} may be the same as the
path or may have its own \inlineglsdef{index.marker.colour}
independent of the path's \pathattr{line-paint}.

\begin{information}
If the marker has been assigned a specific \gls{index.marker.colour}, it
will remain unchanged if you change the \pathattr{line-paint} of the
\gls*{path}, otherwise it will change with the \gls*{path}['s]
\pathattr{line-paint}.
\end{information}

\widgetdef{arrow.colour.dependent}

If the \widget{arrow.colour.dependent} box is selected, the marker will
have the same \gls{index.marker.colour} as the \gls*{path}['s]
\pathattr{line-paint}.

\widgetdef{arrow.colour.independent}

If the \widget{arrow.colour.independent} box is selected, the marker
\gls{index.marker.colour} will be independent of the \gls*{path}['s]
\pathattr{line-paint}. Selecting the \widget{arrow.colour.independent} box 
will enable the \widget{paintselector.single} panel where you can choose
the marker's \gls{index.marker.colour}.
For example, \figureref{fig:sampleplot} shows a \gls*{path} with
a \gls{transparent} \pathattr{line-paint} and blue start, mid and end
markers.

\FloatFig{fig:sampleplot}
{\includeimg{sampleplot}}
[Marker \Manmsg{colour} May Be Independent of the Line \Manmsg{colour}]
{Marker \manmsg{colour} may be independent of the line
\manmsg{colour}:
this path has a transparent line paint and blue
start, mid and end markers.}

Primary and secondary marker \gls{index.marker.colour} settings are
independent of each other.  For example, in
\figureref{fig:markercolour} the start and end markers are
\gls{index.marker.composite} markers formed from a filled yellow
pentagon primary marker and an open pentagon secondary marker. The
secondary marker \gls{index.marker.colour} is set to the
\pathattr{line-paint}, so if the \pathattr{line-paint} is changed
the pentagon outline will change accordingly, but the filled
pentagon will remain yellow.

\FloatFig{fig:markercolour}
{\includeimg{markercolour}}
{Primary and Secondary Markers are Independent}

\section{Text Paint}\label{sec:textpaint}

\menudef{menu.edit.textarea.colour}

The \menu{edit.textarea.colour} menu item opens a dialog
with a \widget{textpaintselector.title} panel in which
you can change the \inlineglsdef{index.text-attribute.paint} 
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{textpaintselector.title}

The \widget{textpaintselector.title} panel has a \dialog{paintselector} panel
(see \sectionref{sec:paint}) that may be used to set the 
text \textattr{paint}. This panel is also a tab
in the \dialog{styles} dialog to set the current
text \textattr{paint}.
There is a sample panel along the top illustrating the effects of
the \textattr{paint} you choose.

\begin{information}
If the text \textattr{paint} is set to \widget{paintselector.transparent}
then the \gls{textarea} is not painted on the canvas, but it does
have a \gls{bbox}. When \hyperref[sec:exportimage]{exporting} to a
\LaTeX\ document, \gls{transparent} \glspl*{textarea} have their
text set in the argument of \gls{phantom}.
\end{information}

\FlowframTk\ can't implement \dgls{gradient-paint} for text when
using one of the \LaTeX-related export functions. You can choose
how \FlowframTk\ should treat text with \dgls{gradient-paint} via the
\dialog{texconfig} dialog's \dialog{textconfig} panel 
(see \sectionref{sec:texconfigtext}).


\section{Text Style}\label{sec:textstyle}

\menudef{menu.edit.textarea.font.all_styles}

The \menu{edit.textarea.font.all_styles} menu item opens a dialog
with a \widget{font.title} panel in which
you can change the \inlineglsdef{font} 
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{font.title}

The \widget{font.title} panel is also a tab
in the \dialog{styles} dialog to set the current
\gls{font}. The panel has the following areas:
\begin{deflist}
\itemtitle{\widget{font.family}}
\begin{itemdesc}
Specifies the \textattr{font-family} (\sectionref{sec:fontfamily}).
\end{itemdesc}

\itemtitle{\widget{font.size}}
\begin{itemdesc}
Specifies the \textattr{font-size} (\sectionref{sec:fontsize}).
\end{itemdesc}

\itemtitle{\widget{font.series}}
\begin{itemdesc}
Specifies the \textattr{font-series} (\sectionref{sec:fontseries}).
\end{itemdesc}

\itemtitle{\widget{font.shape}}
\begin{itemdesc}
Specifies the \textattr{font-shape} (\sectionref{sec:fontshape}).
\end{itemdesc}

\itemtitle{\widget{font.anchor}}
\begin{itemdesc}
Specifies the \textattr{anchor} (\sectionref{sec:fontanchor}).
\end{itemdesc}

\end{deflist}

\subsection{Font Family}\label{sec:fontfamily}

\menudef{menu.edit.textarea.font.family}

The \menu{edit.textarea.font.family} menu item opens a dialog with a 
\widget{font.family} panel in which you can change the
\inlineglsdef{index.text-attribute.font-family}
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{font.family}

The \widget{font.family} panel is also in the \widget{font.title}
panel. Use the \gls{dropdown} (\figureref{fig:setfontfamily}) to
select the font family used to \glslink{drawing-on-canvas}{draw} the
text on the \gls{canvas}.  This \gls{dropdown} provides a list of
locally available fonts found by the \gls{jre}.

\FloatFig{fig:setfontfamily}
{\includeimg{annoteFontFamily}}
{Setting the Font Family}

When you select a font family, \FlowframTk\ uses its
\inlineglsdef{font-mapping} to determine
an appropriate \LaTeX\ font family declaration.  This is used if you
\filefn{export} your image as a \LaTeX\ file (or use one of the
export functions that have \LaTeX\ as an intermediate step). If
\FlowframTk\ has guessed incorrectly, you can select a different
command from the \gls{combobox} on the right, or you can edit it if
you require a font family declaration that is not listed.
Alternatively you can clear the value (by deleting the family
declaration) to use the current document font family.

If no \gls{font-mapping} has been set, then \FlowframTk\ will guess
at the most appropriate declaration based on the font name.
If there is a particular mapping that you always
want, you can set up a \gls{font-mapping}.

The \glspl{font-mapping} are defined in a file called
\inlineglsdef{file.latexfontmap.prop} (which may need to be created, if it
doesn't exist) in \FlowframTk's \gls{config_dir}.
Each line in this file should be in the form:
\begin{compactcodebox}
\meta{font-name}=\meta{LaTeX declaration}
\end{compactcodebox}%
where \meta{font name} is the name of the font family (for example,
URW Chancery L) and \meta{LaTeX declaration} is the
code used to set the font in a \LaTeX\ document.

\begin{information}
The mapped \LaTeX\ code should be in the form of a declaration (sets
the font \qt{from this point onwards}) such as \gls{rmfamily} not a 
text block command (a command that sets its argument in the given font)
such as \gls{textrm}.
\end{information}

Blank lines or lines starting with a \gls{hash} are ignored. For
example, on my computer I have the font \qt{URW Chancery L}. If I
select this font, the \LaTeX\ equivalent will default to
\gls{rmfamily}. However, it would be more appropriate for the
\LaTeX\ declaration to select the PSNFSS chancery font. Therefore, I
can use my favourite text editor to create a file called
\file{latexfontmap.prop} with the line
\begin{compactcodebox*}
URW Chancery L=\gls{fontfamily}\marg{pzc}\gls{selectfont}
\end{compactcodebox*}%
and save it in \FlowframTk's \gls{config_dir}. Next time I
start \FlowframTk, it will load this mapping and use it whenever
I select \qt{URW Chancery L} from the font name selector.
Alternatively, you can use a regular expression. For example:
\begin{compactcodebox*}
.*[Cc]hancery.*=\gls{fontfamily}\marg{pzc}\gls{selectfont}
\end{compactcodebox*}%
This will select \code{\gls{fontfamily}\marg{pzc}\gls{selectfont}} for any font
that contains either \qt{Chancery} or \qt{chancery} in its name.
It is however faster to use the exact name.

\seealsorefs{sec:fontanchor}

\subsection{Font Size}\label{sec:fontsize}

\menudef{menu.edit.textarea.font.size}

The \menu{edit.textarea.font.size} menu item opens a dialog with a 
\widget{font.size} panel in which you can change the
\inlineglsdef{index.text-attribute.font-size}
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{font.size}

The \widget{font.size} panel is also in the \widget{font.title}
panel. Enter the desired \textattr{font-size} in the input field
(see \figureref{fig:setfontsize}).

\FloatFig{fig:setfontsize}
{\includeimg{annoteFontSize}}
{Setting the Font Size}

When you specify a font size, \FlowframTk\ guesses at the
appropriate \LaTeX\ font size declaration. The
\gls{normal-font-size} is taken from the value given in the
\widget{clssettings.title} tab (see \sectionref{sec:normalsize}) of
the \dialog{texconfig} dialog box (unless you have unchecked the
\widget{clssettings.relative_fontsize} setting). This is used if you
\filefn{export} your image as a \LaTeX\ file (or use one of the
export functions that have \LaTeX\ as an intermediate step).

If \FlowframTk\ has guessed incorrectly, you can select a different
command from the \gls{combobox} on the right, or you can edit it if
you require a font size declaration that is not listed.
Alternatively you can clear the value (by deleting the size
declaration) to use the current document font size.  Note that
\gls{veryHuge}, \gls{VeryHuge} and \gls{VERYHuge} are
not standard commands, but are defined in the \cls{a0poster}
class file.  \FlowframTk\ will only select these commands if the
normal font size is 25\gls{pt}. Remember that if you want to use
very large sizes in your \LaTeX\ document, you will need to use
scalable fonts rather than the default Computer Modern.

Note that if you change the \gls{normalsize} value (typically
through a document class option), you will
need to reselect the \textattr{font-size} for each of the \gls{textarea}['s]
that have already been defined unless the \gls*{checkbox} marked
\widget{clssettings.update} is selected in the
\widget{clssettings.title} tab of the \dialog{texconfig} dialog box.

\seealsorefs{
 sec:fontanchor,
 sec:normalsize,
 sec:texconfig
}

\subsection{Font Series}\label{sec:fontseries}

\menudef{menu.edit.textarea.font.series}

The \menu{edit.textarea.font.series} menu item opens a dialog with a 
\widget{font.series} panel in which you can change the
\inlineglsdef{index.text-attribute.font-series}
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{font.series}

The \widget{font.series} panel is also in the \widget{font.title}
panel. Use the \gls{dropdown} (\figureref{fig:setfontseries}) to
select the font series used to \glslink{drawing-on-canvas}{draw} the
text on the \gls{canvas}.
The available choices are:

\widgetdef{font.series.medium}

The \widget{font.series.medium} item indicates medium weight and
will automatically set the \LaTeX\ alternative to \gls{mdseries}.

\widgetdef{font.series.bold}

The \widget{font.series.bold} item indicates bold weight and
will automatically set the \LaTeX\ alternative to \gls{bfseries}.

\FloatFig{fig:setfontseries}
{\includeimg{annoteFontSeries}}
{Setting the Font Series}

If you prefer a different \LaTeX\ declaration to the one selected,
you can select another command from the \gls{combobox} on the right
or you can edit it if you require a font series declaration that is
not listed.  Alternatively you can clear the value (by deleting the
series declaration) to use the current document font series.

\subsection{Font Shape}\label{sec:fontshape}

\menudef{menu.edit.textarea.font.shape}

The \menu{edit.textarea.font.shape} menu item opens a dialog with a 
\widget{font.shape} panel in which you can change the
\inlineglsdef{index.text-attribute.font-shape}
of all \selected\ \glspl{textarea} and \glspl{textpath}.

\widgetdef{font.shape}

The \widget{font.shape} panel is also in the \widget{font.title}
panel. Use the \gls{dropdown} (\figureref{fig:setfontshape}) to
select the font shape used to \glslink{drawing-on-canvas}{draw} the
text on the \gls{canvas}.
The available choices are:

\widgetdef{font.shape.upright}

The \widget{font.shape.upright} item indicates upright and
will automatically set the \LaTeX\ alternative to \gls{upshape}.

\widgetdef{font.shape.italic}

The \widget{font.shape.italic} item indicates italic and
will automatically set the \LaTeX\ alternative to \gls{em}.

\FloatFig{fig:setfontshape}
{\includeimg{annoteFontShape}}
{Setting the Font Shape}

If you prefer a different \LaTeX\ declaration to the one selected,
you can select another command from the \gls{combobox} on the right
or you can edit it if you require a font shape declaration that is
not listed.  Alternatively you can clear the value (by deleting the
shape declaration) to use the current document font shape.

\subsection{Anchor}\label{sec:fontanchor}

There are two \inlineglspluraldef{index.text-attribute.anchor}
that relate to \glspl{textarea} and \glspl{textpath}: the horizontal
\textattr{anchor} and the vertical \textattr{anchor}.

The default is \gls{font.anchor.left} for the horizontal anchor and
\gls{font.anchor.base} for the vertical anchor. These can be changed
using the \menu{edit.textarea.font.anchor} menu. The sample panel will
display a small red dot to indicate the position of the anchor. If
you enable the \widget{textconfig.anchor} setting
(\sectionref{sec:texconfigtext}), the anchor will be changed when
you \hyperref[sec:alignobjects]{align} groups containing \glspl{textarea}.

\menudef{menu.edit.textarea.font.anchor}

The \menu{edit.textarea.font.anchor} sub menu may be used to set the
\textattrpl{anchor}.

\menudef{menu.edit.textarea.font.anchor.both}

The \menu{edit.textarea.font.anchor.both} menu item opens a dialog
with the \widget{font.anchor} panel to change both the horizontal
and vertical anchors for all \selected\ \glspl{textarea} and
\glspl{textpath}.

\menudef{menu.edit.textarea.font.anchor.horizontal}

The \menu{edit.textarea.font.anchor.horizontal} menu opens a dialog
with the \widget{font.hanchor} component which may be used to set the
horizontal \textattr{anchor}.

\menudef{menu.edit.textarea.font.anchor.vertical}

The \menu{edit.textarea.font.anchor.vertical} menu opens a dialog
with the \widget{font.vanchor} component which may be used to set the
vertical \textattr{anchor}.

\widgetdef{font.anchor}

The \widget{font.anchor} panel is also in the \widget{font.title}
panel and provides a way to set both the horizontal and vertical
anchor at the same time. 

\widgetdef{font.hanchor}

The horizontal anchor options are:

\begin{deflist}
\itemtitle{\inlineglsdef{font.anchor.left}}
\begin{itemdesc}
Left horizontal anchor (corresponds to PGF node \code{west} anchor).
\end{itemdesc}

\itemtitle{\inlineglsdef{font.anchor.hcentre}}
\begin{itemdesc}
\Manmsg{centre} horizontal anchor.
\end{itemdesc}

\itemtitle{\inlineglsdef{font.anchor.right}}
\begin{itemdesc}
Right horizontal anchor (corresponds to PGF node \code{east} anchor).
\end{itemdesc}

\end{deflist}

\widgetdef{font.vanchor}

The vertical anchor options are:

\begin{deflist}
\itemtitle{\inlineglsdef{font.anchor.base}}
\begin{itemdesc}
Base vertical anchor (align on the baseline).
\end{itemdesc}

\itemtitle{\inlineglsdef{font.anchor.vcentre}}
\begin{itemdesc}
\Manmsg{centre} vertical anchor.
\end{itemdesc}

\itemtitle{\inlineglsdef{font.anchor.top}}
\begin{itemdesc}
Top horizontal anchor (corresponds to PGF node \code{north} anchor).
\end{itemdesc}

\itemtitle{\inlineglsdef{font.anchor.bottom}}
\begin{itemdesc}
Bottom horizontal anchor (corresponds to PGF node \code{south} anchor).
\end{itemdesc}

\end{deflist}

When exporting to PGF (see \sectionref{sec:exportpgf}), each
\gls{textarea} is placed inside a node. In this case, the
\textattrpl{anchor} are used to identify the PGF node anchors.
The \gls{textarea} anchors are not used when \gls{drawing-on-canvas}
the text on the \gls{canvas}.

For a \gls{textpath}, the anchor is used to determine where the text
should be positioned along the underlying path. Changing the anchor
for a \gls*{textpath} will change the way it is displayed in
\FlowframTk\ (as illustrated in \figureref{fig:textpath}).  The
vertical anchor for \glspl*{textpath} is not supported when
exporting to a \LaTeX\ file.

If you export your image to a \LaTeX\ file, the font used in the
document is unlikely to completely match the font used in \FlowframTk.
As a result, text may appear wider or narrower in the resulting
\LaTeX\ document than in the image displayed in \FlowframTk.  This may
result in the text appearing as though it has shifted position.
(Particularly when the \gls{textarea} contains \LaTeX\ commands.) To
reduce this effect, you can specify what part of the text should be
considered as the \textattr{anchor}. To illustrate
this, consider the image shown in \figureref{fig:anchor}.  An image
was created in \FlowframTk\ containing some text bordered by a
rectangle with an additional line along the \gls*{textarea}['s]
baseline: \figureref{fig:anchora} shows how the image appears
in \FlowframTk. The font used is the generic serif font and the
text takes up the entire box. The image was then exported to a
\LaTeX\ file with various anchor settings. The \LaTeX\ document set
the Roman font via:
\begin{compactcodebox}
\csfmt{usepackage}\marg{mathptmx}
\end{compactcodebox}

This is a slightly narrower font than the font used in \FlowframTk,
so the text no longer fills the box. In \figureref{fig:anchorb}, the
anchor was set to (\gls{font.anchor.left}, \gls{font.anchor.base});
in \figureref{fig:anchorc}, the anchor was set to
(\gls{font.anchor.hcentre}, \gls{font.anchor.base}); in
\figureref{fig:anchord}, the anchor was set to
(\gls{font.anchor.right}, \gls{font.anchor.base}).  Notice that the
baseline for the text remains as it was in \FlowframTk, but the
horizontal placement of the text varies.

In this example, the height of the text in the \LaTeX\ document is
only slightly smaller than that of the font used by \FlowframTk, so
the vertical anchor setting does not make that much difference, but
there is still a slight shift: in \figureref{fig:anchore}, the
anchor was set to (\gls{font.anchor.left},
\gls{font.anchor.bottom}); in \figureref{fig:anchorf}, the anchor
was set to (\gls{font.anchor.left}, \gls{font.anchor.vcentre}); in
\figureref{fig:anchorg}, the anchor was set to
(\gls{font.anchor.left}, \gls{font.anchor.top}).

\FloatSubFigs*{fig:anchor}
{
  {fig:anchora}{\includeimg{anchor}}{},
  {fig:anchorb}{\includeimg{anchorleftbase}}{},
  {fig:anchorc}{\includeimg{anchorcentrebase}}{},
  {fig:anchord}{\includeimg{anchorrightbase}}{},
  {fig:anchore}{\includeimg{anchorleftbottom}}{},
  {fig:anchorf}{\includeimg{anchorleftcentre}}{},
  {fig:anchorg}{\includeimg{anchorlefttop}}{}
}
[The Effect of Converting from Java Fonts to \TeX\ Fonts]
{The effect of converting from system fonts to \TeX\ fonts:
\subfigref{fig:anchora} image in \FlowframTk\ using the generic serif font. The
image was then exported to a \LaTeX\ document with the anchor
set to:
\subfigref{fig:anchorb} \gls{font.anchor.left}, \gls{font.anchor.base};
\subfigref{fig:anchorc} \gls{font.anchor.hcentre}, \gls{font.anchor.base};
\subfigref{fig:anchord} \gls{font.anchor.right}, \gls{font.anchor.base};
\subfigref{fig:anchore} \gls{font.anchor.left}, \gls{font.anchor.bottom};
\subfigref{fig:anchorf} \gls{font.anchor.left}, \gls{font.anchor.vcentre};
\subfigref{fig:anchorg} \gls{font.anchor.left}, \gls{font.anchor.top}.}

Note that in the above example, the \LaTeX\ document used a
scalable font (via the \sty{mathptmx} package). The default
Computer Modern font is not scalable. It is therefore possible that
the required size is not available, in which case \TeX\ will
substitute the closest available font size. For example, in
\figureref{fig:fontdiff}, the image created in the previous
example is again illustrated with anchor at (left, base).
\figureref{fig:fontdiffa} shows the original image in
\FlowframTk\ using the generic serif font;
\figureref{fig:fontdiffb} shows the image exported to a \LaTeX\
document that uses the \sty{mathptmx} package;
\figureref{fig:fontdiffc} shows the image exported to a
\LaTeX\ document that uses the default Computer Modern font. The
large font size (40) is not available in the Computer Modern
font, so the closest available font size is used instead, which in
this example has resulted in a significant change in size.

\FloatSubFigs{fig:fontdiff}
{
  {fig:fontdiffa}{\includeimg{anchor}}{},
  {fig:fontdiffb}{\includeimg{anchorleftbase}}{},
  {fig:fontdiffc}{\includeimg{anchorcmr}}{}
}
[The Font Used by the \LaTeX\ Document may Result in
Considerable Differences from the Original Image]
{The font used by the \LaTeX\ document may result in considerable differences from the
original image:
\subfigref{fig:fontdiffa} image in \FlowframTk;
\subfigref{fig:fontdiffb} image in \LaTeX\ document using \sty{mathptmx} package;
\subfigref{fig:fontdiffc} image
in \LaTeX\ document using non-scalable Computer Modern font.}

As mentioned earlier, if a \gls{textarea} contains \LaTeX\ commands,
this may also result in a horizontal or vertical shift. Consider an
image that contains some maths. \figureref{fig:anchorfracexa}
shows the image as it appears in \FlowframTk. The red line path is
aligned along the left edge and along the baseline of the text.  The
\gls*{textarea} has been assigned the following alternative text to be
used when exporting to a \LaTeX\ file:
\begin{verbatim}
$f(x) = \frac{(x-a_1)^2}{a_2}$
\end{verbatim}
\figureref{fig:anchorfracexb} shows how the image appears
in a \LaTeX\ document when the anchor is set to
(\gls{font.anchor.left}, \gls{font.anchor.base}),
and \figureref{fig:anchorfracexc} shows how the image appears
in a \LaTeX\ document when the anchor is set to 
(\gls{font.anchor.left}, \gls{font.anchor.bottom}).

\FloatSubFigs{fig:anchorfracex}
{
  {fig:anchorfracexa}{\includeimg{anchorfracexa}}{},
  {fig:anchorfracexb}{\includeimg{anchorfracexb}}{},
  {fig:anchorfracexc}{\includeimg{anchorfracexc}}{},
  {fig:anchorfracexd}{\includeimg{anchorfracexd}}{}
}
[Text Area Containing Maths]
{Text area containing maths:
\subfigref{fig:anchorfracexa} image in \FlowframTk;
\subfigref{fig:anchorfracexb} image as it appears in a
\LaTeX\ document with anchor set to 
(\gls{font.anchor.left}, \gls{font.anchor.base});
\subfigref{fig:anchorfracexc} image
as it appears in a \LaTeX\ document with the anchor set to
(\gls{font.anchor.left}, \gls{font.anchor.bottom});
\subfigref{fig:anchorfracexd} text area contents.}

\begin{warning}
Note that this difference in font size between the image
viewed in \FlowframTk\ and the \LaTeX\ alternative means that
exporting to an encapsulated \LaTeX\ document can cause the text to
be clipped. (This also applies to the \filefn{export} functions that use the
export to encapsulated \LaTeX\ document function as an intermediate
step, such as the export to PDF function.)
\end{warning}

If the \gls*{textarea} is transformed then the anchor will
have the same transformation. See, for example,
\figureref{fig:anchortrans}.

\FloatSubFigs{fig:anchortrans}
{
  {fig:anchortransa}{\includeimg[scale=0.8]{anchortransformed}}{},
  {fig:anchortransb}{\includeimg[scale=0.8]{anchortransformedleft}}{},
  {fig:anchortransc}{\includeimg[scale=0.8]{anchortransformedcentre}}{},
  {fig:anchortransd}{\includeimg[scale=0.8]{anchortransformedright}}{}
}
[The Text Area's Transformation Matrix Will Also Be Applied to the Anchor]
{The text area's transformation matrix will
also be applied to the anchor:
\subfigref{fig:anchortransa} original image in
\FlowframTk.  The image was then exported to a \LaTeX\ file with
anchor:
\subfigref{fig:anchortransb} \gls{font.anchor.left},
\gls{font.anchor.base};
\subfigref{fig:anchortransc} \gls{font.anchor.hcentre},
\gls{font.anchor.base};
\subfigref{fig:anchortransd}
\gls{font.anchor.right}, \gls{font.anchor.base}.}

\seealsorefs{
 sec:texconfigtext,
 sec:exportimage,
 sec:neuronexample,
 sec:accesstutorial
}

\chapter{\TeX/\LaTeX}\label{sec:tex}

\menudef{menu.tex}

This chapter covers functions that are specific to \TeX\ or \LaTeX\
users.  These functions can be obtained via the
\menu{tex} menu. The only functions that are relevant to
Plain \TeX\ users are those relating to \gls{parshape}
and \gls{shapepar}\slash\gls{Shapepar}. The \sty{flowfram} package is a \LaTeX\
package. Although the \sty{pgf} package is available for
\TeX\ formats other than \LaTeX, \FlowframTk\ currently only exports
images using \LaTeX\ syntax.

\section{Adding Commands to the Preamble and Providing Document Text}\label{sec:preamble}

The \hyperref[sec:exportdoc]{export to single-paged document}
functions create a complete \LaTeX\ document, including the document
class and \inlineglsdef{preamble}.  

As from version 0.8.8 and if the \sty{flowframtkutils} package is
available, the generated \ext{tex} file has the form:
\begin{compactcodebox}
\meta{Magic Comments}
\cmd{documentclass}\oargm{cls size opt}\margm{class-name}

\meta{Default Preamble}

\cmd{usepackage}\marg{flowframtktutils}

\meta{Early-Preamble}

\cmd{usepackage}\oargm{options}\marg{geometry}

\meta{Mid-Preamble}

\meta{Document Info}

\cmd{pagestyle}\marg{empty}

\meta{Late-Preamble}

\cmd{begin}\marg{document}\cmd{noindent}
\cmd{jdrimagebox}\margm{image code}
\cmd{end}\marg{document}
\end{compactcodebox}
The \meta{Magic Comments} header block provides a way of including
special comments (\glspl{directive} or \qt{\glspl{magic-comment}}) 
for document build tools.

With old versions of \FlowframTk, or when the \sty{flowframtkutils}
package isn't available, the generated \ext{tex} file has the form:
\begin{compactcodebox}
\cmd{documentclass}\oargm{cls size opt}\margm{class-name}
\strut
\cmd{usepackage}\marg{ifpdf}

\meta{Default Preamble}

\cmd{usepackage}\marg{pgf}
\cmd{usepgflibrary}\marg{decorations.text}

\meta{Early-Preamble}

\meta{Definition of \gls+{jdroutline}}

\cmd{usepackage}\oargm{options}\marg{geometry}

\meta{Mid-Preamble}

\cmd{pagestyle}\marg{empty}

\meta{Definition of \gls+{jdrimagebox}}

\meta{Late-Preamble}

\cmd{begin}\marg{document}\cmd{noindent}
\cmd{jdrimagebox}\margm{image code}
\cmd{end}\marg{document}
\end{compactcodebox}

The document class \meta{class-name} and base font size
\meta{cls size opt} are obtained from the
\widget{clssettings.title} tab of the
\dialog{texconfig} dialog (see \sectionref{sec:normalsize}).

In the newer first case, \sty{flowframtkutils} (which loads
\sty{pgf}) and \sty{geometry} are automatically added.
The \sty{flowframtkutils} package defines:
\cmddef{jdroutline}
This is used for any outline \glspl{textarea} (but not
\glspl{textpath}, as outline \glspl*{textpath} are not supported by
the \LaTeX-related export functions.) The package will also load the 
\sty{decorations.text} library if applicable. 

Another command defined \sty{flowframtkutils} which is used in the
export to complete \LaTeX\ document function is:
\cmddef{jdrimagebox}
This is used in case the image turns out to be slightly larger than
calculated. (This could be caused by rounding errors, or the
difference in fonts, as discussed in \sectionref{sec:fontanchor}.)
The \env{pgfpicture} environment is placed inside the argument of
\gls{jdrimagebox} to prevent spurious blank pages occurring.

If the export setting includes the document creation date and
title, this will be set with:
\cmddef{flowframtkimageinfo}
How this is implemented depends on whether or not \sty{hyperref} has
is loaded or of \gls{pdfinfo} is available.
(The document title is obtained from the image description, see
\sectionref{sec:imagedescription}.)

In the older second case, the \sty{ifpdf} package is also loaded
along with the \sty*{pgf} \sty{decorations.text} library, in
case the image contains any \glspl{textpath} as well as defining
\gls{jdroutline} and \gls{jdrimagebox}.
If the export setting includes the document creation date and
title, this will be set with \gls{pdfinfo} if \gls{ifpdf} is true.
The newer first case 
produces shorter code as these commands are already defined.

\begin{information}
If you \hyperref[sec:exportpgf]{export} to a file containing \sty{pgf}
code to be input by another document, you will need to inspect the 
created \ext{tex} file for information regarding required files and
command definitions.
\end{information}

The \gls{preamble.default} code (\meta{Default Preamble}) is set using the
\widget{preambleconfig.title} tab of the \dialog{texconfig} dialog
box (see \sectionref{sec:texconfigpreamble}). This is general code
that applies to all images that are exported to a LaTeX document.

\begin{information}
Note that the \gls{preamble.default} isn't used by the export to package
or class functions.
\end{information}

The \gls{early-preamble} (\meta{Early-Preamble}), 
\gls{mid-preamble} (\meta{Mid-Preamble}) and \gls{late-preamble}
(\meta{Late-Preamble}) code is assigned to a specific image, and can
be used to add any additional \gls{preamble} code required for that image.
For example, if any of the \glspl{textarea} have alternative text
that contains a command that isn't part of the \LaTeX\ kernel, the
\gls{early-preamble} can include the code to load the package that defines
the command or the \glsname{preamble.mid} or \gls{late-preamble} can include the command
definition.

The export to multi-paged PDF function, creates a \LaTeX\ document
that loads the \sty{flowfram} package and defines all flow frames,
static frames and dynamic frames, as per the export to class or
package. In this case, you can provide the \LaTeX\ code to add the
\env{document} environment in the
\widget{texeditor.latexcodeblock.document} panel.

If the document content has cross-references, you can use the
\widget{texeditor.latexcodeblock.magic_comments} panel to add
\glspl{directive} and change the \widget{processes.pdflatex} setting
to a build tool, such as \app{arara}.

If the \widget{texeditor.latexcodeblock.document} content is empty,
blank pages will be created. The number depends on the page lists of
all objects that have \gls{flowframe} data. If all page lists are
simply set to \qt{all}, then only one page will be created. If some
page lists are set to \qt{even} then two pages will be created,
otherwise the number of pages will be determined by the maximum end
range of all page lists.  If a page list has an open-ended range
then the end will be treated as the minimum valid number for that
range.

\menudef{menu.tex.set_preamble}

The \glsname{preamble.early}, \glsname{preamble.mid} and
\gls{late-preamble} code can be edited in the
\gls{preamble} panel attached to the side of the
\gls{canvas} (see \figureref{fig:preambleeditor}). There is a
divider between these two areas that can be moved to adjust the
visible size of each area, allowing one area to take up more or less
room than the other. You can also use the \menu{tex.set_preamble}
menu item to open the preamble panel to its preferred width.

\FloatFig{fig:preambleeditor}
{\includeimg{annotePreamble}}
{The Preamble Panel}

For some \hyperref[sec:lookandfeel]{look and feels}, the
divider has small icons that you can click on to move the divider
part way across the child window or click again to move it all the
way across so that one of the panels is no longer visible. However,
for some look and feels, it's not possible to completely hide the
preamble panel.

\widgetdef{texeditor.latexcodeblock}

The \widget{texeditor.latexcodeblock} panel has four panels.
Each panel has the same layout with a horizontal toolbar and an
editor area below it in which you can type the code. 

The editor area has syntax highlighting. You can change the
\manmsgpl{colour} used or switch off the highlighting using the
\dialog{texeditorui} dialog (\sectionref{sec:texeditorui}).

\widgetdef{texeditor.latexcodeblock.earlypreamble}

The \widget{texeditor.latexcodeblock.earlypreamble} panel is for the 
\inlineglstextdef{preamble.early}, which is typically for package
loading. If the \glspl{textarea-mapping} are enabled (see
\sectionref{sec:texconfigtext}), any
required packages for mapped symbols will automatically be
added to the \gls{early-preamble}.

If you use the \hyperref[sec:exportsty]{export to package or document
class} functions, the \gls{early-preamble} code will be
inserted before the option declarations, which allows you to add
extra options, if required.

\widgetdef{texeditor.latexcodeblock.midpreamble}

The \widget{texeditor.latexcodeblock.midpreamble} panel is for the
\inlineglstextdef{preamble.mid}, which may be used to define
commands for use in any \gls{textarea}['s] alternative \LaTeX\ text.

If you use the \hyperref[sec:exportsty]{export to package or document
class} functions, the \gls{mid-preamble} code will be inserted after
the underlying class or package has been loaded.

\widgetdef{texeditor.latexcodeblock.latepreamble}

The \widget{texeditor.latexcodeblock.latepreamble} panel is for the
\inlineglstextdef{preamble.late}, which may also be used to define
commands for use in any \gls{textarea}['s] alternative \LaTeX\ text.

\widgetdef{texeditor.latexcodeblock.document}

The \widget{texeditor.latexcodeblock.document} panel is for the
\inlineglstextdef{env.document} body. This is only used when
exporting \gls{flowframe} data to a complete \LaTeX\ file
(which is used to create a multi-paged PDF).

\widgetdef{texeditor.latexcodeblock.magic_comments}

The \widget{texeditor.latexcodeblock.magic_comments} panel is only
applicable when creating a complete document, either exporting the
actual image or exporting \gls{flowframe} data to a \LaTeX\ file
(not a class or package). This means that you can replace the
\widget{processes.pdflatex} setting so that a build tool, such as
\app{arara}, may be used instead of \app{pdflatex}.


If you use the \hyperref[sec:exportsty]{export to package or document
class} functions, the \gls{late-preamble} code will be inserted 
at the end of the file, just before
\gls{endinput}. Any instances of \gls{usepackage} found in
the preamble code will be replaced by \gls{RequirePackage}
during the export.

The \widget{texeditor.latexcodeblock.latepreamble} panel is shown in \figureref{fig:preambleeditor2},
where a command has been defined:
\begin{verbatim}
\newcommand*{\bvec}[1]{\boldsymbol{#1}}
\end{verbatim}
This command has been used in the alternative text for one of the
\glspl{textarea} on the \gls{canvas}. The dialog box showing this
alternative text is also visible.

\FloatFig
  {fig:preambleeditor2}
  {\includeimg{preambleeditor2}}
  {The Late-Preamble Tab}

The image's \glsname{preamble.early}, \glsname{preamble.mid} and
\gls{late-preamble} code is stored in \gls{JDR}\slash \gls{AJR}
files, but not for versions less than 1.9, so make sure you use the
latest file version when you save your image. (This is done
automatically if you use \menu{file.save}.) \gls{JDR}\slash\gls{AJR}
version 1.8, introduced in \FlowframTk\ version 0.7, only stores the
\gls{early-preamble} code.  \FlowframTk\ version 0.8
(\gls{JDR}\slash\gls{AJR} v1.9) introduced \gls{mid-preamble} and
\gls{late-preamble} panels. The original preamble panel (which was
previously just in a dialog window) is now referred to as the
\gls{early-preamble}.

\section{\TeX\ Editor}\label{sec:texeditor}

The \TeX\ editor is used for the \widget{texeditor.latexcodeblock} panels,
the \dialog{preambleconfig} dialog (\sectionref{sec:texconfigpreamble}),
and for the static and dynamic frame contents dialog.

\menudef{index.menu.texeditor}

The \gls{index.menu.texeditor} \gls*{popupmenu} can be activated with a \gls{menuclick}.
Alternatively, you can use the \accelerator{popup} key or, if supported by your
system, the \accelerator{context_menu} \gls{context-menu} key.
The buttons on the toolbar may be used instead of the popup menu.

\menudef{menu.texeditor.undo}%
The \menu{texeditor.undo} function undoes the last edit. Note that
this is separate to the \menu{edit.undo} menu item for edits to the
image on the \gls{canvas}. Each panel has its own independent
undo\slash redo manager.

\menudef{menu.texeditor.redo}%
The \menu{texeditor.redo} function redoes the last undone edit. Note that
this is separate to the \menu{edit.redo} menu item for edits to the
image on the \gls{canvas}.

\menudef{menu.texeditor.selectAllText}%
The \menu{texeditor.selectAllText} function selects all the text in
preamble panel that has the focus.

\menudef{menu.texeditor.cutText}%
The \menu{texeditor.cutText} function cuts the selected text in the
preamble panel that has the focus to the clipboard.

\menudef{menu.texeditor.copyText}%
The \menu{texeditor.copyText} function copies the selected text in the
preamble panel that has the focus to the clipboard.

\menudef{menu.texeditor.pasteText}%
The \menu{texeditor.pasteText} function pastes text from the
clipboard into the preamble panel that has the focus.

\menudef{menu.texeditor.find}%
The \menu{texeditor.find} function opens the \dialog{find}
dialog.

\widgetdef{find.title}%
The \dialog{find} dialog has a text field where you can enter your
search term. 

\widgetdef{find.case}%
Select the \widget{find.case} checkbox for a case-sensitive search.

\widgetdef{find.regex}%
Select the \widget{find.regex} checkbox if the search term is a
regular expression.

\widgetdef{find.wrap}%
Select the \widget{find.wrap} checkbox to wrap round to the start.

\widgetdef{find.find}%
The \widget{find.find} button will find the first occurrence of the
search term from the position of the cursor.

\menudef{menu.texeditor.find_again}%
The \menu{texeditor.find_again} function finds the previous
search term.

\menudef{menu.texeditor.replace}%
The \menu{texeditor.replace} function opens the
\dialog{replace} dialog.

\widgetdef{replace.title}%
The \dialog{replace} dialog has the same buttons as the
\dialog{find} dialog but also has a text field where you can enter
the replacement text.

\widgetdef{replace.replace}%
The \widget{replace.replace} button will replace the found text.

\widgetdef{replace.replace_all}%
The \widget{replace.replace_all} button will replace all occurrences.

\seealsorefs{
 sec:texconfig,
 sec:texeditorui,
 sec:exportimage
}

\section{Computing the Parameters for \glsfmttext{parshape}}\label{sec:parshape}

\menudef{menu.tex.parshape}

\TeX's \gls{parshape} command can be used to change a
standard rectangular shaped paragraph into a non-rectangular
shape. The syntax is:
\cmddef{parshape}
where \meta{i\textsubscript{1}} is the indent for
the first line and \meta{l\textsubscript{1}} is
the length of the first line, etc.  This command should be placed at
the start of the paragraph, and is only applied to that paragraph.
If there are more than \meta{n} lines in the
paragraph, the specification for the \meta{n}th
line will be used until the end of the paragraph. If there are less
than \meta{n} lines in the paragraph, the shape
will be truncated. See \emph{The \TeX{}book}~\cite{Knuth} for further
details.

Since each line in the paragraph is constructed from only indent and
line width information, only certain types of shapes can be
specified by a \gls{parshape}. If you imagine horizontal
scan lines passing \manmsg{through} the shape, each scan line should not
be able to intersect the boundary of the shape more than twice.

Before you use \FlowframTk\ to determine the parameters for
\gls{parshape}, you must first ensure that you have set the
\gls{normal-font-size} (\sectionref{sec:normalsize}) to the value
used in your document. See, for example, \figureref{fig:news26} (in
\sectionref{sec:newstutorial}) which illustrates what happens when
you fail to do this.

\widgetdef{parshape.title}

To determine the parameters for a \gls{parshape}, create your shape
as a single \gls{path}. Select this \gls*{path}, and use the menu
item \menu{tex.parshape}.  This will open up the \dialog{parshape} dialog box.

\widgetdef{parshape.use_path}

Select the \widget{parshape.use_path} radio button if you want to
use the outline defined by the action \gls{path}.

\widgetdef{parshape.use_outline}

Select the \widget{parshape.use_outline} radio button if you want to
use the outline defined by the line style (stroked path).

For example, \figureref{fig:parshapeex1a} shows a \gls*{path}
which consists of a single line segment (shown in
\figureref{fig:parshapeex1b}), but with a
\pathattr{line-width} of 52\gls{bp}, butt
\pathattr{cap-style} and an equilateral triangle
start \pathattr{marker} of size 80bp.  If you
select the \widget{parshape.use_path} option, \FlowframTk\
will attempt to construct the parameters from the actual \gls*{path}
(ignoring the line style) which it will not be able to do, as the
\gls*{path} has no area. If you select the
\widget{parshape.use_outline} option, \FlowframTk\ will
construct the parameters from the outline as seen on the screen.
These parameters can be saved to a file, and used in a \TeX\ or
\LaTeX\ document to create a shaped paragraph
(\figureref{fig:parshapeex1c}).

\FloatSubFigs{fig:parshapeex1}[\small]
{
  {fig:parshapeex1a}{\includeimg{parshapeex1a}}{},
  {fig:parshapeex1b}{\includeimg{parshapeex1b}}{},
  {fig:parshapeex1c}{\includeimg{parshapeex1c}}{}
}
[Parshape (Using Outline)]
{Parshape \widget{parshape.use_outline}:
\subfigref{fig:parshapeex1a} path consisting of
single line segment with 52bp line width, butt cap and 80bp filled
equilateral triangle start marker;
\subfigref{fig:parshapeex1b} the actual path
defined in \subfigref{fig:parshapeex1a} without the line style applied;
\subfigref{fig:parshapeex1c}
\gls{parshape} parameters constructed from the outline
\subfigref{fig:parshapeex1a} used to create an arrow shaped paragraph in a \LaTeX\
document.}

Another example is shown in \figureref{fig:parshapeex2}. In this
example, the \gls*{path} was constructed using the ellipse tool. If you
select the \widget{parshape.use_path} option, \FlowframTk\ will compute the
parameters used to create the paragraph shown in
\figureref{fig:parshapeex2b}. In this example, you will not be
able to use the \widget{parshape.use_outline} option as this will attempt to
create an annulus defined by the \gls*{path}['s] border, which can't be
done by \gls{parshape} (but can be done by \gls{shapepar},
although it is not recommended for such a narrow line width).

\FloatSubFigs{fig:parshapeex2}[\small]
{
 {fig:parshapeex2a}{\includeimg{parshapeex2a}}{},
 {fig:parshapeex2b}{\includeimg{parshapeex2b}}{}
}
[Parshape (Using Path)]
{Parshape \widget{parshape.use_path}:
\subfigref{fig:parshapeex2a} the path;
\subfigref{fig:parshapeex2b} \gls{parshape} parameters constructed from the 
path \subfigref{fig:parshapeex2a}
used to create an elliptical shaped paragraph in a \LaTeX\ document.}

Whilst the parameters are being computed, the horizontal
scan lines used by \FlowframTk\ will appear on screen, and if
successful, a dialog box will appear for you to save the
\gls{parshape} command to a file. You can then input this
file at the start of the appropriate paragraph in your \TeX\ or
\LaTeX\ document. For example, if you save the \gls{parshape}
command to a file called, say, \filefmt{myparshape.tex}, then if
you are using plain \TeX\ you would need to do:
\begin{verbatim}
\input myparshape
This is the start of the paragraph...
\end{verbatim}
or if you are using \LaTeX\ you would need to do:
\begin{verbatim}
\input{myparshape}%
This is the start of the paragraph...
\end{verbatim}
You may want to suppress the paragraph indentation using
\gls{noindent}:
\begin{verbatim}
\input{myparshape}%
\noindent This is the start of the paragraph...
\end{verbatim}

The distance between the scanlines is given by the
value of \gls{baselineskip} for the \gls{normal-font-size}.
For example, if the normal font size is 10\gls{pt}, \gls{baselineskip}
will be 12pt, and this will be the distance used between
the scanlines. It is therefore important that you set the value
for the \gls{normal-font-size} before using this function.

\seealsorefs{
  sec:normalsize,
  sec:framedef
}

\section{Computing the Parameters for \glsfmttext{shapepar} or
\glsfmttext{Shapepar}}
\label{sec:shapepar}

\menudef{menu.tex.shapepar}

The \gls{parshape} command is fairly limited. You need the right
amount of text in the paragraph to get the shape right, and you
can't have cut out sections. These two things can be overcome using
the \inlineglsdef{shapepar} or \inlineglsdef{Shapepar} commands
defined in the \sty{shapepar} package. The syntax for these commands
is complex and those interested should read the \sty{shapepar}
documentation. As with \gls{parshape}, the shape is constructed
using horizontal scan lines. If you want gaps to appear in your
shape, make sure to set the \pathattr{winding-rule}
(\sectionref{sec:winding}) to even-odd.  If in doubt, give the
\gls{path} a \pathattr{fill-paint}; the area that is filled will
contain the text of the paragraph, and the area that isn't filled
won't.

\begin{information}
\FlowframTk\ defaults to using \gls{Shapepar} rather than
\gls{shapepar}, but you can change this in the
\dialog{texconfig} dialog (\sectionref{sec:texconfig}).
\end{information}

To determine the parameters for \gls{Shapepar}\slash\gls{shapepar}, create
your shape as a single \gls*{path}. Select this \gls*{path}, and use
the \menu{tex.shapepar} menu item, which will open the
\dialog{shapepar} dialog.

\widgetdef{shapepar.title}

The \dialog{shapepar} dialog has the same \widget{parshape.use_path}
and \widget{parshape.use_outline} radio buttons as the
\dialog{parshape} dialog, which allow you to select
whether you want to use the \gls*{path} itself to define the shape
or whether you want to use the \gls*{path}['s] outline to define the shape.
For example, \figureref{fig:shapeparexa} shows a \gls*{path} with a
40bp line width. The \gls{shapepar} parameters were constructed
first from the \gls*{path} (\figureref{fig:shapeparexb}) and then from
the outline (\figureref{fig:shapeparexc}).

\FloatSubFigs*{fig:shapeparex}[\small]
{
  {fig:shapeparexa}{\includeimg{shapeparexa}}{},
  {fig:shapeparexb}{\includeimg{shapeparexb}}{},
  {fig:shapeparexc}{\includeimg{shapeparexc}}{}
}
[Shapepar Example]
{Shapepar example:
\subfigref{fig:shapeparexa} the path;
\subfigref{fig:shapeparexb} parameters constructed from the path and included in a
\LaTeX\ document to produce a shaped paragraph;
\subfigref{fig:shapeparexc}
parameters constructed from the path's outline and included in a
\LaTeX\ document to produce a shaped paragraph.}

As with the parshape function, the horizontal
scan lines used by \FlowframTk\ will appear on screen, and if
successful, a dialog box will appear for you to save the
\gls{Shapepar}\slash\gls{shapepar} command to a file. You can then input this
file at the start of the appropriate paragraph in your \TeX\ or
\LaTeX\ document. For example, if you save the
command to a file called, say, \filefmt{myshapepar.tex}, then if
you are using plain \TeX\ you would need to do:
\begin{verbatim}
\input myshapepar
This is the start of the paragraph...
\end{verbatim}
or if you are using \LaTeX\ you would need to do:
\begin{verbatim}
\input{myshapepar}%
This is the start of the paragraph...
\end{verbatim}
Remember to include the \sty{shapepar} package:
\begin{itemize}
\item \verb|\input shapepar.sty| (plain \TeX)
\item \verb|\usepackage{shapepar}| (\LaTeX)
\end{itemize}


\seealsorefs{
  sec:normalsize,
  sec:texconfig,
  sec:busexample,
  sec:framedef
}

\section{Creating Frames for Use with the \stytext{flowfram} Package}
\label{sec:flowframe}

\pkgdef{flowfram}

\FlowframTk\ can be used to help construct frames for use with the
\sty{flowfram} package. If you are unfamiliar with this
package, please ensure that you read the user manual.
\texdocref{flowfram}

\subsection{The \stytext{flowfram} Package: A Brief Summary}
\label{sec:flowframesummary}

The \sty{flowfram} package is a \LaTeX\ package that allows
the user to construct frames in a document, such that the document
text flows from one frame to the next in the order that the
frames were defined. The mechanism is much the same as that used
to create the columns when using the standard two column mode, but
the columns are of arbitrary width, height and position.

Imagine that you have a number of rectangular sheets of transparent
paper. You start writing on the first sheet until it's filled, then
you put it aside and start writing on the next until that one's
filled as well, and so on. When you've filled all the sheets, pick
up the first one and glue it onto your page in your desired
location, then pick up the next one and glue that onto the page, and
so on. If you've glued one sheet down so that it overlaps another,
the text on the top sheet will obscure the text on the lower sheet.

There are three types of frame defined by the \sty{flowfram}
package: \qt{flow} frames
which are the main type of frame. These are the frames in which the
document text is placed and they are analogous to the transparent
sheets of paper example described above. The other two types of frame are
called \qt{static} and \qt{dynamic}.  The contents of these frames has
to be set explicitly using one of the commands or environments
provided by the \sty{flowfram} package.

The contents of the static frames are typeset once (when the
contents are set) and it remains unchanged until the user explicitly
resets the contents. (Static frames have an associated box defined
via \csfmt{newbox} in which the contents are stored.) The contents
of the dynamic frames are re-typeset on each page for which the
frame is defined. (The contents are stored in a macro rather than in
a box.)

So, for example, if on page~1 of your document, you set the contents
of a static frame to contain the command \gls{thepage}, the
contents of that frame will always display a~1 (no matter what page
it appears on), since that was the value of \gls{thepage} when
the contents were set. If, on the other hand, you use a dynamic
frame, the contents will be re-typeset on every page, so it will
display the relevant page number.

Each frame has an associated label which uniquely identifies it for
a given frame type, and the frame can optionally have a border. Frames also
have an associated page list indicating on which pages the frame
should appear.  The page list can be one of the keywords
\optfmt{all}, \optfmt{odd}, \optfmt{even} or \optfmt{none}, or it
can be a comma separated list of pages or page ranges (e.g.\
\verb|<4,7,9,10-14,>20|). By default, the \sty{flowfram} package
assumes these numbers refer to the decimal value of the
\ctr{page} counter (so 9 means the frame is visible on page 9, on
page ix, on page IX, or even on page nine, if you've redefined
\gls{thepage} to use a number string). The \sty{flowfram}
package provides the option \optval{pages}{absolute}, which indicates
that the page lists refer to the absolute page number rather than
the value of the \ctr{page} counter. So if your document pages
are numbered, say, 1, i, ii, iii, 1, 2, 3, then the absolute page 3
is the page numbered ii, since it's the third page of the document.

The \sty{flowfram} package stacks the frames on the page in
the following order: static, flow and dynamic, each in the order
in which they were defined. For example, if you define a flow frame
called \optfmt{left}, then define a static frame called
\optfmt{title}, then a dynamic frame called \optfmt{header}
and lastly a flow frame defined \optfmt{right}, then the
\sty{flowfram} package will stack the frames in the following
order: \optfmt{title}, \optfmt{left}, \optfmt{right} and
\optfmt{header}. This means that the static frames can be used for
background effects.

When exporting to a package or class file (\sectionref{sec:exportsty}),
\FlowframTk\ will define the frames according to its own
\gls{stackingorder}. However, it will allow you to position, say, a
static frame above a flow frame when displayed on the \gls{canvas}.
The object with the static frame data may obscure the other object
when viewed in \FlowframTk, but it will appear in the background
when displayed in the document.

\menudef{menu.tex.flowframe.clear}

To clear all data relating to the \sty{flowfram} package,
select the menu item \menu{tex.flowframe.clear}.

\seealsorefs{
  sec:postertutorial,
  sec:newstutorial,
  sec:brochure
}

\subsection{Defining the Typeblock}\label{sec:typeblock}

The \inlineglsdef{typeblock} is the main area of the page where the text goes.
The dimensions of the \gls{typeblock} are given by the \LaTeX\ lengths
\gls{textwidth} and \gls{textheight}. It's possible to
define frames that are positioned outside of the \gls{typeblock}, but the
\gls{typeblock} provides a frame of reference and, unless otherwise
instructed, the page header and footer will be placed above and
below the \gls{typeblock} according to \LaTeX's standard page layout
design.

Note that the \opt{twoside} class option will typically
shift the typeblock on the even (\gls{verso}) pages (via the
\gls{evensidemargin} length) whereas the
\opt{oneside} class option won't. Different classes have
different default settings. For example, the \cls{article} and
\cls{report} classes default to \opt{oneside} but the
\cls{book} class defaults to \opt{twoside}. This setting also
affects the running headers and footers.

\menudef{menu.tex.flowframe.set_typeblock}

In \FlowframTk, you specify the \gls{typeblock} using the
\menu{tex.flowframe.set_typeblock} menu item.  This
opens up the \dialog{typeblock} dialog box.

\widgetdef{typeblock.title}

In the \dialog{typeblock} dialog you can enter the margins
between the paper edge and the \gls{typeblock}. You can either type the
lengths into the supplied fields or, if you have a \gls{path}
selected, you can get \FlowframTk\ to calculate the margins for a
\gls{typeblock} that fits the \gls{path}['s] bounding rectangle by
clicking on the \widget{typeblock.compute_from_path} button.
(This button is disabled if no \gls*{path} is selected.)

For example, \figureref{fig:typeblocka} shows a \gls*{path} that
has been created using the \tool{rectangle} on the
\widget{grid.tschichold} grid (\sectionref{sec:gridmenu}). This was then selected and the
\dialog{typeblock} dialog was opened. The
\widget{typeblock.compute_from_path} button was clicked
which then filled in the values for the margins.

\FloatSubFigs*{fig:typeblock}
{
  {fig:typeblocka}{\includeimg{typeblocka}}{},
  {fig:typeblockb}{\includeimg{typeblockb}}{},
  {fig:typeblockc}{\includeimg{typeblockc}}{},
  {fig:typeblockd}{\includeimg{typeblockd}}{},
  {fig:typeblocke}{\includeimg{typeblocke}}{}
}
[Setting the Typeblock]
{Setting the typeblock:
\subfigref{fig:typeblocka} a rectangle has been drawn on
a Tschichold grid;
\subfigref{fig:typeblockb} the margins computed from the
selected rectangle;
\subfigref{fig:typeblockc} the top and left margins were
manually rounded to the nearest point by the user and then the
adjust width function was used which changed the right margin;
\subfigref{fig:typeblockd} the adjust height function was used to change the
bottom margin;
\subfigref{fig:typeblocke} the compute function was used to
change the even page shift}

It's possible you might want to round the left and top margins to
the nearest unit. In which case you can do so by editing the
\widget{flowframe.margins.left} and
\widget{flowframe.margins.top} fields. Additionally, you
might want to adjust the right margin so that the
\gls{typeblock} width is rounded to, say, the nearest whole mm or whole or half
pc. To do this, type in the required value in the
\widget{typeblock.adjust_width_label} field (for example
1pc) and click on the \widget{typeblock.adjust_width}
button. For example, I changed the left margin to 66\gls{pt} and the
top margin to 94\gls{pt}. The
\widget{typeblock.adjust_width_label} was already set to
1pc, so I left it at that and clicked on the
\widget{typeblock.adjust_width} button. This filled in the
right and bottom margins as shown in \figureref{fig:typeblockc}.

You can also adjust the bottom margin so that the \gls{typeblock} height
is rounded to the nearest baselineskip or another value such as 1in.
To round to the nearest baselineskip, make sure the
\widget{typeblock.use_baseline} button is selected otherwise
make sure the \widget{typeblock.use_other} button is
selected and enter the required amount in the field. Then click on
the \widget{typeblock.adjust_height} button. For example, in
\figureref{fig:typeblockd} the bottom margin has been adjusted to
ensure the \gls{typeblock} height is rounded to the nearest baselineskip.

\begin{warning}
Rounding errors may occur that caused by the conversion between
units. If you later change the \gls{normal-font-size}
(\sectionref{sec:normalsize}),
you may need to readjust the \gls{typeblock} height.
\end{warning}

Finally, if you use the \opt{twoside} class option, you can get
\FlowframTk\ to adjust the value of \gls{evensidemargin}.
\widget{typeblock.hshift} is the difference between
\gls{evensidemargin} and \gls{oddsidemargin}. If the value
in the \widget{typeblock.hshift} field is non-zero, when you
export (\sectionref{sec:exportsty}) to a class or package, 
\FlowframTk\ will add the commands:
\begin{compactcodebox}
\cmd{setlength}\gls{evensidemargin}\{\gls{oddsidemargin}\}
\cmd{addtolength}\gls{evensidemargin}\{\meta{h-shift}\}
\end{compactcodebox}%
where \meta{h-shift} is the length specified in the
\widget{typeblock.hshift} field. If you specify a zero
length, \gls{evensidemargin} won't be adjusted, but the
typeblock may not be displayed correctly when you display even
pages in \FlowframTk. Remember that \gls{evensidemargin} is
ignored if you use the \opt{oneside} class option.


If you find it a bit complicated to work out the appropriate shift,
you can use the \widget{typeblock.compute_sym_shift} button,
which will work out the shift assuming a symmetric page layout. For
example, in \figureref{fig:typeblocke} I clicked on
\widget{typeblock.compute_sym_shift} and it altered the
value in the \widget{typeblock.hshift} field.

Once you have set the \gls{typeblock}, it will appear on the screen as
a light \manmsg{grey} rectangle, \manmsg{labelled} \qt{typeblock}. In
\figureref{fig:typeblockshown} I removed the \gls{path} (using
\menu{edit.cut}) that I had used to calculate the \gls{typeblock}. The
\gls{typeblock} is slightly smaller than the \gls*{path} as a result of
the adjustments made.

\FloatSubFigs{fig:typeblockshown}
{
 {fig:typeblockshown-verso}{\includeimg{typeblockshown-verso}}{},
 {fig:typeblockshown-recto}{\includeimg{typeblockshown-recto}}{}
}
[The typeblock is shown as a light \manmsg{grey} rectangle]
{The typeblock is shown as a light \manmsg{grey} rectangle:
\subfigref{fig:typeblockshown-verso} verso;
\subfigref{fig:typeblockshown-recto} recto}

\subsection{Defining a Frame}\label{sec:framedef}

\menudef{menu.tex.flowframe.set_frame}

An \gls{object} can be identified as a flow, static or
dynamic frame as follows: select the \gls{object} (it should
be the only \gls*{object} selected) then select the
\menu{tex.flowframe.set_frame} menu item.
This will open up the \dialog{flowframe} dialog box in which you can specify the frame's
attributes. 

\widgetdef{flowframe.title}

Initially only the \widget{flowframe.type} field
is enabled (as shown in \figureref{fig:setframe}) since all the other
fields aren't valid for type \widget{flowframe.none}.

\begin{warning}
Make sure you set the \gls+{typeblock} before you set any frames.
If you later adjust the \gls{typeblock}, you may need to readjust the even
shifts for all frames that may be displayed on \gls{verso} pages.
\end{warning}

\FloatFig{fig:setframe}
{\includeimg{setframe}}
{Frame Attributes Dialog Box}

Once an \gls*{object} has been identified as a frame, a
\manmsg{grey} rectangle will appear on the screen indicating the area in
which the contents of the frame will be typeset, along with the
frame's type, identification label and page list.

\begin{information}
Note that if the \gls*{object} is a \gls{group}, the frame
information will be applied to the whole group. This means you can
construct a frame border by grouping several objects, however, if
you later ungroup this \gls*{object}, you will lose the frame
information.
\end{information}

\widgetdef{flowframe.type} 

The frame's type is specified using the 
\widget{flowframe.type} \gls*{dropdown}. There is a choice of:
\widget{flowframe.flow}, \widget{flowframe.static},
\widget{flowframe.dynamic} or \widget{flowframe.none}.
\widget{flowframe.none} indicates that the \gls{object} has
no associated flowframe data, which means that the object will not
be saved if the image is exported to a \LaTeX\ package or
class (\sectionref{sec:exportsty}).

\widgetdef{flowframe.label}

Each frame is assigned a \inlineglstextdef{frame-label} so that it can be referenced in the
document. Each label must be unique for its given frame type.  To
assign a label to the selected frame, enter it in the box
marked \widget{flowframe.label}.

There are four dynamic frame labels that have a special meaning for
\FlowframTk: \inlineglsdef{opt.frame-label.header},
\inlineglsdef{opt.frame-label.footer},
\inlineglsdef{opt.frame-label.evenheader} and
\inlineglsdef{opt.frame-label.evenfooter}. These indicate that the frame should be converted
into the page header or footer frame (analogous to the
\sty{flowfram} package's \gls{makedfheaderfooter} command).
If you use any of these special labels, when you export to a package or
class file, \FlowframTk\ will modify \LaTeX's standard page style
mechanism to hide the header and footer frames when you use the
\pagestyleref{empty} page style, hide just the header when you use the
\pagestyleref{plain} page style and hide just the footer when you use the
\pagestyleref{headings} page style. If you only define a header frame but
no footer frame, \FlowframTk\ will switch on the \pagestyleref{headings}
page style. If you only define a footer frame but no header frame,
\FlowframTk\ will switch on the \pagestyleref{plain} page style. If you
define both a header and a footer frame, \FlowframTk\ will switch to
its own custom page style called \pagestyleref{flowframtk} that puts
\gls{leftmark} or \gls{rightmark} in the header and
\gls{thepage} in the footer. This custom page style is
only defined if you have a header or footer frame.

\begin{important}
The \framelabelref{header}, \framelabelref{footer},
\framelabelref{evenheader} and \framelabelref{evenfooter} 
\glspl{frame-label} only have a special significance for dynamic frames.
\end{important}

The \framelabelref{evenheader} and \framelabelref{evenfooter} labels are provided
in case you want to have a different frame for even pages. This will
typically only be necessary if you want a different border or frame
dimensions for the header or footer on even pages, as the
even page horizontal shift is usually sufficient.

\widgetdef{flowframe.border}

The \widget{flowframe.border} \gls*{dropdown} allows you
to specify whether the frame has a border. If the option
\widget{flowframe.border_as_shown} is set, then the
\gls{object} will be drawn as the frame's border. If the option
\widget{flowframe.border_none} is set, then the frame will
not be given a border, and the object will be used only as an
indication of the frame's width, height and location (and
possibly shape, see \sectionref{sec:frameshape}).

Note that all \glspl{textarea} are considered to be a part of the
frame's background, not the frame's contents, and will only appear if
the border \widget{flowframe.border_as_shown} setting is
applied. Likewise for \glspl{bitmap}. The border is not available
for non-standard paragraph shapes (\sectionref{sec:frameshape}).

\widgetdef{flowframe.pages}

You can specify the page list on which the frame is defined, using the
\widget{flowframe.pages} \gls*{combobox}. Either select one of:
\widget{flowframe.pages_all},
\widget{flowframe.pages_none},
\widget{flowframe.pages_odd} or
\widget{flowframe.pages_even}, or you can type in a comma
separated list of pages or page ranges (e.g. \verb|1-10,12,14,>20|).
The page references are as described in
\sectionref{sec:flowframesummary}. Use the
\widget{flfsettings.pages_opt} section of the
\dialog{texconfig} dialog (\sectionref{sec:texconfig}) to
specify whether the page list uses absolute or relative numbers.

\widgetdef{flowframe.border_as_shown}

The frame may have margins between the border and the area in which
the contents are typeset. The margins are usually only relevant
if you have specified the \widget{flowframe.border_as_shown}
border option. The margins are not available for non-standard
paragraph shapes (\sectionref{sec:frameshape}).

\widgetdef{flowframe.align}

You can change the vertical alignment of the contents of a static or
dynamic frame using the \widget{flowframe.align} \gls{dropdown}.
This can be one of: \widget{flowframe.align_top},
\widget{flowframe.align_middle} or \widget{flowframe.align_bottom},
which correspond to the settings \setframeoptval{valign}{t},
\setframeoptval{valign}{c} and \setframeoptval{valign}{b},
respectively, provided by \gls{setdynamicframe} and
\gls{setstaticframe}. This facility is not available for flow
frames.

\widgetdef{flowframe.compute_sym_x_shift}

By default, the frame location on even pages is the same
\strong{relative to the \gls+{typeblock}} as on odd pages. You can override this by
specifying a shift to apply to the location when the frame is
displayed on an even page. \emph{However, this setting only has an effect
if you use the \opt{twoside} class option.} This is usually
the default for classes such as \cls{book}, but not for classes
such as \cls{article} or \cls{report}. Typically, only the
horizontal shift may be needed for two-sided documents, but if for some
reason you require a vertical shift that option is provided. In most
cases, the horizontal shift is used to create a symmetric page
layout (by which I mean the frame locations are symmetric not the
frame borders). For convenience, the
\widget{flowframe.compute_sym_x_shift} button will work out
the appropriate horizontal shift to create a symmetric layout, given
the current frame position and \gls{typeblock} margins. If you later move
the \gls{object} or modify the margins you will need to update the
horizontal shift.

\begin{warning}
If the \gls{typeblock} has an even page shift, remember to take this into
account when setting the even shift for the frames. You can check
the frame's position on even pages using the \dialog{displaypage}
dialog (\sectionref{sec:displaypage}).
\end{warning}

\widgetdef{flowframe.contents}

As described in \sectionref{sec:flowframesummary}, the contents of
static and dynamic frames need to be explicitly set using commands
or environments provided by the \sty{flowfram} package. For your
convenience, \FlowframTk\ provides a way for you to specify the
contents and will use the appropriate commands when you export to a
package or class file.
To add or edit the contents, click on the
\widget{flowframe.edit} button, which will open
\FlowframTk's little \TeX\ editor.

\begin{important}
You can't use verbatim text in the contents.
\end{important}

If your frame has been assigned the
\widget{flowframe.dynamic} type and has been given one of
the special dynamic labels \framelabelref{header}, \framelabelref{footer},
\framelabelref{evenheader} or \framelabelref{evenfooter}, as described above,
setting the contents has a different effect. The code you provide in
the contents is inserted into the header or footer to enable you to
modify the formatting. Note that you shouldn't use commands like
\gls{thepage}, as that will be done automatically. It's best to
stick to declarations, such as \gls{bfseries}, although the
final command may be a text-block command, such as \gls{textbf},
as it is typically followed by \gls{thepage} or the header mark.

\subsection{The Frame Shape}\label{sec:frameshape}

The text in flow frames is typeset using the standard rectangular
format, but the contents of static or dynamic frames can be shaped. If you
have selected a \gls{path}, you can enable
this by selecting either \widget{flowframe.shape_parshape}
or \widget{flowframe.shape_shapepar} from the
\widget{flowframe.shape} \gls*{dropdown}. Note that the
shape option is not available for any other type of \gls{object}.
  
If you use the \widget{flowframe.shape_parshape}
or \widget{flowframe.shape_shapepar} options, it will only
check if a set of valid parameters can be extracted from the
\gls*{path} when you export (\sectionref{sec:exportsty}) the image as a \LaTeX\
class or package. (Otherwise it would have to re-evaluate the
parameters every time you edit the path.) Note, however, that the
paragraph shape in your document may not exactly match the shape you
created in \FlowframTk.

\widgetdef{flowframe.shape_parshape}

If you select \widget{flowframe.shape_parshape}, the frame contents
will be shaped using \gls{parshape}.

\begin{itemize}
\item If there are not enough words in the paragraph to fill the
shape, the shape will be truncated.
\item If there are too many words in the paragraph, the dimensions
of the final line of the shape will be repeated for each
subsequent line.
\end{itemize}

\widgetdef{flowframe.shape_shapepar}

If you select \widget{flowframe.shape_shapepar}, the frame contents
will be shaped using either \gls{shapepar} or \gls{Shapepar},
according to the \widget{flfsettings.shapeparcs} setting
(\sectionref{sec:texconfigflf}).

\begin{itemize}
\item If there are not enough words in the paragraph to fill the 
shape, the shape will shrink.
\item If there are too many words in the paragraph, the shape
will expand.
\end{itemize}

To illustrate this, consider the layout shown in 
\figureref{fig:parshape-poster1}. There are six identical circles
arranged in two rows. Each circle has been identified as a static
frame. Their bounding boxes can be seen as light \manmsg{grey} rectangles.
The top three circles have all been assigned a shape given by
\gls{parshape}, while the bottom three circles have been
assigned a shape given by \gls{shapepar}.

\FloatFig{fig:parshape-poster1}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{parshape-poster1}}
[Layout Containing Six Circles]
{Layout containing six circles. All circles have been
identified as static frames. The top three circles have been
assigned a shape given by \gls{parshape}. The bottom
three circles have been assigned a shape given by
\gls{shapepar}.}

This layout was exported (\sectionref{sec:exportsty}) as a \LaTeX\
package based on the \sty{flowfram} package, and was included
into a document. Each of the static frames were filled with a
varying amount of text.  The leftmost circles do not have enough
text to fill the designated area, while the rightmost circles have
too much text.  (See \figureref{fig:parshape-poster2}.)

\FloatFig{fig:parshape-poster2}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{parshape-poster2}}
[The Effects of Too Much and Too Little Text]
{The effects of too much and too little text. The top row uses
\gls{parshape}: (\emph{top left}) too little text truncates
the shape; (\emph{top right}) too much text replicates the dimension
of the last line of the shape. The bottom row uses
\gls{shapepar}: (\emph{bottom left}) too little text shrinks
the shape; (\emph{bottom right}) too much text expands the shape.
(The contents of the static frames were all set to a central
vertical alignment.)}

Note that when you use a non-standard paragraph shape, you can
no longer specify the margins. Since the paragraph shape is defined
by the \gls{path}, the margins don't have any meaning. If you want
a border effect, you can make a slightly larger object behind, and
set the border of the larger object to
\widget{flowframe.border_as_shown} and the border of the
smaller object to \widget{flowframe.border_none}, but
remember that the overall effect will depend on the amount of text
contained in the frame.

\subsection{Scale Object to Fit Typeblock}\label{sec:scaletotypeblock}

\menudef{menu.tex.flowframe.scale_to_typeblock}

In addition to the \affinetrans{scaling} function described in
\sectionref{sec:scaleobjects}, if you have set the \gls+{typeblock}, you can scale
selected \glspl{object} so that they fit the \gls{typeblock} area using the
\menu{tex.flowframe.scale_to_typeblock} menu item.
Note that this may change the aspect ratio of the scaled
\glspl*{object}.

\subsection{Only Displaying Objects Defined on a Given Page}\label{sec:displaypage}

\menudef{menu.tex.flowframe.display_page}

It is possible to display only those frames that are defined on a
given page. The \menu{tex.flowframe.display_page} menu item will
open the \dialog{displaypage} dialog box.

\widgetdef{displaypage.title}

You can select to display those frames that are defined
on all pages or just those that are defined on odd or even pages or
you can specify a particular page number by selecting the
\widget{displaypage.user} radio button and entering the
relevant page number in the text field. If you specify \qt{0}, only
those frames that have the \widget{flowframe.none} page
setting will be displayed.  Note that \glspl{object} that have not
been assigned \gls{flowframe} data will always be displayed.  The title
bar will indicate how many objects have been hidden.

It's generally best to apply transformations or edits with the
\widget{displaypage.all} setting on. If you move an \gls{object}
when the \gls{verso} (even) page is displayed, the \gls*{object}['s]
\gls{recto} position will be moved by the same amount. The only way
to have a different \gls*{verso} position is to apply an even page
shift in the \dialog{flowframe} dialog (or to apply an even page
shift to the \gls{typeblock}).

\chapter{Step-by-Step Examples}\label{sec:tutorials}

The examples in this section illustrate various aspects of
\FlowframTk.

\begin{deflist}
\itemtitle{\sectionref{sec:houseexample}}
\begin{itemdesc}
\nameref{sec:houseexample} illustrates the basics:
how to create filled rectangles and a closed line \gls{path}.
\end{itemdesc}

\itemtitle{\sectionref{sec:toastexample}}
\begin{itemdesc}
\nameref{sec:toastexample} illustrates editing paths.
\end{itemdesc}

\itemtitle{\sectionref{sec:cheeseexample}}
\begin{itemdesc}
\nameref{sec:cheeseexample} illustrates merging paths.
\end{itemdesc}

\itemtitle{\sectionref{sec:neuronexample}}
\begin{itemdesc}
\nameref{sec:neuronexample} illustrates
line styles, text areas and justifying. Also illustrates
how to specify different text to use when exporting to a
\LaTeX\ file.
\end{itemdesc}

\itemtitle{\sectionref{sec:busexample}}
\begin{itemdesc}
\nameref{sec:busexample} illustrates
path functions, and using the shapepar function.
\end{itemdesc}

\itemtitle{\sectionref{sec:postertutorial}}
\begin{itemdesc}
\nameref{sec:postertutorial} illustrates how to
use \FlowframTk\ to create frames for use with the \sty{flowfram}
package.
\end{itemdesc}

\itemtitle{\sectionref{sec:newstutorial}}
\begin{itemdesc}
\nameref{sec:newstutorial} illustrates how to
use \FlowframTk\ to create non-standard shaped frames for use with the
\sty{flowfram} package.
\end{itemdesc}

\itemtitle{\sectionref{sec:brochure}}
\begin{itemdesc}
\nameref{sec:brochure} illustrates how to use \FlowframTk\
to create \gls{recto}\slash\gls{verso} header and footer frames for
use with the \sty{flowfram} package.
\end{itemdesc}

\itemtitle{\sectionref{sec:accesstutorial}}
\begin{itemdesc}
\nameref{sec:accesstutorial} illustrates how to create and 
edit pictures without using the mouse.
\end{itemdesc}

\itemtitle{\sectionref{sec:rosetutorial}}
\begin{itemdesc}
\nameref{sec:rosetutorial} illustrates how to design a lute rose
using a \gls{symmetricshape} and \glspl{rotationalpattern}.
\end{itemdesc}

\end{deflist}


\section{A House}\label{sec:houseexample}

This example illustrates the basics. The aim is to create a simple
image of a house (shown in \figureref{fig:housefinal}).

\begin{enumerate}

\item The main part of the house will be constructed from a
rectangle, so select the \tool{rectangle} (\sectionref{sec:rectangles}).

\item Let's make it a
yellow brick house, so use \menu{settings.styles} to select
a yellow \pathattr{fill-paint} (\sectionref{sec:fillpaint}).

\item Click where you want the bottom left hand corner to go, and
move (not drag) the mouse to the opposite corner
(\figureref{fig:house1a}).  Click to complete the rectangle. You
will only see the \pathattr{fill-paint} once the rectangle has been
completed (\figureref{fig:house1b}).

\FloatSubFigs{fig:house1}
[\setkeys{Gin}{width=0.45\linewidth}]
{
 {fig:house1a}{\includeimg{house1a}}{},
 {fig:house1b}{\includeimg{house1b}}{}
}
[House Example\dash Creating a Rectangle]
{House Example\dash creating a rectangle:
\subfigref{fig:house1a} rectangle under construction,
\subfigref{fig:house1b} completed rectangle.}

\item Next do the roof. Let's make the roof using a triangle.
For this you will need to use the
\tool{closed_line} (\sectionref{sec:newlinepath}). Select this
tool using either the \dgls{tools.closed_line} button or
the \menu{tools.closed_line} menu item.

\item Let's make it a red roof, so use
\menu{settings.styles} to select a red
\pathattr{fill-paint} (\sectionref{sec:fillpaint}).

\item Click on each of the three vertices that form the triangle
(\figureref{fig:house2a}). To complete the \gls{path}, double click
when you click on the third vertex, or click on the third vertex and
then press \accelerator{menu.tools.finish}, or use the
\dgls{tools.finish} button.  You will only see the
\pathattr{fill-paint} once the path has been completed
(\figureref{fig:house2b}).

\FloatSubFigs{fig:house2}
[\setkeys{Gin}{width=0.45\linewidth}]
{
 {fig:house2a}{\includeimg{house2a}}{},
 {fig:house2b}{\includeimg{house2b}}{}
}
[House Example\dash Creating a Triangle]
{House Example\dash creating a triangle:
\subfigref{fig:house2a} triangle under construction,
\subfigref{fig:house2b} completed triangle.}

\item Lastly comes the door and windows. These are all
rectangles, so follow the same procedure as above.
Let's make the door black and the windows white.
Remember to set the \pathattr{fill-paint} before creating the rectangles
(\figureref{fig:housefinal}).

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth}]
{fig:housefinal}
{\includeimg{housefinal}}
{House Example\dash Completed Image}
[
\item To save the picture, select the \menu{file.save_as}
menu item (\figureref{fig:housesave}).
]
{fig:housesave}
{\includeimg{housesave}}
{House Example\dash Saving the Image}

\end{enumerate}

To include the image in a \LaTeX\ document, select the
\menu{file.export} menu item, and save it as a
\LaTeX\ file: click on the \qt{File of Type} \gls{dropdown} and
select \widget{filter.pgf}, and name the file
(for example, \filefmt{house.tex})
\figureref{fig:housesavetex}. Remember to use the \sty{pgf} package:
\begin{verbatim}
\usepackage{pgf}
\end{verbatim}
and to include the image later in the document use \gls{input}, e.g.:
\begin{verbatim}
\begin{figure}
\centering
\input{house}
\caption{A House}
\end{figure}
\end{verbatim}

\FloatFig
{fig:housesavetex}
[\setkeys{Gin}{width=0.4\linewidth}]
{\includeimg{housesavetex}}
[House Example\dash Exporting the Image to a \LaTeX\ File]
{House Example\dash exporting the image to a \LaTeX\ file.}

\section{Lettuce on Toast}\label{sec:toastexample}

This example illustrates how to edit paths. The aim is to create
the picture illustrated in \figureref{fig:lettucefinal}.

\begin{enumerate}
\item Let's start with the toast first. To begin with create
a rectangle (\sectionref{sec:rectangles}) with a brown
\pathattr{fill-paint} (\sectionref{sec:fillpaint}). If you are using
the CMYK model, you can get brown from 0\% Cyan, 81\% Magenta,
100\% Yellow and 60\% Black. If you are using the RGB model,
you can get brown from 40\% Red, 8\% Green and 0\% Blue. Create the
rectangle shown in \figureref{fig:lettuce1}.

\FloatFig
{fig:lettuce1}
[\setkeys{Gin}{width=0.4\linewidth}]
{\includeimg{lettuce1}}
{Lettuce on Toast Example\dash Brown Rectangle}

\item Bread quite often has a curved top, so let's
edit (\sectionref{sec:editpath}) the rectangle
so that the top is slightly curved. To do this,
\select\ the rectangle, and
then either click on the \dgls{edit.path.edit} button or select the
\menu{edit.path.edit} menu item. This will display
the \gls{path} in edit mode (\figureref{fig:lettuce2a}.)
Select the top segment, this will then be highlighted in red
(\figureref{fig:lettuce2b}).

\FloatSubFigs{fig:lettuce2}
[\setkeys{Gin}{width=0.4\linewidth}]
{
 {fig:lettuce2a}{\includeimg{lettuce2a}}{},
 {fig:lettuce2b}{\includeimg{lettuce2b}}{}
}
[Lettuce on Toast Example\dash Editing the Rectangle]
{Lettuce on Toast Example\dash editing the rectangle:
\subfigref{fig:lettuce2a} edit mode;
\subfigref{fig:lettuce2b} select top segment.}

\item Use the \gls{index.menu.editpath} popup menu to convert the line segment to a
curve (\figureref{fig:lettuce3}).

\FloatSubFigs{fig:lettuce3}
[\setkeys{Gin}{width=0.4\linewidth}]
{
  {fig:lettuce3a}{\includeimg{lettuce3a}}{},
  {fig:lettuce3b}{\includeimg{lettuce3b}}{}
}
[Lettuce on Toast Example\dash Converting the Top Segment to a Curve]
{Lettuce on Toast Example\dash converting the top segment to
a curve:
\subfigref{fig:lettuce3a} edit path popup menu;
\subfigref{fig:lettuce3b} segment converted to a curve.}

\item The segment now has two extra
\glspl{controlpt}, these need to be moved
to change the curvature (\figureref{fig:lettuce4a}). Deselect
the edit path tool (\menu{edit.path.edit} or
\accelerator{menu.edit.path.edit}) to exit
the \editpathmode\ (\figureref{fig:lettuce4b}). Note that if
you have the \gridlock\ enabled, you may find it easier to
temporarily disable it while you are editing the curvature control
points.

\FloatSubFigs{fig:lettuce4}
[\setkeys{Gin}{width=0.4\linewidth}]
{
 {fig:lettuce4a}{\includeimg{lettuce4a}}{},
 {fig:lettuce4b}{\includeimg{lettuce4b}}{}
}
[Lettuce on Toast Example\dash Finish Editing the Curve]
{Lettuce on Toast Example\dash finish editing the curve:
\subfigref{fig:lettuce4a} changing the curvature by moving the control points;
\subfigref{fig:lettuce4b} exit edit path mode.}

\item To make the lettuce, select the \tool{closed_curve}
(\sectionref{sec:newcurvepath}), and set the \pathattr{fill-paint}
(\sectionref{sec:fillpaint}) to green.  Make a rough outline of the
lettuce leaf, clicking on each vertex, and double-click to close the
path. Then, if necessary, edit the path to modify the
\glspl{controlpt} (\figureref{fig:lettuce5}).

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:lettuce5}
{\includeimg{lettuce5}}
{Lettuce on Toast Example\dash Adding a Closed Curve Path}
[
  \item Set the \pathattr{fill-paint} (\sectionref{sec:fillpaint}) to
  \gls{transparent}, and using the \tool{open_curve}
  (\sectionref{sec:newcurvepath}), add in some \glspl{path} to give
  the lettuce leaf some creases and edit as appropriate
  (\figureref{fig:lettucefinal}).
]
{fig:lettucefinal}
{\includeimg{lettucefinal}}
{Lettuce on Toast Example\dash Completed Image}

\item To save the picture, select the \menu{file.save_as}
menu item, and enter the filename.

\end{enumerate}

To include the image in a \LaTeX\ document, select the
\menu{file.export} menu item, and save it as a
\LaTeX\ file (click on the \qt{File of Type} \gls{dropdown} and
select \widget{filter.pgf}, and name the file,
for example, \filefmt{lettuce.tex}).
To include it in your \LaTeX\ document, remember to use the
\sty{pgf} package:
\begin{verbatim}
\usepackage{pgf}
\end{verbatim}
and include the image use \gls{input}. For example:
\begin{verbatim}
\begin{figure}
\centering
\input{lettuce}
\caption{Lettuce on Toast}
\end{figure}
\end{verbatim}

\section{Cheese and Lettuce on Toast}\label{sec:cheeseexample}

This example illustrates how to merge paths. It extends the
previous \nameref{sec:toastexample} example.
The aim is to create the image shown in \figureref{fig:cheesefinal}.

\begin{enumerate}
\item Load the image you created in the
\nameref{sec:toastexample} example, using the
\menu{file.open} menu item, or clicking on the \dgls{file.open}
button.

\item To create the slice of cheese, select the
\tool{rectangle} (\sectionref{sec:rectangles}), and set the
\pathattr{fill-paint} (\sectionref{sec:fillpaint}) to yellow.
Make a rectangle, as illustrated in \figureref{fig:cheese1}.

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:cheese1}
{\includeimg{cheese1}}
{Cheese and Lettuce on Toast Example\dash A Filled Rectangle}
[
  \item This slice of cheese is going to have holes in it, and we need
  to be able to see the lettuce and toast \manmsg{through} the holes. Since
  this is not a uniform \manmsg{colour}, we can't just, say, put green ellipses
  on top of the cheese as this won't look right. Instead, we are going
  to create some ellipses, and then merge them into the yellow rectangle.
  To do this, first select the
  \tool{ellipse} (\sectionref{sec:ellipses}), and create some
  ellipses on top of the yellow rectangle (\figureref{fig:cheese2}).
]
{fig:cheese2}
{\includeimg{cheese2}}
{Cheese and Lettuce on Toast Example\dash Adding Ellipses}

\item Now \select\ all the ellipses
you created in the previous step and the yellow rectangle
(\figureref{fig:cheese3a}) and 
merge them (\sectionref{sec:mergepaths}) using the
\menu{transform.merge} menu item (\figureref{fig:cheese3b}).
If the ellipses remain filled, check to make sure you have the
\pathattr{winding-rule} (\sectionref{sec:winding}) set to even-odd.
(Alternatively, you can use the \menu{transform.subtract}
menu item, in which case you don't need to worry about the winding
rule.)

\FloatSubFigs{fig:cheese3}
[\setkeys{Gin}{width=0.4\linewidth}]
{
  {fig:cheese3a}{\includeimg{cheese3a}}{},
  {fig:cheese3b}{\includeimg{cheese3b}}{}
}
[Cheese and Lettuce on Toast Example\dash Merging Paths]
{Cheese and Lettuce on Toast Example\dash merging paths:
\subfigref{fig:cheese3a} paths selected;
\subfigref{fig:cheese3b} paths merged into a single
path.}

\end{enumerate}

\FloatFig{fig:cheesefinal}
[\setkeys{Gin}{width=0.4\linewidth}]
{\includeimg{cheesefinal}}
{Cheese and Lettuce on Toast Example\dash Completed Image}

\section{An Artificial Neuron}\label{sec:neuronexample}

This example illustrates setting line styles and adding text.
The final image looks best as a \sty{pgf} picture included
in a \LaTeX\ document, as then you can use maths fonts.

\begin{enumerate}
\item The \gls{normal-font-size} for my \LaTeX\ document will be
10\gls{pt}, so I first need to make sure this is set using the
\menu{settings.configtex} menu item to open the
\dialog{texconfig} dialog window. Make sure the
\widget{clssettings.normalsize} value is set to 10 in the
\dialog{clssettings} tab (\sectionref{sec:normalsize}).

\item Select the \tool{rectangle} (\sectionref{sec:rectangles}),
and create a rectangle, as shown in \figureref{fig:neuron1}.

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:neuron1}
{\includeimg{neuron1}}
{Artificial Neuron Example\dash Adding a Rectangle}
[
  \item Select the \tool{ellipse} (\sectionref{sec:ellipses}),
  and create a circle, as shown in \figureref{fig:neuron2}.
]
{fig:neuron2}
{\includeimg{neuron2}}
{Artificial Neuron Example\dash Adding a Circle}

\item To make the logistic function symbol, select the
\tool{open_curve} (\sectionref{sec:newcurvepath}), and do a single
segment (\figureref{fig:neuron3a}).  Then use switch to
\editpathmode\ to adjust the curvature, as shown in
\figureref{fig:neuron3b}.  (If you have enabled the \gridlock, you
may find it easier to disable it while you are editing the curvature
control points.)

\FloatSubFigs{fig:neuron3}
[\setkeys{Gin}{width=0.4\linewidth}]
{
  {fig:neuron3a}{\includeimg{neuron3a}}{},
  {fig:neuron3b}{\includeimg{neuron3b}}{}
}
[Artificial Neuron Example\dash Creating a Sigmoidal Curve]
{Artificial Neuron Example\dash creating a sigmoidal
curve:
\subfigref{fig:neuron3a} adding an open curve segment;
\subfigref{fig:neuron3b} edit segment to adjust curvature.}

\item Next set the current line style to have an end
arrow. Note that lines with end markers look best with a butt cap
style, so this should also be set. This can be done as follows:

Use the \menu{settings.styles} menu item to display the
\dialog{styles} dialog box. Select the \widget{linestyle.title} tab
to display the line style panel.  Select \widget{linestyle.cap.butt}
from the \widget{linestyle.cap} \gls*{dropdown} (see
\figureref{fig:neuronlinestyle}).  Next click on the \dgls{choose}
button located on the same row as \widget{linestyle.arrow.end} to
open the end marker dialog box (illustrated in
\figureref{fig:neuronendmarker}). Select the
\widget{arrow.usemarker} radio button. This will enable the marker
chooser panel. Select the \widget{arrow.tab.arrows} tab and select
\widget{arrow.pointed60}. Select \dgls{okay} to close the end marker
dialog box and select \dgls{okay} to close the \dialog{styles}
dialog box.

\FloatFig{fig:neuronlinestyle}
[\setkeys{Gin}{width=0.7\linewidth}]
{\includeimg{neuronlinestyle}}
{Artificial Neuron Example\dash Setting the Current Line Style}

\FloatFig{fig:neuronendmarker}
[\setkeys{Gin}{width=0.7\linewidth}]
{\includeimg{neuronendmarker}}
{Artificial Neuron Example\dash End Marker Dialog Box}

\item Select the \tool{open_line} (\sectionref{sec:newlinepath}), and
add in the arrows as illustrated in \figureref{fig:neuron4}.

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:neuron4}
{\includeimg{neuron4}}
{Artificial Neuron Example\dash Adding Arrows}
[
    \item Use \menu{settings.styles} to open the \dialog{styles}
    selector, and set the font family to \qt{Serif} and the font
    size to 10pt, and then press \dgls{okay}. Select the
    \mathstool\ (\sectionref{sec:text}), and add
    in the text, as illustrated in \figureref{fig:neuron5}.
    (I've used the
    \widget{unicode.SUPERSCRIPTS_AND_SUBSCRIPTS} block in the
    \dialog{symbolselector} to insert the subscripts.)
]
{fig:neuron5}
{\includeimg{neuron5}}
{Artificial Neuron Example\dash Adding Text}

Since I have the \mathstool\ with the \mathsmode\
\glslink{textarea-mapping}{mappings} on
(\sectionref{sec:texconfigtext}), the \LaTeX\ alternative text
automatically has the \glsdesc{mshift} characters inserted and the
Unicode subscripts have been converted to \glssymbol{underscore}\code{1} etc. You can
see the \LaTeX\ alternative text if you select the \gls{textarea}
and use \menu{edit.textarea.edit}. This will open up the
\dialog{edittext} dialog box shown in \figureref{fig:neuron6}.

\FloatFig{fig:neuron6}
[\setkeys{Gin}{width=0.4\linewidth}]
{\includeimg{neuron6}}
{Artificial Neuron Example\dash Editing Text}

Now select all of the text on the left (\qt{x\textsubscript{1}},
\qt{x\textsubscript{2}} and \qt{x\textsubscript{n}}) and use the
\menu{edit.textarea.font.all_styles} dialog box to change the horizontal
\textattr{anchor} parameter to \widget{font.anchor.right}. (Note
that you will not see any difference to the image in \FlowframTk.)

\item Select the \mathstool\ (\sectionref{sec:text}) and start a
\gls{textarea} in the rectangle.  I want to use a capital sigma to
indicate a summation, and as I don't know the magic combination of
characters to access that symbol, I used the
\dialog{symbolselector} dialog box. To do this, either use the
\gls{index.menu.textarea} and select \menu{textarea.insert_symbol},
or press the \accelerator{menu.textarea.insert_symbol} key. The required symbol can now be
selected from the \dialog{symbolselector} dialog box (illustrated in
\figureref{fig:neuron7}). This is the summation symbol (U+2211) from
the \widget{unicode.MATHEMATICAL_OPERATORS} block, not the
Greek capital sigma from the
\widget{unicode.MATHEMATICAL_ALPHANUMERIC_SYMBOLS} block.

\FloatFig{fig:neuron7}
[\setkeys{Gin}{width=0.8\linewidth}]
{\includeimg{neuron7}}
{Artificial Neuron Example\dash Insert Symbol Dialog Box}

\item Use the \menu{edit.textarea.font.all_styles} to change the
font size to 25 and change both the \textattr{anchor} settings to
\widget{font.anchor.hcentre}, see \figureref{fig:neuron8}.
(You don't need to change the anchor settings if you have the
\widget{textconfig.anchor} setting enabled
(\sectionref{sec:texconfig}), as it will change when you justify the \gls{textarea}
in step~\ref{itm:neuronalign}.)

\FloatFig{fig:neuron8}
[\setkeys{Gin}{width=0.7\linewidth}]
{\includeimg{neuron8}}
{Artificial Neuron Example\dash Setting the Font Style}

As before, if you used the \mathstool\ with the \mathsmode\
mappings enabled, the \LaTeX\ alternative text should already be
correctly set, but you can check by selecting the \gls{textarea} and using the
\menu{edit.textarea.edit} menu item to open the
\dialog{edittext} dialog box (\figureref{fig:neuron9b}).

\FloatSubFigs{fig:neuron9}
[\setkeys{Gin}{width=0.4\linewidth}]
{
 {fig:neuron9a}{\includeimg{neuron9a}}{},
 {fig:neuron9b}{\includeimg{neuron9b}}{}
}
[Artificial Neuron Example\dash Setting the Equivalent \LaTeX\ Symbol]
{Artificial Neuron Example\dash setting the
equivalent \LaTeX\ symbol:
\subfigref{fig:neuron9a} selected text;
\subfigref{fig:neuron9b} setting \LaTeX\ equivalent.}

\item\label{itm:neuronalign} The $\Sigma$ would look much better if
it was \manmsg{centred} inside the rectangle. To do this \select\
the $\Sigma$ and the rectangle, then \gls{group}
(\sectionref{sec:grouping}) them either by clicking on the
\dgls{transform.group} button or by using the \menu{transform.group}
menu item. Then select the \menu{transform.justify.centre} menu
item, and then the \menu{transform.justify.middle} menu item. The
\gls{textarea} should now be \manmsg{centred} inside the rectangle
(\figureref{fig:neuron10}).

\FloatFig{fig:neuron10}
[\setkeys{Gin}{width=0.4\linewidth}]
{\includeimg{neuron10}}
{Artificial Neuron Example\dash Justifying Objects}

To include the image inside a \LaTeX\ document, save the image
to a \LaTeX\ file using the \menu{file.export} menu item,
and then include it in your document (assuming the file was called
\filefmt{neuron.tex}):
\begin{verbatim}
\begin{figure}
\centering
\input{neuron}
\caption{An Artificial Neuron}
\end{figure}
\end{verbatim}
(Remember to use the \sty{pgf} package.) The image will appear in
the \LaTeX\ document as illustrated in \figureref{fig:neurontex}.

\FloatFig{fig:neurontex}
{\includeimg{neuron}}
{Artificial Neuron Example\dash Image as it Appears in a
\LaTeX{} Document}

\end{enumerate}

\section{Bus}\label{sec:busexample}

This example illustrates how to:
\begin{itemize}
\item \hyperref[mi:breakpath]{break a path};
\item \hyperref[sec:pathunion]{create a path union};
\item \hyperref[sec:pathsubtract]{subtract paths};
\item Use the \gls{shapepar} function (\sectionref{sec:shapepar}) to
create a shaped paragraph in a \TeX\ or \LaTeX\ document.
\end{itemize}

\begin{enumerate}
\item If you have not already done so, enable the \gridlock\ either
with the \dgls{settings.grid.lock} button or the
\menu{settings.grid.lock} menu item.

\item Use \menu{settings.configtex} to display the
\dialog{texconfig} dialog box and set the
\gls{normal-font-size} to the value that you will be using in your
document (see \figureref{fig:busnormalsize}). In my document, I have
used 10pt.

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:busnormalsize}
{\includeimg{busnormalsize}}
{Bus Example\dash Setting the Normal Font Size}
[
  \item To create the bus outline, start with the
  \tool{ellipse} (\sectionref{sec:ellipses}), and create a circle
  (\figureref{fig:bus1}).
]
{fig:bus1}
{\includeimg{bus1}}
{Bus Example\dash Create a Circle}

\item Select the circle, and switch on \editpathmode\
(\sectionref{sec:editpath}).  The \gls{controlpt} at the start of
the \gls{path} is always the first selected \gls{controlpt} when you
select the edit tool (\figureref{fig:bus2a}). Select the second
segment in the path (\figureref{fig:bus2b}).

\FloatSubFigs{fig:bus2}
[\setkeys{Gin}{width=0.4\linewidth}]
{
 {fig:bus2a}{\includeimg{bus2a}}{},
 {fig:bus2b}{\includeimg{bus2b}}{}
}
{Bus Example\dash Editing the Path}

\item \hyperref[mi:breakpath]{Break the path} using the
\gls{index.menu.editpath} and selecting 
\menu{editpath.break_path} (\figureref{fig:bus3a}).  You should now have two
separate semi-circles (\figureref{fig:bus3b}).  If you find
that the circle has been split unevenly (i.e.\ you have a quadrant
and a three-quarters of a circle) then you selected the wrong
segment. Don't panic, just select \menu{edit.undo} and try
again.

\FloatSubFigs{fig:bus3}
[\setkeys{Gin}{width=0.4\linewidth}]
{
 {fig:bus3a}{\includeimg{bus3a}}{},
 {fig:bus3b}{\includeimg{bus3b}}{}
}
{Bus Example\dash Break the Path}

\item Exit edit path mode. Move and rotate the top semi-circle
so that it looks like \figureref{fig:bus4}.

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth}]
{fig:bus4}
{\includeimg{bus4}}
{Bus Example\dash Move and Rotate Top Semi-Circle}
[
  \item Select the \tool{open_line} (\sectionref{sec:newlinepath}) and
  add in the two lines as shown in \figureref{fig:bus5}.
]
{fig:bus5}
{\includeimg{bus5}}
{Bus Example\dash Adding Lines}

\item Select all paths and use \menu{transform.union}.
You should now have just a single \gls{path}.

\item Select this new \gls{path}, and use the
\editpathmode\ (\sectionref{sec:editpath}) to give the
front end of the bus a slightly curved outline, as
shown in \figureref{fig:bus6}. (You may find it easier to temporarily
disable the \gridlock\ while you edit the path.)

\FloatSideBySideFigs
 [][\setkeys{Gin}{width=\linewidth}]
{fig:bus6}
{\includeimg{bus6}}
{Bus Example\dash Convert Line Segment to a Curve}
[
   \item Add the windows, as shown in \figureref{fig:bus7}.
]
{fig:bus7}
{\includeimg{bus7}}
{Bus Example\dash Add Windows}

\item This next operation assumes that you haven't changed the
\gls{stackingorder}. The main outline of the bus must be at the
rear. To ensure this, select the bus outline and use the
\editfn{back} function (\sectionref{sec:moveupordown}).

\item Select all paths, and apply \menu{transform.subtract}.  Set
the \pathattr{fill-paint} to red using the \menu{edit.fill_colour}
menu item to open the \dialog{fillpaintselector} dialog box.  The windows
should appear as holes. See \figureref{fig:bus8}.

\FloatFig{fig:bus8}
[\setkeys{Gin}{width=0.45\linewidth}]
{\includeimg{bus8}}
{Bus Example\dash Subtract Windows from Bus Outline and Set
Fill Paint}

\item Make sure that the bus is selected. Select the
\menu{tex.shapepar} menu item to open the \dialog{shapepar}
dialog. Select the \widget{parshape.use_path} option and click
\dgls{okay}. Scan lines will appear as \FlowframTk\
works out the parameters. Once completed a file dialog box will
appear. Give the file a name (for example \filefmt{busshape.tex}).

\item If you are using \LaTeX, create a document that looks something
like:
\begin{verbatim}
\documentclass{article}
\usepackage{shapepar}
\begin{document}
\input{busshape}\frenchspacing
The wheels on the bus go round and round...

\end{document}
\end{verbatim}

\item If you are using plain \TeX, create a document that looks
something like:
\begin{verbatim}
\input shapepar.sty

\input busshape.tex
\frenchspacing
The wheels on the bus go round and round...

\bye
\end{verbatim}

\item The resulting shaped paragraph is shown in \figureref{fig:bus9}.

\FloatFig
  {fig:bus9}
  {\includeimg{bus9}}
  {Bus Example\dash Resulting Shaped Paragraph}

\end{enumerate}

\section{A Poster}\label{sec:postertutorial}

This example illustrates how to use \FlowframTk\ to help construct
frames for use with the \sty{flowfram} package.
The aim is to create a \LaTeX\ package based on the
\sty{flowfram} package that defines frames for use with a
poster. For this example, I used the A4 landscape paper setting,
but it can just as easily be applied to other paper sizes.

\begin{enumerate}
\item Set the grid to the unit of your choice using the
\menu{settings.grid.settings} dialog box. For example,
I set the grid settings to major divisions of 1in, with
10 subdivisions. I also
\hyperref[sec:controlsettings]{set the storage unit} to 1in.

\item I recommend that you set the \gridlock\ on (using
\menu{settings.grid.lock}), to help prevent
having frames with slightly different widths, which will result
in warnings from the \sty{flowfram} package.

\item Set the \gls{typeblock}, using the
\menu{tex.flowframe.set_typeblock} menu item.
I used 1in margins. You should now see the typeblock appear
as a light \manmsg{grey} rectangle on the page. (Note that you can not
select or move the \gls{typeblock}, you can only modify it using the
\menu{tex.flowframe.set_typeblock} dialog box.)
See \figureref{fig:poster1}.

\FloatFig{fig:poster1}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{poster1}}
{Poster Example\dash The Typeblock}

\item Select the rectangle tool, and create the rectangles
shown in \figureref{fig:poster2}. The top rectangle is going to
be the title frame, the two tall rectangles on the left
will be flow frames containing the main text for the poster,
and the two short rectangles on the right will be dynamic frames
that will contain a table and a figure. (To ensure that the two tall
rectangles are the same size, you may prefer to use the copy and
paste function.)

\FloatFig{fig:poster2}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{poster2}}
{Poster Example\dash Adding Rectangles}

\item Switch to the select tool, and add a
\gls{bitmap} using
\menu{bitmap.insert}, to give the
poster a logo, and move it to the location shown
(\figureref{fig:poster3}).

\FloatFig{fig:poster3}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{poster3}}
{Poster Example\dash Adding a Bitmap}

\item Garish posters are not recommended, but to illustrate how to
liven up the poster, set the \pathattr{fill-paint} for the rectangles
using the \menu{edit.fill_colour} menu item to open
the \dialog{fillpaintselector} dialog box. I also added two
extra smaller rectangles on top of the right hand rectangles, to
give a double border effect (\figureref{fig:poster4}).

\FloatFig
{fig:poster4}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{poster4}}
{Poster Example\dash Adding Some Paint}

\item Select the top rectangle and the \gls{bitmap}, and
\gls{group} (\sectionref{sec:grouping}) them.
Select the bottom right hand rectangles (green) and group them.
Select the middle right hand rectangles (magenta) and group them.

\item Select the top group, and select the
\menu{tex.flowframe.set_frame} menu item. This will
open up the \dialog{flowframe} dialog box shown in \figureref{fig:poster5}.
Set the type to \widget{flowframe.static}, and call it \qt{title}. Set the
margins as desired. (I used 0.1in for all the margins, but you
may want to use different values to ensure that the logo is inside
the margins so that the frame's text doesn't overlap the image.)

\FloatFig{fig:poster5}
[\setkeys{Gin}{width=0.5\textwidth}]
{\includeimg{poster5}}
[Poster Example\dash Assigning Frame Information]
{Poster Example\dash assigning frame information. (Note that
the shape option is not available because the selected object is
a group not a path.)}

\item Click on the \widget{flowframe.edit} button to open
the mini \TeX\ editor and type in the code to create the document
title. For example, I typed in the following:
\begin{compactcodebox*}
\gls{title}\marg{A Sample Poster}
\gls{author}\marg{Nicola Talbot}
\gls{maketitle}
\gls{thispagestyle}\marg{empty}
\end{compactcodebox*}
as shown in \figureref{fig:postertitlecontents}. (Since
\gls{maketitle} sets the page style to \pagestyleref{plain}, this sets
it to \pagestyleref{empty} as page numbers aren't appropriate here.)

\FloatFig{fig:postertitlecontents}
[\setkeys{Gin}{width=0.5\textwidth}]
{\includeimg{postertitlecontents}}
{Poster Example\dash Adding Contents to a Static Frame}

To close the editor either click on the \dgls{okay}
button (the one with the green tick) or press 
\accelerator{button.okay}.

\item Similarly, make the left hand rectangle a flow frame
with label \qt{left} and the middle rectangle a flow frame with label
\qt{middle}. (Flow frames can't be assigned contents, so the
\widget{flowframe.edit} button will now be disabled.)

\item  Make the two remaining groups dynamic frames
with labels \qt{figure} and \qt{table}. For these two, I used larger
margins (0.2in) to compensate for the double border
(\figureref{fig:poster6}).

Again use the mini \TeX\ editor to set the contents. The \qt{figure}
frame's contents are:
\begin{verbatim}
\begin{staticfigure}
\centering
Insert figure here!
\caption{A Sample Figure}
\label{fig:sample}
\end{staticfigure}
\end{verbatim}
The \qt{table} frame's contents are:
\begin{verbatim}
\begin{statictable}
\caption{A Sample Table}
\label{tab:sample}
\centering
Insert table here!
\par
\end{statictable}
\end{verbatim}

\FloatFig{fig:poster6}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{poster6}}
{Poster Example\dash Frame Information Assigned}

\item Move the slider between the \gls{canvas} and the preamble
panel, or use the \menu{tex.set_preamble} menu item to
show the \gls{preamble} panel. In the \widget{texeditor.latexcodeblock.earlypreamble}
tab, add the following:
\begin{codebox}
\gls{RequirePackage}\oarg{utf8}\marg{inputenc}
\gls{RequirePackage}\oarg{T1}\marg{fontenc}
\gls{RequirePackage}\marg{lmodern}
\end{codebox}
as shown in \figureref{fig:posterpreamble}. (You can use
\gls{usepackage} instead of \gls{RequirePackage}. Any
instances of \gls{usepackage} will automatically be converted to
\gls{RequirePackage} if the image is exported to a class or
package.)

\FloatFig{fig:posterpreamble}
[\setkeys{Gin}{width=0.8\textwidth}]
{\includeimg{posterpreamble}}
{Poster Example\dash Adding Preamble Information}

\item Use the \menu{file.export} menu item to create
a new \LaTeX\ package or class that defines these frames. Remember to
select the \widget{filter.sty} file filter.
I called my file \filefmt{poster.sty} (\figureref{fig:poster7}) which
will create a package rather than a class.

\FloatFig{fig:poster7}
[\setkeys{Gin}{width=0.5\textwidth}]
{\includeimg{poster7}}
{Poster Example\dash Export Frame Information to a \LaTeX{} Package}

\item Create a \LaTeX\ document that uses this package or class.

First, let's suppose I've exported to a package. Since I
used A4 landscape paper, it's simplest use the \cls{article}
class file. If you use a larger size (for example, A0), it would be more
appropriate to use the \cls{a0poster} class file.

I created the following file called \filefmt{poster.tex}:
\begin{verbatim}
\documentclass{article}

% use new package created in this example:
\usepackage{poster}

\begin{document}

This is the main body of the poster. This text will
appear in the first of the two flow frames. Once it
has reached the end of the first flow frame, it will 
then continue in the second flow frame.

% Lots of text omitted

\end{document}
\end{verbatim}

Now suppose I've exported to a class by using the
\widget{filter.cls} filter in the export dialog. Then the start of my
\filefmt{poster.tex} file just uses this class:
\begin{verbatim}
% use new class created with this example:
\documentclass{poster}

\begin{document}
This is the main body of the poster. This text will
appear in the first of the two flow frames. Once it
has reached the end of the first flow frame, it will 
then continue in the second flow frame.

% Lots of text omitted

\end{document}
\end{verbatim}
This is actually more convenient than creating a package.

\item To make the poster a PDF document, do:
\begin{terminal}
pdflatex poster.tex
\end{terminal}%
The final document is illustrated in \figureref{fig:posterfinal}.
\end{enumerate}

\FloatFig{fig:posterfinal}
[\setkeys{Gin}{width=\textwidth}]
{\includeimg{posterfinal}}
{Poster Example\dash Final Document}

\section{A Newspaper}\label{sec:newstutorial}

This example illustrates how to use \FlowframTk\ to create a
class or package based on the \sty{flowfram} package, using non-standard
shaped frames. The aim is to produce the document shown in
\figureref{fig:news25}.

\begin{enumerate}
\item In this example, my newspaper is going to be on A4 portrait
paper, with a \gls{normal-font-size} of 12\gls{pt}, so the first
thing to do is to select the paper size and orientation using
\menu{settings.paper.A4} and
\menu{settings.paper.portrait}, and set the value of the
\LaTeX\ \gls{normal-font-size} (\sectionref{sec:normalsize}), using
\menu{settings.configtex} to open the \dialog{texconfig} dialog box
(see~\figureref{fig:news1}). Select \widgetfmt{12} from the
\gls{dropdown}.

\FloatFig{fig:news1}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news1}}
{Newspaper Example\dash Setting the \LaTeX{} Normal Font Size}

\item The 12pt font size has a corresponding \gls{baselineskip}
of 14.5pt. For this example, it is more practical to have a grid
that has intervals of this size, as it gives a guide as to how many
lines there will be in each frame.

\begin{information}
This is only an approximate guide, as larger or smaller font sizes may be
used in a frame, which will affect the total number of lines in the
frame. 
\end{information}

Therefore I set the grid to have 145\gls{pt} major divisions with
10 subdivisions. This means that each minor tick mark is at a distance
of 14.5pt (one \gls{baselineskip}) from its neighbour. To do this
use \menu{settings.grid.settings} to open the \dialog{grid} dialog, and enter the
values as shown in \figureref{fig:news2}.

\FloatFig{fig:news2}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news2}}
{Newspaper Example\dash Setting the Grid}

\item To help reduce rounding errors, I'm also going to set the
\gls{storageunit} to 1pt. To do this use \menu{settings.config} to
open the \dialog{config} dialog box and change the storage unit in
the \widget{controls.title} tab, as shown in
\figureref{fig:newsunit}.

\FloatFig{fig:newsunit}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{newsunit}}
{Newspaper Example\dash Setting the Storage Unit}

\item Next set the \gls{typeblock}. This nominally defines the paper
margins, although it is possible to define frames outside this
area. I used 58pt margins on all sides. To do this, use the
\menu{tex.flowframe.set_typeblock} menu item to display
the \dialog{typeblock} dialog box shown in \figureref{fig:news3}. Enter the values
shown and click on \dgls{okay} or press \accelerator{button.okay}
to continue. You should now see a pale \manmsg{grey} rectangle displayed
on the \gls{canvas} denoting the \gls{typeblock}.

\FloatFig{fig:news3}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news3}}
{Newspaper Example\dash Setting the Typeblock}

\item The newspaper is going to have a static frame along the
top of the \gls{typeblock} that will contain the title of the paper. This
isn't going to have a border, but we will need to draw a rectangle
to define the frame's bounding box. So select the
\tool{rectangle} (\sectionref{sec:rectangles}) and draw a
rectangle with opposing corners at (58pt,58pt) and
(536.5pt,145pt). You should now see something like
\figureref{fig:news4}.

\FloatFig{fig:news4}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news4}}
{Newspaper Example\dash Title Frame}

\item Switch to the \tool{select}, and
\select\ this rectangle. Use the \menu{tex.flowframe.set_frame} menu item
to open the \dialog{flowframe} dialog and enter the values
shown in \figureref{fig:news5a}. Note that the
\widget{flowframe.border} field has been set to
\widget{flowframe.border_none}.
The frame contents should be the title.
This can be set by clicking on the \widget{flowframe.edit}
button, which will open the mini \TeX\ editor, shown in
\figureref{fig:news5b}.
I typed in the following:
\begin{verbatim}
\begin{center}
\bfseries\Huge
Fairy Tale Times
\end{center}
\hfill Issue 2. 7 December 2005.
\end{verbatim}

\FloatSubFigs{fig:news5}
[\setkeys{Gin}{width=0.45\textwidth}]
{
 {fig:news5a}{\includeimg{news5}}{},
 {fig:news5b}{\includeimg{news5b}}{}
}
[Newspaper Example\dash Assigning Flowframe Data to Title Frame]
{Newspaper Example\dash Assigning Flowframe Data to Title
Frame:
\subfigref{fig:news5a} frame setup;
\subfigref{fig:news5b} setting the frame contents}

\item Below the title, there will be two columns each with its
own heading. I am going to make separate frames for the headings,
and since the headings will be in a larger font, I shall give their
frames a height of twice the \gls{baselineskip}. Select the
\tool{rectangle} (\sectionref{sec:rectangles}), and make two
rectangles with opposing corners at:
\begin{itemize}
\item (58pt, 159.5pt) and (290pt, 188.5pt)
\item (304.5pt, 159.5pt) and (536.5pt, 188.5pt)
\end{itemize}
You should now see something like \figureref{fig:news6}.

\FloatFig{fig:news6}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news6}}
{Newspaper Example\dash Left and Right Heading Frames Added}

\item Switch to the \tool{select}, and
\select\ the left hand frame, and assign the \gls{flowframe} data shown in
\figureref{fig:news7}. The frame contents contains the section
command:
\begin{verbatim}
\section{Killer Wolf on the Loose}
\end{verbatim}
This is again set using the \widget{flowframe.edit} button
to open the \TeX\ editor.

\FloatFig{fig:news7}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news7}}
{Newspaper Example\dash Assigning Flowframe Data to Left
Heading Frame}

\item Do the same for the right hand rectangle, but
call it \qt{rightheading}. The frame contents contains the
section command:
\begin{verbatim}
\section{Tragic Wall Accident}
\end{verbatim}

\item The left hand column is going to angle around underneath the
right hand column, as it will have more text in it. Select the
\tool{closed_line} (\sectionref{sec:newlinepath}) and make a
polygon with vertices at (58pt, 203pt), (58pt, 507.5pt), (536.5pt,
507.5pt), (536.5pt, 420.5pt), (290pt, 420.5pt) and (290pt, 203pt) as
shown in \figureref{fig:news8}.

\FloatFig{fig:news8}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news8}}
{Newspaper Example\dash Added L Shaped Frame}

\item Switch to the \tool{select}, and
\select\ this L shaped polygon, and assigned the \gls{flowframe} data
shown in \figureref{fig:news9}. Note that the
\widget{flowframe.align} field has been set to
\widget{flowframe.align_top} to ensure that if there is
insufficient text to fill the frame, all blank space will go at the
bottom of the frame, and thus help to keep the frame's shape. I
used \widget{flowframe.shape_parshape} rather than
\widget{flowframe.shape_shapepar} to define the frame's shape
as I don't want it to shrink and grow to fit the text.

The frame contents are quite long. You can either set the text in
\FlowframTk\ or use one of \sty{flowfram}'s commands in the
document. Here's the full text:
\begin{verbatim}
The authorities are warning of a killer wolf on the
loose. He has so far devoured an old grandmother and
two pig brothers. He is described as being furry with
big eyes and big teeth.

On Monday this week he broke into a house, and devoured
an old lady. He then disguised himself as the old lady
in order to deceive her granddaughter. Luckily for the little
girl a woodsman arrived in time to rescue her. Parents are
being cautioned not to let their children wander about on
their own, and to remind them not to talk to strangers.

The next day the wolf struck again, this time targeting two
pig brothers who had most incautiously made their dwellings
on the cheap using inadequate materials. The wolf also made
an attempt on the third pig brother, but was unable to break
into his house.

Police are appealing to the public for witnesses, and remind
people to keep their doors securely fastened at all times.

``Always ask to see identification,'' said one police advisor,
``and invest in improving the general security of your property.''
\end{verbatim}

\FloatFig{fig:news9}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news9}}
{Newspaper Example\dash Assigning Flowframe Data to L Shaped
Frame}

\item I'm going to illustrate the story in the right hand column.
The \gls{bitmap} image \filefmt{egg.png} is supplied with the \sty{flowfram}
package but is also available in the examples subdirectory of
\FlowframTk's installation directory. Use \menu{bitmap.insert}
to insert the \gls{bitmap} on the \gls{canvas}. This will initially
appear in the top left hand corner of the \gls{canvas}. Move it
over to the location shown in \figureref{fig:news10}, either by
dragging it or by using \menu{edit.moveby} and specifying
a horizontal (\widget{coordinates.x}) displacement of 472.8pt
and a vertical (\widget{coordinates.y}) displacement of 206pt.

\FloatFig{fig:news10}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news10}}
{Newspaper Example\dash Added Image}

\item Set the \gls{flowframe} data shown in \figureref{fig:news11} to
this \gls{bitmap}. Note that you must set the
\widget{flowframe.border} setting to
\widget{flowframe.border_as_shown}, otherwise the \gls{bitmap}
will not appear in the document.

\FloatFig{fig:news11}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news11}}
{Newspaper Example\dash Assigning Flowframe Data to Bitmap}

\item Next comes the right hand frame. This is a polygon with a
stepped area that goes around the bitmap. Select the
\tool{closed_line} (\sectionref{sec:newlinepath}), and construct a
polygon with vertices at:
(304.5pt, 203pt), (304.5pt, 406pt), (536.5pt, 406pt),
(536.5pt, 290pt), (478.5pt, 290pt), (478.5pt, 261pt),
(464pt, 261pt), (464pt, 232pt), (478.5pt, 232pt)
(478.5pt, 217.5pt), (493pt, 217.5pt) and (493pt, 203pt) as shown in
\figureref{fig:news12}.

\FloatFig{fig:news12}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news12}}
{Newspaper Example\dash Added Right Hand Polygon}

\item Switch to the \tool{select}, select
this polygon and assign the \gls{flowframe} data shown in
\figureref{fig:news13}. Note that the
\widget{flowframe.shape} field has been set to
\widget{flowframe.shape_parshape} and the
\widget{flowframe.align} field has been set to
\widget{flowframe.align_top}. Again, the contents of the
frame are quite long and can either be set using \FlowframTk\ or
using on of \sty{flowfram}'s commands in the document. I'm going to set
the contents using \FlowframTk, as above. The text is as follows:
\begin{verbatim}
An egg person tragically fell from a six foot wall 
yesterday afternoon and was smashed to pieces. The 
king's cavalry rushed to the scene, but regretted 
that they were unable to help him.

Humpty Dumpty was believed to be sitting on the wall 
when he fell.  Police have ruled out foul play, but
are advising people not to play on high walls, 
particularly those vulnerable members of the population 
suffering from eggshell syndrome.

\small\em
Exclusive interview with one of the King's men on page 6.
\end{verbatim}

\FloatFig{fig:news13}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news13}}
{Newspaper Example\dash Assigning Flowframe Data to Right
Hand Polygon}

\item I'm going to add an L-shaped segment between the left and right
blocks to clearly delineate them. Switch to the
\tool{open_line} (\sectionref{sec:newlinepath}), and construct a
\gls{path} with vertices at: (297.25pt, 159.5pt), (297.25pt,
413.25pt) and (536.5pt, 413.25pt) as shown in \figureref{fig:news14}.
(You'll need to switch off the \gridlock.)

\FloatFig{fig:news14}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news14}}
{Newspaper Example\dash Added L Shaped Divider}

\item Switch to the \tool{select}, \select\
this new path and assign the \gls{flowframe} data shown in
\figureref{fig:news15}.  Make sure that you have set the
\widget{flowframe.border} field to
\widget{flowframe.border_as_shown}.

\FloatFig{fig:news15}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news15}}
{Newspaper Example\dash Assigning Flowframe Data to L Shaped
Divider}

\item Next comes a horizontal divider to separate the top two
columns from the bottom columns (which will be created
later). Select the \tool{open_line}, and construct a line
with end points at: (58pt, 514.75pt) and (536.5pt, 514.75pt) as shown
in \figureref{fig:news16}.

\FloatFig{fig:news16}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news16}}
{Newspaper Example\dash Added Horizontal Divider}

\item Switch to the \tool{select}, \select\
this line and assign the \gls{flowframe} data shown in
\figureref{fig:news17}.

\FloatFig{fig:news17}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news17}}
{Newspaper Example\dash Assigning Flowframe Data to
Horizontal Divider}

\item Next comes another header frame. Select the
\tool{rectangle} (\sectionref{sec:rectangles}),
and construct a rectangle with opposing corners at:
(58pt, 522pt) and (536.5pt, 551pt) as shown in \figureref{fig:news18}.

\FloatFig{fig:news18}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news18}}
{Newspaper Example\dash Added Lower Header}

\item Switch to the \tool{select}, \select\
this rectangle, and assign the \gls{flowframe} data as shown in
\figureref{fig:news19}. The frame contents is another sectioning
command:
\begin{verbatim}
\section{Relief as Missing Sheep Finally Return Home}
\end{verbatim}

\FloatFig{fig:news19}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news19}}
{Newspaper Example\dash Assigning Flowframe Data to Lower
Header}

\item At the bottom of the page, I want to have two columns,
with the text flowing from the left hand column into the right
hand column. This means that these frames need to be flow frames.
Select the \tool{rectangle}, and
construct two rectangles with opposing corners at:
\begin{itemize}
\item (58pt, 565.5pt) and (290pt, 783pt)
\item (304.5pt, 565.5pt) and (536.5pt, 783pt)
\end{itemize}
as shown in \figureref{fig:news20}.

\FloatFig{fig:news20}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news20}}
{Newspaper Example\dash Added Lower Left and Right
Rectangles}

\item Switch to the \tool{select}, select
the left lower rectangle and assign the \gls{flowframe} data shown in
\figureref{fig:news21}. Similarly for the right hand lower rectangle.

\FloatFig{fig:news21}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news21}}
{Newspaper Example\dash Assigning Flowframe Data to Lower
Left Rectangle}

\item I also want to have a \gls{bitmap} image in the lower left hand frame.
This is going to be slightly more complicated as flow frames
can not be assigned a shape like the static and dynamic frames.
The image I'm going to use is called \filefmt{sheep.png} and is
provided with the \sty{flowfram} package, but it is also
available in the \filefmt{examples} subdirectory of \FlowframTk's
installation directory. Use \menu{bitmap.insert}
to insert this image, and then either drag it with the mouse or use
the \menu{edit.moveby} dialog box to move it by (50pt, 556pt)
to the location shown in \figureref{fig:news22}.

\FloatFig{fig:news22}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news22}}
{Newspaper Example\dash Added Sheep Bitmap}

\item Assign this \gls{bitmap} the \gls{flowframe} data shown in
\figureref{fig:news23}.

\FloatFig{fig:news23}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news23}}
{Newspaper Example\dash Assigning Flowframe Data to Sheep
Bitmap}

\item As it stands, any text in the left flow frame will overlap
the sheep image, so I'm going to construct a new polygon to go
around the sheep image. This polygon will not form a frame, but
will be used to construct the parameters of the \gls{parshape}
command, which can then be input at the start of the flow frame.
To do this, select the \tool{closed_line}{sec:lines},
and construct a polygon
with vertices at: (116pt, 565.5pt), (116pt, 580pt), (101.5pt, 580pt),
(101.5pt, 609pt), (58pt, 609pt), (58pt, 783pt), (290pt, 783pt)
and (290pt, 565.5pt) as shown in \figureref{fig:news24}.

\FloatFig{fig:news24}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news24}}
{Newspaper Example\dash Added Polygon Defining Text Region}

\item Select this polygon, and select the \menu{tex.parshape} menu
item. This will open the \dialog{parshape} dialog box shown in
\figureref{fig:newsparshapea}.  Select the
\widget{parshape.use_path} option and click \dgls{okay}.  Save to a
file named \filefmt{sheepcutout.tex}
(\figureref{fig:newsparshapeb}).

\FloatSubFigs{fig:newsparshape}
[\setkeys{Gin}{width=0.45\textwidth}]
{
 {fig:newsparshapea}{\includeimg{newsparshapea}}{},
 {fig:newsparshapeb}{\includeimg{newsparshapeb}}{}
}
[Newspaper Example\dash Computing Parshape Parameters]
{Newspaper Example\dash computing \gls{parshape}
parameters:
\subfigref{fig:newsparshapea} select \widget{parshape.use_path} option;
\subfigref{fig:newsparshapeb} export dialog.}

\item Open the preamble pane either using 
\menu{tex.set_preamble} or just move the divider across and set the
\gls{early-preamble} code as follows:
\begin{verbatim}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\end{verbatim}
(see \figureref{fig:newspreamble}) and the late preamble to
\begin{verbatim}
% suppress section numbering
\setcounter{secnumdepth}{0}
% set the paragraph indentation for static
% and dynamic frames
\setlength{\sdfparindent}{\parindent}
\end{verbatim}
(See \figureref{fig:newspreamble2}.)

\FloatFig{fig:newspreamble}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{newspreamble}}
{Newspaper Example\dash Setting the Early Preamble Code}

\FloatFig{fig:newspreamble2}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{newspreamble2}}
{Newspaper Example\dash Setting the Late Preamble Code}

\item Construct a rectangle with opposing corners at: (551.0, 797.5)
and (580.0, 826.5) as shown in \figureref{fig:news27}.

\FloatFig{fig:news27}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{news27}}
{Newspaper Example\dash Constructing the Footer Frame}

\item Following the same procedure as before, \select\ this new
rectangle and make it a dynamic frame with the label
\framelabelref{footer} and middle alignment. Then click on the
\widget{flowframe.compute_sym_x_shift} button to calculate the
horizontal shift for even pages. Set the contents to just
\gls{itshape} (see \figureref{fig:news28}).

\FloatFig{fig:news28}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{news28}}
{Newspaper Example\dash Assigning the Footer Frame Data}

\item Save the image as \filefmt{newspaper.jdr} and then select the
\menu{file.export} menu item. Select the
\widget{filter.cls} filter, and save as
\filefmt{newspaper.cls}.

\item Use your favourite text editor to create a file called
\filefmt{news.tex} that looks like:
\begin{verbatim}
\documentclass{newspaper}

\begin{document}
% set the paragraph shape
\input{sheepcutout}
% suppress paragraph indentation
\noindent
There was much celebration yesterday morning when Little Bo
Peep's sheep finally returned home. They had been missing
for more than a week.

``I just didn't know where to find them,'' the shepherdess
stated, ``but I was told to leave them alone and they'd come
home.''

% lots of text omitted
\end{document}
\end{verbatim}
This file is also available in the \filefmt{examples} subdirectory
of \FlowframTk's installation directory.

\item The included \gls{bitmap} images are PNG files, which means that if you
are using a \LaTeX\ engine with the DVI output format, you will have to convert them
to Encapsulated Postscript (EPS). It's easier to simply use
\pdfLaTeX. Compile \filefmt{news.tex}:
\begin{verbatim}
pdflatex news
\end{verbatim}
The resulting document is shown in \figureref{fig:news25}.

\FloatFig{fig:news25}
[\setkeys{Gin}{width=\textwidth}]
{\includeimg{news25}}
{Newspaper Example\dash Final Document}

\end{enumerate}

Things to note:
\begin{itemize}
\item You may have noticed that I had the page list for all my frames
set to \widget{flowframe.pages_all}. Naturally if you
want more pages in your document, you will need to change this.
However on your final page you will need to specify an open ended
range. For example, if you have a 4 page document, then at least
one flow frame defined on page~4 should have a page list like
\verb|>3|. This is because the \sty{flowfram} package looks ahead
for the next flow frame before it ships out the page. If there are
no more flow frames defined, it will automatically create a new
flow frame, and you may end up with an unwanted page.

\item The \opt{twoside} class option is required to ensure the
\framelabelref{footer} frame's horizontal shift is implemented on even pages.
Since this example only has one page, there's no noticeable
difference.

\item If you use \FlowframTk\ to create shaped paragraphs for your
document, you must make sure that the \gls{normal-font-size} setting
in \FlowframTk's \dialog{clssettings} dialog box is the same as that
used by your document, otherwise it will affect the shape of the
paragraph.  Likewise, if your paragraph contains larger or smaller
than normal lines this will also adversely affect the paragraph
shape, and you will need to adjust the shape of the \gls{path}
accordingly.

Since I exported to a class rather than a package, the class file
correctly sets the normal font size to match the setting used by the
image, and I'm only using normal sized text in my paragraphs with no
displayed material, so I don't need to worry about it. However, if I
had exported to a package, for example \filefmt{newspaper.sty}, which was then
included in the document using:
\begin{verbatim}
\documentclass[twoside,12pt]{article}
\usepackage{newspaper}

\begin{document}
% set the paragraph shape
\input{sheepcutout}
% suppress paragraph indentation
\noindent
There was much celebration yesterday morning when Little Bo
% etc
\end{verbatim}
Then the paragraph shape will go wrong if the document normal size
doesn't match the image's normal size setting (see
\figureref{fig:news26}).

\FloatSubFigs{fig:news26}
[\setkeys{Gin}{width=0.4\linewidth}]
{
  {fig:news26a}{\includeimg{news26a}}{},
  {fig:news26b}{\includeimg{news26b}}{}
}
[The Normal Font Size Setting Affects Paragraph Shapes]
{The normal font size setting affects paragraph shapes:
\subfigref{fig:news26a} both the \LaTeX\ document and \FlowframTk\ have been
set to use a normal size font of 12pt\dash the paragraph follows the
correct shape;
\subfigref{fig:news26b} the \LaTeX\ document used 12pt as
the normal font size, but \FlowframTk\ had the normal font size set
to 10pt\dash the paragraph has too many narrow lines and spills over
the bottom of the frame.}

\end{itemize}

\section{A Brochure}\label{sec:brochure}

This example illustrates how to use \FlowframTk\ to create a
class that loads the \sty{flowfram} package. The aim is to
produce a two-sided document with different \gls{recto} and
\gls{verso} headers and footers.

\begin{enumerate}
\item For this example I'm going to start with the
\gls{grid.tschichold} grid.  Use \menu{settings.grid.settings} to
open the \gls{grid} dialog box. Select the \widget{grid.tschichold}
tab and set the \widget{grid.major} to 100\gls{pt}, as shown in
\figureref{fig:brochure1}. Make sure that the \gridlock\ is on
(\menu{settings.grid.lock}).

\FloatSideBySideFigs[][\setkeys{Gin}{width=\linewidth}]
{fig:brochure1}
{\includeimg{brochure1}}
{Brochure Example\dash Setting the Grid}
[
    \item Use \menu{settings.configtex} to open the
\dialog{texconfig} dialog and select the
\widget{clssettings.title} tab. Set the
\widget{clssettings.normalsize} to 10\gls{pt}, as shown in
\figureref{fig:brochure2}, and make sure the
\widget{clssettings.default_cls} radio button is selected.
]
{fig:brochure2}
{\includeimg{brochure2}}
{Brochure Example\dash Setting the Normal Font Size}

\item Set the image \gls{storageunit} to \gls{pt} using
\menu{settings.config} dialog box, as shown in
\figureref{fig:brochure3}

\FloatFig{fig:brochure3}
{\includeimg{brochure3}}
{Brochure Example\dash Setting the Storage Unit}

\item Select the \tool{rectangle} and draw the rectangle
with three of its vertices on the diagonals, as shown in
\figureref{fig:brochure4}. With the \gridlock\ on, you are limited to
only fourteen tick marks.

\FloatFig{fig:brochure4}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure4}}
{Brochure Example\dash Draw a Rectangle}

\item Switch to the \tool{select} and \select\ the rectangle. Then
use \menu{tex.flowframe.set_typeblock} to open the
\dialog{typeblock} dialog. Click on the
\widget{typeblock.compute_from_path} button. (If this button
is disabled, close the dialog and check that the rectangle has been
selected.) This will fill the margins, but it looks a bit untidy
with all those decimal places and since a \gls{pt} is so small such
precision seems unnecessary so round the
\widget{flowframe.margins.left} and
\widget{flowframe.margins.top} margins to the nearest
\gls{pt} (66\gls*{pt} and 94\gls*{pt}, respectively). Make sure
the \widget{typeblock.adjust_width_label} field is set to
1pc and click on the \widget{typeblock.adjust_width} button.
This should alter the \widget{flowframe.margins.right} field.
Make sure the \widget{typeblock.use_baseline} radio button
is selected and click on the
\widget{typeblock.adjust_height} button. Finally, click on
the \widget{typeblock.compute_sym_shift} button to calculate
the even page shift. The settings should now be as shown in
\figureref{fig:brochure5}. Click on the \dgls{okay} button to apply these
settings and close the dialog.

\FloatFig{fig:brochure5}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure5}}
{Brochure Example\dash Setting the Typeblock}

\item The \gls{typeblock} is slightly smaller than the rectangle so,
making sure the rectangle is still selected, use the menu item
\menu{tex.flowframe.scale_to_typeblock} to scale the rectangle so
that it's the same size as the \gls{typeblock}.  Then use the
\menu{tex.flowframe.set_frame} menu item to open the
\dialog{flowframe} dialog. Set the \widget{flowframe.type} to
\widget{flowframe.flow}, set the \widget{flowframe.label} to
\qt{main} and set the \widget{flowframe.border} to
\widget{flowframe.border_none}, as shown in
\figureref{fig:brochure6}. The margins and shifts should all be zero
and the page list \widget{flowframe.pages_all}.

\FloatFig{fig:brochure6}
{\includeimg{brochure6}}
{Brochure Example\dash Setting the Main Flow Frame}

\item Now use \menu{settings.grid.settings} to switch the grid to a
rectangular grid with 100\gls{pt} major divisions and use the
\tool{ellipse} to create a circle with a 100\gls*{pt} radius
\manmsg{centred} on (400,700), as shown in
\figureref{fig:brochure7}.

\FloatFig{fig:brochure7}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure7}}
{Brochure Example\dash Draw a Circle}

\item Switch to the \tool{select}, \select\ the circle and enable
\editpathmode. Use the \gls{index.menu.editpath} to remove the
segment from (500,700) to (400,800), convert the curve segments from
(400,800) to (300,700) and from (400,600) to (400,800) into line
segments, and move the control at (400,800) to (400,700). The
\gls{path} should now appear as shown in \figureref{fig:brochure8}.

\FloatFig{fig:brochure8}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure8}}
{Brochure Example\dash Change the Circle into an Arc}

\item Exit the \editpathmode\ and move the \gls*{path} to the bottom
right edge of the \gls{canvas}, as shown in
\figureref{fig:brochure9}.

\FloatFig{fig:brochure9}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure9}}
{Brochure Example\dash Move the Arc to the Bottom Right Corner}

\item Use \menu{edit.fill_colour} to change the 
\pathattr{fill-paint} to orchid (68\% red, 36\% green, 100\% blue) and use
\menu{edit.path.line_colour} to change the \pathattr{line-paint}
to \gls{transparent}. The arc should now appear as shown in
\figureref{fig:brochure10}.

\FloatFig{fig:brochure10}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure10}}
{Brochure Example\dash Apply a Fill Paint to the Arc}

\item Make sure the arc is still selected and
use \menu{tex.flowframe.set_frame} to open the
\dialog{flowframe} dialog. Set the
\widget{flowframe.type} to
\widget{flowframe.dynamic}, set the
\widget{flowframe.label} to \framelabelref{footer}, set the
\widget{flowframe.border} to
\widget{flowframe.border_as_shown},
set the \widget{flowframe.pages} to
\widget{flowframe.pages_odd} and set the
\widget{flowframe.align} to
\widget{flowframe.align_middle}.  Set the
\widget{flowframe.margins.left} and
\widget{flowframe.margins.top} margins to 40\gls{pt} and the
\widget{flowframe.margins.right} and
\widget{flowframe.margins.bottom} margins to 10\gls{pt}.
Next, click on the \widget{flowframe.edit} button to open
the mini \TeX\ editor and enter:
\begin{verbatim}
\bfseries\color{white}\Huge
\end{verbatim}
as shown in \figureref{fig:brochure11a}. Click on the
\dgls{okay} button to close the editor and return to the
\dialog{flowframe} dialog, which should now look like
\figureref{fig:brochure11b}.

\FloatSubFigs{fig:brochure11}
{
  {fig:brochure11a}{\includeimg{brochure11a}}{},
  {fig:brochure11b}{\includeimg{brochure11b}}{}
}
[Brochure Example\dash Setting The Odd Footer]
{Brochure Example\dash Setting the odd footer:
\subfigref{fig:brochure11a} entering the frame contents;
\subfigref{fig:brochure11b} the frame settings.}

\item Click \dgls{okay} to apply the new settings and close the dialog. The
image should now appear as shown in \figureref{fig:brochure12}.

\FloatFig{fig:brochure12}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure12}}
{Brochure Example\dash Arc is Now an Odd Footer}

\item Copy (\menu{edit.copy}) and paste
(\menu{edit.paste}) the arc to create a
duplicate. The duplicate should now be the only \gls{object}
selected. Use \menu{transform.scale} to open the
\dialog{scale} dialog and set the
\widget{scale.x} field to $-1$, as shown in
\figureref{fig:brochure13}. Click on the \dgls{okay} button and this should
flip the duplicate arc.

\FloatFig{fig:brochure13}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{brochure13}}
{Brochure Example\dash Flipping the Duplicate Arc}

\item With the duplicate arc still selected, use
\menu{tex.flowframe.set_frame} to open the
\dialog{flowframe} dialog box again. Set the
\widget{flowframe.label} to \framelabelref{evenfooter}, set the
\widget{flowframe.pages} to
\widget{flowframe.pages_even}, set the
\widget{flowframe.margins.left} margin to 10\gls{pt} and the
\widget{flowframe.margins.right} margin to 40\gls*{pt}.
The dialog should now appear as shown in \figureref{fig:brochure14}.

\FloatFig{fig:brochure14}
{\includeimg{brochure14}}
{Brochure Example\dash Setting the Even Footer}

\item Use \menu{tex.flowframe.display_page} to open the
\dialog{displaypage} dialog and select the
\widget{displaypage.even} radio button, as shown in
\figureref{fig:brochure15}.

\FloatFig{fig:brochure15}
[\setkeys{Gin}{scale=0.5}]
{\includeimg{brochure15}}
{Brochure Example\dash Changing the Display Page}

The \gls{canvas} should now look as shown in
\figureref{fig:brochure16}. The \framelabelref{footer} frame is no longer
displayed as it's only defined on odd pages.

\FloatFig{fig:brochure16}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure16}}
{Brochure Example\dash Even Pages Display}

\item Move the \framelabelref{evenfooter} frame to the bottom left corner, so
that it now appears as shown in \figureref{fig:brochure17}.

\FloatFig{fig:brochure17}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure17}}
{Brochure Example\dash Moving the Even Footer}

\item Use \menu{tex.flowframe.display_page} to open the
\dialog{displaypage} dialog again and select the
\widget{displaypage.all} radio button and click on the okay
button. The \gls{canvas} should now look like
\figureref{fig:brochure18}. The \framelabelref{evenfooter} frame now appears in
a different location, but that's just its odd page position. Since
the page list is set to even pages only, it won't actually be
displayed in that location in the document.

\FloatFig{fig:brochure18}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure18}}
{Brochure Example\dash \widget{displaypage.all} display mode shows all objects in
their odd-page location.}

\item Use the \tool{closed_line}
to create the \gls{path} shown in \figureref{fig:brochure19}. The
co-ordinates are: (310,0), (360,50),
(600,50) and (600,0).

\FloatFig{fig:brochure19}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure19}}
{Brochure Example\dash Adding a Closed Polygon}

\item Switch to the \tool{select} and \select\ this new polygon. Set
the \pathattr{fill-paint} to orchid and \pathattr{line-paint} to
\gls{transparent}, as done earlier for the arc. Then use
\menu{tex.flowframe.set_frame} to open the \dialog{flowframe} dialog
again. Set the \widget{flowframe.type} to
\widget{flowframe.dynamic}, set the \widget{flowframe.label} to
\framelabelref{header}, set the \widget{flowframe.pages} to
\widget{flowframe.pages_odd}, set the \widget{flowframe.border} to
\widget{flowframe.border_as_shown}, set the \widget{flowframe.align}
to \widget{flowframe.align_middle}, set the
\widget{flowframe.margins.left} to 50\gls{pt} and set the remaining
margins to 10\gls{pt}. Then click on the \widget{flowframe.edit}
button to open the editor, and set the contents to:
\begin{verbatim}
\bfseries\Large
\end{verbatim}
as shown in \figureref{fig:brochure20a}. Click on the \dgls{okay} button
to go close the editor and go back to the
\dialog{flowframe} dialog, which should now look like
\figureref{fig:brochure20b}.

\FloatSubFigs{fig:brochure20}
{
 {fig:brochure20a}{\includeimg{brochure20a}}{},
 {fig:brochure20b}{\includeimg{brochure20b}}{}
}
[Brochure Example\dash Setting The Odd Header]
{Brochure Example\dash Setting the odd header:
\subfigref{fig:brochure20a} entering the frame contents;
\subfigref{fig:brochure20b} the frame settings.}

\item Click on the \dgls{okay} button to apply these settings and close the
dialog. Keep the polygon selected and copy and paste it to create a
duplicate, as shown in \figureref{fig:brochure21}.

\FloatFig{fig:brochure21}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure21}}
{Brochure Example\dash Create a Duplicate Polygon}

\item Flip the duplicate using the same method as earlier
(\menu{transform.scale}) and, keeping the duplicate
selected, use \menu{tex.flowframe.set_frame} to open the
\dialog{flowframe} dialog again. Set the
\widget{flowframe.label} to \framelabelref{evenheader} and change the
left margin to 10\gls{pt} and the right margin to 50\gls*{pt}, as
shown in \figureref{fig:brochure22}.

\FloatFig{fig:brochure22}
{\includeimg{brochure22}}
{Brochure Example\dash Setting the Even Header}

\item Use \menu{tex.flowframe.display_page} to open the
\dialog{displaypage} dialog again and select the
\widget{displaypage.even} radio button to switch to the even
page view, as shown in \figureref{fig:brochure23}.

\FloatFig{fig:brochure23}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure23}}
{Brochure Example\dash Even Pages Display (Two Objects Hidden)}

\item Move the \framelabelref{evenheader} frame to the top left corner of the
\gls{canvas}, as shown in \figureref{fig:brochure24}.

\FloatFig{fig:brochure24}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure24}}
{Brochure Example\dash Move Even Header}

As with the \framelabelref{evenfooter} frame, when you switch back to the
\widget{displaypage.all} view, the frame will be displayed in its odd page
position, but since the page list is set to even pages only, it
won't be displayed in the document at that location.

\FloatFig{fig:brochure25}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure25}}
{Brochure Example\dash All Pages View Again (All Frames Shown in their
Odd Page Position)}

\item Save the image as \filefmt{brochure.jdr} or
\filefmt{brochure.ajr} using the \menu{file.save_as} menu
item. Then use \menu{file.export} to open the
\dialog{export} dialog. Select the
\widget{filter.cls} filter and export the image as
\filefmt{brochure.cls}.

\item Create a document that uses this new class. I've used the
\sty{blindtext} package to generate pages of dummy text for
illustrative purposes:
\begin{verbatim}
\documentclass[twoside]{brochure}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}

\usepackage{blindtext}

\begin{document}
\Blinddocument
\end{document}
\end{verbatim}

A double-page spread view of the resulting document (pages~2 and 3)
is shown in \figureref{fig:brochure-final}.

\FloatFig{fig:brochure-final}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{brochure-final}}
{Brochure Example\dash Double-Page Spread View of Brochure}

\end{enumerate}

\section{A House With No Mouse}\label{sec:accesstutorial}

This example illustrates how to create and edit pictures without
using the mouse.

\begin{enumerate}
\item For this example I'm going to use \gls{bp} units, both for the
grid and for the \gls{storageunit}. First for the grid, use the menu mnemonics
\mnemonictrail{settings.grid.settings}. This will open up the
\dialog{grid} dialog box shown in
\figureref{fig:gridsettings}.  The \widget{grid.major}
field should already have the focus, but if not, you can do
\mnemonic{grid.major}. Set this value to 100. Press the
\keys{\keyref{tab}} key to move to the unit \gls{dropdown}. Press the
\code{b} key to select \widgetfmt{bp}. Press \keys{\keyref{tab}} or
\mnemonic{grid.sub_divisions} to select the
\widget{grid.sub_divisions} field. Set this value to 10.
Then press \keys{\keyref{return}} or \accelerator{okay} to
apply these settings and close the \dialog{grid} dialog box.

\FloatFig{fig:gridsettings}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{gridsettings1a}}
{No Mouse Example\dash Grid Settings Dialog Box}

\item Use the menu mnemonics \mnemonictrail{settings.config} to open
the \dialog{config} dialog
(\figureref{fig:housenomousestorageunit}). If the
\widget{controls.title} tab isn't already visible, you can
do \mnemonic{controls.title} to select it. Then do
\mnemonic{controls.storage_unit} to move the focus to the
\gls*{storageunit} \gls{dropdown}. Press \code{b} to select
\widgetfmt{bp} or use the up/down cursor keys. If the focus is on
a \gls*{dropdown} you need to use \accelerator{okay} to apply these
settings and close the dialog box. If you move the focus to another
component, you can use \keys{\keyref{return}} instead.

\FloatFig{fig:housenomousestorageunit}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomousestorageunit}}
{No Mouse Example\dash Storage Unit}

\item Make sure that you don't have the \gridlock\ on as some of the
co-ordinates that this example uses lie between tick marks.
\accelerator{settings.grid.lock} or
\mnemonictrail{settings.grid.lock}
toggles between setting the grid lock on and off.

\item Select the \tool{rectangle},
using either \accelerator{tools.rectangle} or 
\mnemonictrail{tools.rectangle}.

\item The rectangle forming the main part of the house will go from
(100bp, 100bp) to (250bp, 200bp). To move the mouse either press
\accelerator{navigate.goto} or use the menu mnemonic 
\mnemonictrail{navigate}{goto}.
This will open up the \dialog{goto} dialog box shown in
\figureref{fig:housenomouse}. Set the \widget{coordinates.x} field
to 100bp and the \widget{coordinates.y} field to 100bp.  (You can
use the \keys{\keyref{tab}} key to move to the next focusable component, or you
can use \mnemonic{coordinates.x} to select the \widget{coordinates.x} field
and \mnemonic{coordinates.y} to select the \widget{coordinates.y} field.)
Then press \keys{\keyref{return}} or \accelerator{okay}.

\FloatFig{fig:housenomouse}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomousegoto}}
{No Mouse Example\dash Go To Co-Ordinate Dialog Box}

\item Press \accelerator{construct_click} to emulate a mouse
click.  This will anchor the rectangle at (100bp, 100bp). Then use
either \accelerator{navigate.goto} or
\mnemonictrail{navigate.goto} to display the \dialog{goto} dialog
box. Set the \widget{coordinates.x} field to 250bp and the
\widget{coordinates.y} field to 200bp. Then press
\keys{\keyref{return}} or \accelerator{okay}.

\item To complete the rectangle, press either \keys{\keyref{return}} or 
\accelerator{tools.finish}.
(See \figureref{fig:housenomouse1}.)

\FloatFig{fig:housenomouse1}
[\setkeys{Gin}{width=0.6\textwidth}]
{\includeimg{housenomouse1}}
{No Mouse Example\dash Completed Rectangle}

\item Let's make it a yellow brick house. To change the rectangle's
\pathattr{fill-paint}, we first need to switch to the \tool{select}. To do this
either use \accelerator{tools.select} or use the menu mnemonic
\mnemonictrail{tools.select}.

\item To select the rectangle, use either
\accelerator{navigate.skip} or \mnemonictrail{navigate.skip}.
Alternatively, you can use \mnemonictrail{navigate.by_description} which
will show the \dialog{description} dialog box with a \gls{dropdown} that you can use to
select an object by its description.

\begin{information}
Since there is only one object on the canvas, you could use any of the other select
functions in the \menu{navigate} menu, but
\accelerator{navigate.skip} is easier to type.
\end{information}

\item To change the \pathattr{fill-paint} use the menu mnemonic
\mnemonictrail{edit.fill_colour}. This will open up
the \dialog{fillpaintselector} dialog box shown in \figureref{fig:housenomouse2}.

\FloatFig{fig:housenomouse2}
[\setkeys{Gin}{width=\textwidth}]
{\includeimg{housenomouse2}}
{No Mouse Example\dash Set Fill Paint Dialog Box}

\item To select the \widget{paintselector.single} radio button,
either do \mnemonic{paintselector.single} or press \keys{\keyref{tab}} until
the \widget{paintselector.single} button has the focus, and then
press \keys{\keyref{space}}.

\item The single \manmsg{colour} selector will now be enabled. To change the
\manmsg{colour} to yellow, you can do one of the following:
\begin{itemize}
\item Press \keys{\keyref{tab}} until the yellow swatch
is selected, and then press \keys{\keyref{space}}.

\item Press \mnemonic{paintselector.rgb} to select the
\widget{paintselector.rgb} panel and set the
\widget{paintselector.red} field to 100, the
\widget{paintselector.green} field to 100, the
\widget{paintselector.blue} field to 0 and the
\widget{paintselector.alpha} field to 100.

\item Press \mnemonic{paintselector.cmyk} to select the
\widget{paintselector.cmyk} panel and set the
\widget{paintselector.cyan} field to 0, the
\widget{paintselector.magenta} field to 0, the
\widget{paintselector.yellow} field to 100, the
\widget{paintselector.black} field to 0 and the
\widget{paintselector.alpha} field to 100.
\end{itemize}
Then press \keys{\keyref{return}} or \accelerator{okay} to apply the
\pathattr{fill-paint} and close the dialog box (see \figureref{fig:housenomouse3}).

\FloatFig{fig:housenomouse3}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse3}}
{No Mouse Example\dash Fill Paint Set}

\item Next we need to construct a triangle for the roof. The
\tool{closed_line} is needed for this, so either use
\accelerator{tools.closed_line} or use the menu mnemonic
\mnemonictrail{tools.closed_line}.

\item The triangle vertices will be at (80bp, 100bp), (175bp, 50bp)
and (270bp, 100bp). Move to the first co-ordinate using either
\accelerator{navigate.goto} or \mnemonic{navigate}{goto} to open the
\dialog{goto} dialog, and set the \widget{coordinates.x} field to
80bp and the \widget{coordinates.y} field to 100bp. 
Press \keys{\keyref{return}} or \accelerator{okay} to
close the \dialog{goto} dialog box and move the mouse to the required location,
and press \accelerator{construct_click} to set the first vertex.

\item Repeat the process for the second and third vertices, and press
\accelerator{tools.finish} to complete the path. The path will automatically close.
(See \figureref{fig:housenomouse4}.)

\FloatFig{fig:housenomouse4}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse4}}
{No Mouse Example\dash Completed Triangle}

\item Let's make the roof red. First switch to the \tool{select}
using either \accelerator{tools.select} or \mnemonictrail{tools.select}.

\item Select the triangle using \accelerator{navigate.skip} or
\mnemonictrail{navigate.skip}.

\item Open the \dialog{fillpaintselector} dialog box using the menu mnemonic
\mnemonictrail{edit.fill_colour}.

\item Use \mnemonic{paintselector.single} to select the
\widget{paintselector.single} radio button.

\item To set the \manmsg{colour} to red either use the
\keys{\keyref{tab}} key to move
the focus to the red \manmsg{colour} swatch and press
\keys{\keyref{space}} or use
\mnemonic{colour.rgb} to select the
\widget{paintselector.rgb} tab and set the
\widget{paintselector.red} field to 100, the
\widget{paintselector.green} and \widget{paintselector.blue}
fields to 0 and the \widget{paintselector.alpha} field to 100.

\item Press \keys{\keyref{return}} or \accelerator{okay} to set the
\pathattr{fill-paint} and close the dialog box. (See
\figureref{fig:housenomouse5}).

\FloatFig{fig:housenomouse5}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse5}}
{No Mouse Example\dash Triangle Fill Paint Set to Red}

\item Now for the windows: press \accelerator{tools.rectangle} or use the menu mnemonic
\mnemonictrail{tools.rectangle} to select the \tool{rectangle}.

\item Create four rectangles using the method described above with
opposing vertices at:
\begin{itemize}
\item Window 1: (120bp, 180bp), (145bp, 155bp)
\item Window 2: (120bp, 135bp), (145bp, 110bp)
\item Window 3: (205bp, 135bp), (230bp, 110bp)
\item Window 4: (205bp, 180bp), (230bp, 155bp)
\end{itemize}
See \figureref{fig:housenomouse6}.

\FloatFig{fig:housenomouse6}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse6}}
{No Mouse Example\dash Windows Added}

\item To change the \pathattr{fill-paint} of the window rectangles, you will
first need to switch to the \tool{select} using either 
\accelerator{tools.select} or \mnemonictrail{tools.select}.

\item It's more efficient to select all four of the window
rectangles and change their \pathattr{fill-paint} simultaneously,
rather than setting the \pathattr{fill-paint} individually. Since
the four small rectangles are at the \gls{front} of the \gls{stack},
pressing \accelerator{navigate.add_next} four times will select
these four rectangles.

\item Now use the menu mnemonic
\mnemonic{edit.fill_colour} to set the \pathattr{fill-paint}
to white, following the same process as before to produce the
image shown in \figureref{fig:housenomouse7}.

\FloatFig{fig:housenomouse7}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse7}}
{No Mouse Example\dash Window Fill Paint Set}

\item Now make a black rectangle with
opposing corners at (160bp, 200bp) and (190bp, 160bp) using the
same method as above, to produce the image shown in
\figureref{fig:housenomouse8}.

\FloatFig{fig:housenomouse8}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse8}}
{No Mouse Example\dash Completed House}

\item To illustrate how to move \glspl{object} using the keyboard, let's
now shift the house 100bp to the right and 50bp down. First make
sure you are using the \tool{select}. Then \select\ all the objects using
either \accelerator{edit.select_all} or \mnemonictrail{edit.select_all}.

\item Then either press \accelerator{edit.moveby} or use the menu mnemonic
\mnemonictrail{edit.moveby}. This will open up the \dialog{moveby} dialog box
shown in \figureref{fig:housenomouse9}. Set the
\widget{coordinates.x} field to 100bp and the
\widget{coordinates.y} field to 50bp.

\FloatFig{fig:housenomouse9}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse9}}
{No Mouse Example\dash Move Dialog Box}

\item To illustrate how to edit a path using only the keyboard,
let's make the roof a bit shallower. First deselect all the objects
using \accelerator{edit.deselect_all} or \mnemonictrail{edit.deselect_all}.

\item Press \accelerator{navigate.skip} repeatedly until the triangle is selected.

\item To enter \editpathmode, use either \accelerator{edit.path.edit} or
\mnemonictrail{edit.path.edit}. You should now see the
path in edit mode. (See \figureref{fig:housenomouse10}.)

\FloatFig{fig:housenomouse10}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse10}}
{No Mouse Example\dash Edit Mode}

\item Press \accelerator{editpath.next_control} until the highest vertex is selected.

\item Press \accelerator{popup} to display the edit path menu
(\figureref{fig:housenomouse11}).

\FloatFig{fig:housenomouse11}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse11}}
{No Mouse Example\dash Edit Path Menu}

\item Press \mnemonic{editpath.coordinates} to display the
\dialog{coordinates} dialog box shown in \figureref{fig:housenomouse12}.

\FloatSideBySideFigs
 [][\setkeys{Gin}{width=\linewidth}]
{fig:housenomouse12}
{\includeimg{housenomouse12}}
{No Mouse Example\dash Control Point Co-Ordinates Dialog Box}
[
  \item Set the \widget{coordinates.y} field to 120bp,
  and press \accelerator{okay}.
  \item Press \accelerator{edit.path.edit} to exit \editpathmode. The image should now
  look like \figureref{fig:housenomouse13}.
]
{fig:housenomouse13}
{\includeimg{housenomouse13}}
{No Mouse Example\dash Editing Finished}

\item To illustrate how to create a \gls{textarea} using
the keyboard, let's add a label. First select the
\tool{textarea} using either \accelerator{tools.textarea} or 
\mnemonictrail{tools.textarea}.

\item Press \accelerator{navigate.goto} or \mnemonictrail{navigate.goto} to display
the \dialog{goto} dialog box. Set the
\widget{coordinates.x} field to 200bp and the
\widget{coordinates.y} field to 100bp.
Press \accelerator{okay} to close the dialog.

\item Press \accelerator{construct_click} to start the
\gls{textarea}.  You should now see a small pale rectangle with a
cursor, as illustrated in \figureref{fig:housenomouse14}. Whilst
this rectangle contains a cursor, you can type in text or press
\accelerator{popup} to display the \gls{index.menu.textarea}.

\FloatFig{fig:housenomouse14}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse14}}
{No Mouse Example\dash Creating a New Text Area}

\item Type in the text \code{House \glssymbol{hash}1}, then switch to the
\tool{select} (using \accelerator{tools.select} or \mnemonic{tools.select}.)

\item The \gls{textarea} contains one of \TeX's special characters,
namely the \gls{hash} character. This will cause a problem if you want
to save your image as a \env{pgfpicture} environment if the
\widget{textconfig.escape} (\sectionref{sec:texconfigtext}) is
not enabled. If so, you will need to modify the \gls{textarea} so
that it has an alternative text to be used if the image is saved in
a \LaTeX\ file. You can do this as follows:

\begin{enumerate}
\item Press \accelerator{navigate.skip} to select the \gls{textarea}.

\item Press \accelerator{edit.textarea.edit} or
\mnemonictrail{edit.textarea.edit}
to display the \dialog{edittext} dialog box. Select the
\widget{edittext.different} button (either \keys{\keyref{tab}} to it and
press \keys{\keyref{space}} or use \mnemonic{edittext.different}.) This will enable
the alternate text field. Change the text to \code{House \gls+{cshash}1}
(\figureref{fig:housenomouse15}).

\FloatFig{fig:housenomouse15}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse15}}
{No Mouse Example\dash Editing Text Area}

\item Press \keys{\keyref{return}} or \accelerator{okay} to update the
\gls{textarea}, and close the dialog box.
\end{enumerate}

\item It would look better if the label was \manmsg{centred} over the
house. In order to use the align function, it is necessary to
\gls{group} all the objects that make up the house. This is done as
follows:

\item Assuming you created all the objects in the same order as
listing in this example, the \gls{textarea} should be at
the front of the \gls{stack}, then the door, the four windows, the roof
and lastly the body of the house. You should still have the
\gls{textarea} selected, and nothing else. If not, deselect all
objects (\accelerator{edit.deselect_all}) and press 
\accelerator{navigate.skip} to select the \gls{textarea}.

\item Press \accelerator{navigate.skip} to deselect the \gls{textarea} and select
the next object in the \gls{stack} (the door).

\item Press \accelerator{navigate.add_next} to add the next object to the selection.
Keep pressing \accelerator{navigate.add_next} until everything has been selected except
the \gls{textarea}.

\item Press \accelerator{transform.group} or \mnemonictrail{transform.group} to
group the selected objects.

\item Press \accelerator{navigate.add_next} to add the \gls{textarea} to the selection.

\item Press \accelerator{transform.group} or
\mnemonictrail{transform.group} to group the selected objects.

\item Use the menu mnemonic
\mnemonictrail{transform.justify.centre} to \manmsg{centre} the
objects.

\item Press \accelerator{transform.ungroup} or
\mnemonictrail{transform.ungroup} to
ungroup the objects. The image should now look like
\figureref{fig:housenomouse16}.

\begin{information}
The house had to be grouped
and that group then grouped with the \gls{textarea} to
ensure that the individual house components maintained their
position relative to each other.
\end{information}

\FloatFig{fig:housenomouse16}
[\setkeys{Gin}{width=0.6\linewidth}]
{\includeimg{housenomouse16}}
{No Mouse Example\dash Text is Now \Manmsg{centred}}

\item If you want to save your image as a \env{pgfpicture}
environment, you will need to change the \textattr{anchor}
(\sectionref{sec:fontanchor}) settings to ensure that the
\gls{textarea} in the \LaTeX\ file remains \manmsg{centred}.
(Otherwise font differences may cause the text to appear slightly
off \manmsg{centre}.) To do this:

\begin{enumerate}
\item Ensure that the \gls{textarea} is selected.

\item Use the menu mnemonic
\mnemonictrail{edit.textarea.font.anchor.horizontal} to
display the \widget{font.hanchor} dialog box.

\item If the \gls{dropdown} doesn't already have the focus,
press \mnemonic{font.hanchor}.

\item Press \code{c} or use the arrow keys to set the
horizontal setting to \widget{font.anchor.hcentre}.

\item Press \keys{\keyref{return}} or \accelerator{okay} to apply the settings
and close the dialog box.
\end{enumerate}

Note that you don't need to do this if the
\widget{textconfig.anchor} \gls*{checkbox} is selected
in the \dialog{texconfig} dialog (\sectionref{sec:texconfig}) as it will
automatically update the anchor when you align the \gls*{textarea}.

\end{enumerate}

\section{A Lute Rose}\label{sec:rosetutorial}

This example illustrates how to use \glspl{symmetricshape} and
\glspl{pattern}. The aim is to design the lute rose (the decorative
cover of a lute's sound hole) shown in
\figureref{fig:rose-completed}. This example uses a radial grid. All
co-ordinates \radialcoords{\radiusmark}{\anglemark} are radial
co-ordinates where \radiusmark\ is the radius (\gls{bp}) and \anglemark\
is the angle (degrees).

\begin{warning}
Although the \glspl{co-ordinate} will be specified using the
\gls{co-ordinate.radial} components, these will be converted to the
usual left-handed \gls{co-ordinate.rectangular} coordinates for
internal storage, so if you change the \gls{grid}, the objects will
remain in the same place on the \gls{canvas} relative to the
rectangular grid origin.
This conversion may cause slight rounding errors.
\end{warning}

\begin{enumerate}
  \item Set the paper size to A3 landscape using the
  \menu{settings.paper} menu.

  \item Use \menu{settings.grid.settings} to select a
   radial grid with 100\gls{bp} major division interval, 10 sub-divisions and
   32 spokes. (See \figureref{fig:rose1}.)

\FloatFig{fig:rose1}
  {\includeimg{rose1}}
  {Selecting a Radial Grid}

  \item Create a \gls{path} (using the \tool{open_curve}
  and \editpathmode) starting at \radialcoords{20}{-170}
  containing three \glspl{Bezier-curve} with  \glspl{controlpt}:
  \begin{enumerate}
    \item \radialcoords{145}{-145}, \radialcoords{215}{-145}, \radialcoords{200}{-170}
    \item \radialcoords{200}{135}, \radialcoords{200}{-115}, \radialcoords{200}{170}
    \item \radialcoords{210}{150}, \radialcoords{255}{115}, \radialcoords{200}{100}
  \end{enumerate}
  (See \figureref{fig:rose2})

\FloatFig{fig:rose2}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{rose2}}
{The Underlying Path}

  \item In \editpathmode\, use the
   \gls{index.menu.editpath} and select 
   \menu{editpath.symmetry.has_symmetry}
   (see \figureref{fig:rose3}).

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth]}]
{fig:rose3}
{\includeimg{rose3}}
{Give the Path Symmetry Using the Popup Menu}
[
     \item Using the \gls{index.menu.editpath} again, deselect
     \menu{editpath.symmetry.join_anchor} (see
     \figureref{fig:rose4}).
]
{fig:rose4}
{\includeimg[width=\linewidth]{rose4}}
{De-anchoring the End Control Using the Popup Menu}

  \item Still in edit path mode, move the \glspl{controlpt}
    governing the line of symmetry (shown in blue by default) to
    \radialcoords{85}{-90} and \radialcoords{215}{90} (see \figureref{fig:rose5}).

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth}]
{fig:rose5}
{\includeimg{rose5}}
{Move the Line of Symmetry}
[
   \item Select the last \gls{controlpt} on the path (not including
     the line of symmetry) and select the edit path popup menu item
     \menu{editpath.convert_to_curve}. This should add a curve
     segment that joins the underlying path with its reflection (see
     \figureref{fig:rose6}). Note that this joining segment only has
    one curvature control to enforce symmetry.
]
{fig:rose6}
{\includeimg{rose6}}
{Add a Joining Curve Between the Underlying Path and its
Reflection}

  \item Move the curvature \gls{controlpt} on the join segment to
   \radialcoords{200}{0} (see \figureref{fig:rose7}).

\FloatFig{fig:rose7}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{rose7}}
{Adjust the Curvature Control of the Join Segment}

  \item Switch off \editpathmode\ and, ensuring the path is still
   selected, use the \menu{edit.path.style.all_styles}
   menu item to change the path style to: 10\gls*{bp} 
   \pathattr{line-width}, round \pathattr{cap-style} and 
   round \pathattr{join-style} (see \figureref{fig:rose8}).

\FloatFig{fig:rose8}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{rose8}}
{Change the Path Style}

  \item The path should now look like that shown in
    \figureref{fig:rose9}.

\FloatFig{fig:rose9}
[\setkeys{Gin}{width=\linewidth}]
{\includeimg{rose9}}
{The Symmetric Path}

  \item Ensure that the path is selected. Use the
   \menu{transform.pattern.set} menu item. This should
   open the dialog box shown in \figureref{fig:rose10}. Set the
   number of replicas to 11. Select the \widget{pattern.rotational}
   tab, and set the angle of rotation to 30 degrees.

\FloatFig{fig:rose10}
{\includeimg{rose10}}
{Setting the Pattern}

  \item The \gls{shape} should now look like that shown in
   \figureref{fig:rose11}.

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth}]
{fig:rose11}
{\includeimg{rose11}}
{The Pattern}
[
  \item Switch to edit path mode. You should now see an extra
    \gls{controlpt} (shown in green by default). Move this control
    to \radialcoords{0}{0} (see \figureref{fig:rose12}).
]
{fig:rose12}
{\includeimg{rose12}}
{Move the Control Governing the Rotational Anchor}

  \item Switch off \editpathmode, select the
    \tool{ellipse} and draw a circle
   around the pattern (see \figureref{fig:rose13}).

\FloatSideBySideFigs
[][\setkeys{Gin}{width=\linewidth}]
{fig:rose13}
{\includeimg{rose13}}
{Add a Circle Around the Pattern}
[
   \item Select the circle, set its \pathattr{fill-paint}
     to black and move the circle to the \gls{back}
     of the \gls{stack}. Select the pattern, and set its
     \pathattr{line-paint} to white. The
     image should now look as \figureref{fig:rose-completed}.
]
{fig:rose-completed}
{\includeimg{rose-completed}}
{The Completed Lute Rose}

\end{enumerate}

\chapter{JDR/AJR File Formats}\label{sec:jdrajrformat}

\FlowframTk\ has two native file formats that it can both read and
write. The \maingls{JDR} (\inlineglsdef{ext.jdr}) format is binary written
in the big-endian fashion. The \maingls{AJR} (\inlineglsdef{ext.ajr}) format is
an ASCII format. The \gls*{AJR} format has less precision than the
\gls*{JDR} format. The current version number for both formats
is~2.0.

The first line of the ASCII \gls*{AJR} format must be:
\begin{compactcodebox}
AJR \meta{version}
\end{compactcodebox}
where \meta{version} is the version number. For example:
\begin{verbatim}
AJR 1.8
\end{verbatim}
The version number must be followed by white space (such as a
newline or space character).

The binary \gls*{JDR} format starts with a sequence of the three 16-bit Unicode
characters \qt{JDR} followed by the version \emph{\type{string}} (not a
decimal number) which is save as an integer (the string length)
followed by each character of the version string. In Java this is
implemented using:
\begin{verbatim}
dout.writeChars("JDR");
dout.writeInt(version.length());
dout.writeChars(version);
\end{verbatim}
where \code{dout} is a \code{java.io.DataOutputStream} object
and \code{version} is a \code{java.lang.String}.

The remainder of both the \gls*{JDR} and \gls*{AJR} formats have the
same syntax but the data types are stored differently.

\begin{deflist}
\itemtitle{\typedef{integer}}
\begin{itemdesc}
The binary version writes 32-bit signed two's complement integers using the
\code{writeInt(int)} method of the
\code{java.io.DataOutputStream} class. The ASCII version writes
the integer to the file followed by white space.
\end{itemdesc}

\itemtitle{\typedef{byte}}
\begin{itemdesc}
The binary version writes 8-bit signed two's complement bytes using the
\code{writeByte(byte)} method of the
\code{java.io.DataOutputStream} class. The ASCII version is the
same as for the \type{integer} type, but the range of values is more
limited.
\end{itemdesc}

\itemtitle{\typedef{long}}
\begin{itemdesc}
The binary version writes 64-bit two's complement integers using the 
\code{writeLong(long)} method of the
\code{java.io.DataOutputStream} class. The ASCII version is the
same as for the \type{integer} type.
\end{itemdesc}

\itemtitle{\typedef{float}}
\begin{itemdesc}
The binary version writes single-precision 32-bit floating point
values using the \code{writeFloat(float)} method of the
\code{java.io.DataOutputStream} class. The ASCII version writes
the number (possibly truncated) to the file followed by white space.
\end{itemdesc}

\itemtitle{\typedef{double}}
\begin{itemdesc}
The binary version writes double-precision 64-bit floating point
values using the \code{writeDouble(double)} method of the
\code{java.io.DataOutputStream} class. The ASCII version is the
same as for the \type{float} type.
\end{itemdesc}

\itemtitle{\typedef{boolean}}
\begin{itemdesc}
The binary version writes boolean values using the
\code{writeBoolean(boolean)} method of the
\code{java.io.DataOutputStream} class. The ASCII version writes
the number \code{0} (false) or \code{1} (true) to the file
followed by white space.
\end{itemdesc}

\itemtitle{\typedef{char}}
\begin{itemdesc}
The binary version writes a single 16-bit Unicode character using
the \code{writeChar(int)} method of the
\code{java.io.DataOutputStream} class. The ASCII version writes
the character followed by white space.
\end{itemdesc}

\itemtitle{\typedef{string}}
\begin{itemdesc}
A string consisting of \meta{n} 16-bit Unicode characters is written
as an \type{integer} followed by the \meta{n} characters of type
\type{char}. For the binary format, this is equivalent to:
\begin{verbatim}
dout.writeInt(text.length());
dout.writeChars(text);
\end{verbatim}
where \code{dout} is a \code{java.io.DataOutputStream} object
and \code{text} is a \code{java.lang.String}. For the ASCII format,
the length is written as an integer followed by a \emph{single}
white space character. (Avoid using \code{println} for just \meta{n} as the
end-of-line character for some operating systems consists of two
characters.) Then the string is written followed by white space.
For example:
\begin{verbatim}
out.print(String.format("%d %s ", text.length(), text));
\end{verbatim}
or
\begin{verbatim}
out.println(String.format("%d %s", text.length(), text));
\end{verbatim}
(where \code{out} is a \code{java.io.PrintWriter} object.)
As in the above example, a newline character can be used after the
string, just not after the number.

A null or empty string is just written as the number 0. For example,
for the binary version:
\begin{verbatim}
dout.writeInt(0);
\end{verbatim}
or for the ASCII version:
\begin{verbatim}
out.print("0 ");
\end{verbatim}
\end{itemdesc}

\itemtitle{\typedef{transform-matrix}}
\begin{itemdesc}
A transformation matrix is saved as six \type{double} values
representing the scale-$x$ factor, the shear-$y$
factor, the shear-$x$ factor, the scale-$y$
factor, the $x$-translation and the
$y$-translation. For versions below 1.8, the translations
are in terms of the \gls{bp} PostScript unit, otherwise they are in
terms of the \gls{storageunit}.
\end{itemdesc}

\itemtitle{\typedef{float-array}}
\begin{itemdesc}
An array of \type{float} values is stored as an \type{integer}
\meta{n} indicating the length of the array (may be 0 for a null or empty
array) followed by the \meta{n} \type{float} array elements.
\end{itemdesc}

\itemtitle{\typedef{double-array}}
\begin{itemdesc}
An array of \type{double} values is stored as an \type{integer}
\meta{n} indicating the length of the array (may be 0 for a null or empty
array) followed by the \meta{n} \type{double} array elements.
\end{itemdesc}

\itemtitle{\typedef{unit-id}}
\begin{itemdesc}
A unit identifier is stored as a \type{byte}. This may take one of eight
values: 0 (\gls{pt}), 1 (inch), 2 (cm), 3 (\gls{bp}), 4 (mm), 5
(pc), 6 (dd) or 7 (cc).
\end{itemdesc}

\itemtitle{\typedef{length}}
\begin{itemdesc}
Lengths that are independent of the \gls{storageunit} are stored as a
\type{double} followed by the \type{unit-id}.
\end{itemdesc}

\itemtitle{\typedef{angle}}
\begin{itemdesc}
An angle is stored as a \type{double} followed by a \type{byte}
indicating the unit where 0 represents radians and 1 represents
degrees.
\end{itemdesc}

\itemtitle{\typedef{paint}}
\begin{itemdesc}
\Manmsg{colour} data is stored as a \type{char} indicating the
\manmsg{colour} type (\meta{col-id}).  Available types are listed in
\tableref{tab:jdrcolourtypes}.

If \meta{col-id} is \code{T} (transparent) this ends the paint
information. Otherwise \meta{col-id} is followed by the
\manmsg{colour} specifications (\meta{\manmsg{colour}-specs}).

\begin{table}[htbp]
\caption{Available \Manmsg{colour} Types}
\label{tab:jdrcolourtypes}
\centering
\begin{tabular}{lll}
\bfseries Type & \bfseries ID & \bfseries Version\\
Transparent & \code{T} & 1.0 onwards\\
RGB & \code{R} & 1.0 onwards\\
CMYK & \code{C} & 1.0 onwards\\
Linear Gradient & \code{G} & 1.0 onwards\\
Radial Gradient & \code{D} & 1.3 onwards\\
\Manmsg{grey} & \code{Y} & 1.4 onwards\\
HSB & \code{S} & 1.4 onwards
\end{tabular}
\end{table}
\end{itemdesc}


\itemtitle{\typedef{rgb}}
\begin{itemdesc}
RGB \manmsg{colour} specs are saved as four \type{float} values in the
range 0 to 1 (inclusive) representing the red, green, blue and alpha
components.
\end{itemdesc}

\itemtitle{\typedef{cmyk}}
\begin{itemdesc}
CYMK \manmsg{colour} specs are saved as five \type{float} values in the
range 0 to 1 (inclusive) representing the cyan, magenta, yellow, black
and alpha components.
\end{itemdesc}

\itemtitle{\typedef{hsb}}
\begin{itemdesc}
HSB \manmsg{colour} specs are saved as four \type{float} values
representing the hue, saturation, brightness and alpha components.
The hue value must lie in the range 0 (inclusive) to 360
(exclusive). The other values must lie in the range 0 to 1
(inclusive).
\end{itemdesc}

\itemtitle{\typedef{grey}}
\begin{itemdesc}
\Manmsg{grey} specs are saved as two \type{float} values in the range 0 to
1 (inclusive) representing the \manmsg{grey} and alpha components.
\end{itemdesc}

\itemtitle{\typedef{linear-paint}}
\begin{itemdesc}
Linear gradient paint specs are saved as the start \type{paint}, the
end \type{paint} followed by an \type{integer} indicating the
direction, which may be one of: 0 (North), 1 (North-East), 2 (East),
3 (South-East), 4 (South), 5 (South-West), 6 (West) or 7 (North-West).
\FlowframTk\ doesn't support another gradient type as the
start or end paint.
\end{itemdesc}

\itemtitle{\typedef{radial-paint}}
\begin{itemdesc}
Radial gradient paint specs are saved as the start \type{paint}, the
end \type{paint} followed by an \type{integer} indicating the
starting location, which may be one of: 0 (North), 1 (North-East), 2 (East),
3 (South-East), 4 (South), 5 (South-West), 6 (West), 7 (North-West)
or 8 (\Manmsg{centre}).
\FlowframTk\ doesn't support another gradient type as the
start or end paint.
\end{itemdesc}

\end{deflist}

\begin{important}
Spaces in any syntax specifications below are for clarity and ease
of line breaking only and don't form part of the specification
(although white space may be acceptable at that point in the ASCII
\gls{AJR} format, according to the above data types).
\end{important}

\begin{numbered}

\item \label{jdr:storageunit}\Gls{storageunit}
\begin{jdrversion}{1.8 onwards}
\begin{syntaxline}
\meta{storage-id}
\end{syntaxline}
\end{jdrversion}
Regardless of whether or not the settings are saved in the file, as
from JDR/AJR version 1.8 the \gls{storageunit} \meta{storage-id} is
always present immediately after the version number and is used for
all lengths described below (including \glspl{co-ordinate}) unless
otherwise indicated. The unit is saved as a \type{unit-id} type.

Versions below 1.8 must have all lengths stored as
\glslink{bp}{PostScript points}.

\item Versions 2.1 and above only include the origin shift.
\begin{jdrversion}{2.1 onwards}
\begin{syntaxline}
\meta{origin-x} \meta{origin-y}
\end{syntaxline}
\end{jdrversion}
These values are in terms of the storage unit and indicate where the
co-ordinate origin is in relation to the top left corner of the
\gls{canvas}.
% TODO implement this

\item\label{jdr:settings-id}Setting ID.
\begin{syntaxline}
\meta{settings-id}
\end{syntaxline}
Next is a value \meta{settings-id} indicating whether or not the
\FlowframTk\ settings (\sectionref{sec:settings}) are
stored.
In version 1.3 onwards, this value is a \type{byte}, and may take one of three
values: 0 (no settings), 1 (all settings) or 2 (paper size only).
In versions prior to 1.3, this value is a \type{boolean} value,
where true indicates all settings and false indicates no settings.

\item\label{jdr:settings}
The settings information is stored as follows when the
\meta{settings-id} is 1 (or true):
\begin{jdrversion}{1.0--1.7}
\begin{syntaxline}
\meta{show-grid} \meta{lock-grid} \meta{show-rulers} \meta{tool-id}
\meta{normalsize} \meta{paper} \meta{grid}
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.8 onwards}
\begin{syntaxline}
\meta{show-grid} \meta{lock-grid} \meta{show-rulers} \meta{tool-id}
\meta{paper} \meta{grid} \meta{point size} \meta{scale flag}
\end{syntaxline}
\end{jdrversion}
If \meta{settings-id} is 2, just \meta{paper} is present.

  \begin{enumerate}% settings info
  \item \meta{show-grid} is a \type{boolean} variable indicating whether or
  not to display the \gls{grid}.

  \item \meta{lock-grid} is a \type{boolean} variable indicating whether or
  not to lock the \gls{grid}.

  \item \meta{show-rulers} is a \type{boolean} variable indicating whether
  or not to show the \glspl{ruler}.

  \item \meta{tool-id} is an \type{integer} indicating which tool to select. For
  versions below 1.8, this must be an \type{integer} in the range 0 and~7
  (inclusive). As from version 1.8, this must be in the range 0 and~8
  (inclusive).  \tableref{tab:toolid} indicates the ID for each tool.

\FloatTable
{tab:toolid}
{%
  \begin{tabular}{ll}
  \bfseries ID & \bfseries Tool\\
  0 & Select\\
  1 & Open Line Path\\
  2 & Closed Line Path\\
  3 & Open Curve Path\\
  4 & Closed Curve Path\\
  5 & Rectangle\\
  6 & Ellipse\\
  7 & Text\\
  8 & \Manmsg{maths} (as from version 1.8)
  \end{tabular}
}
{Tool Identifiers}

\item \Gls{normal-font-size}.
  \begin{jdrversion}{1.0--1.7}
  For versions below 1.8, \meta{normalsize} is an \type{integer} indicating the
  \LaTeX\ \gls{normal-font-size}. As from version 1.8, this value
  is stored later (see \ref{jdr:imagetex} below) and isn't governed by
  the settings flag.
  \end{jdrversion}

  \item\label{jdr:paper}The \meta{paper} specs are:
  \begin{jdrversion}{1.0--1.2}
  \begin{syntaxline}
  \meta{paper-id} [\meta{width} \meta{height} \meta{portrait-flag}]
  \end{syntaxline}
  \end{jdrversion}
  \begin{jdrversion}{1.3 onwards}
  \begin{syntaxline}
  \meta{paper-id} [\meta{width} \meta{height}]
  \end{syntaxline}
  \end{jdrversion}
  The paper size \meta{paper-id} is specified as a \type{byte}.
  For versions below 1.3, this must be a number in the range 0 to~18
  (inclusive), otherwise it must be in the range 0 to~72 (inclusive).
  Table~\ref{tab:paperid} indicates the ID for each paper size,
  and Table~\ref{tab:paperid1.3} shows additional values for version
  1.3 onwards.  If the paper size has an ID of 18 (user defined), then there
  must follow the paper \meta{width} (a \type{double} in \gls{bp})
  and \meta{height} (a \type{double} in \gls{bp}). For versions prior to 1.3,
  the user defined setting must also be followed by
  \meta{portrait-flag} a \type{boolean} variable to indicate
  whether or not the orientation is portrait (true) or
  landscape (false). The paper dimensions are always stored
  in PostScript points (\gls{bp}) and the unit id isn't saved.
  (This is still true for version 1.8.)

\FloatTable
{tab:paperid}
{%
  \begin{tabular}{llll}
  \bfseries ID & \bfseries Paper Size &
  \bfseries ID & \bfseries Paper Size\\
  0 & A0 (portrait) & 9 & A0 (landscape)\\
  1 & A1 (portrait) & 10 & A1 (landscape)\\
  2 & A2 (portrait) & 11 & A2 (landscape)\\
  3 & A3 (portrait) & 12 & A3 (landscape)\\
  4 & A4 (portrait) & 13 & A4 (landscape)\\
  5 & A5 (portrait) & 14 & A5 (landscape)\\
  6 & letter (portrait) & 15 & letter (landscape)\\
  7 & legal (portrait) & 16 & legal (landscape)\\
  8 & executive (portrait) & 17 & executive (landscape)\\
  18 & user defined
  \end{tabular}
}
{Paper Size Identifiers}

\FloatTable{tab:paperid1.3}
{%
  \begin{tabular}{llll}
  \bfseries ID & \bfseries Paper Size &
  \bfseries ID & \bfseries Paper Size\\
  19 & A6 (portrait) & 46 & A6 (landscape)\\
  20 & A7 (portrait) & 47 & A7 (landscape)\\
  21 & A8 (portrait) & 48 & A8 (landscape)\\
  22 & A9 (portrait) & 49 & A9 (landscape)\\
  23 & A10 (portrait) & 50 & A10 (landscape)\\
  24 & B0 (portrait) & 51 & B0 (landscape)\\
  25 & B1 (portrait) & 52 & B1 (landscape)\\
  26 & B2 (portrait) & 53 & B2 (landscape)\\
  27 & B3 (portrait) & 54 & B3 (landscape)\\
  28 & B4 (portrait) & 55 & B4 (landscape)\\
  29 & B5 (portrait) & 56 & B5 (landscape)\\
  30 & B6 (portrait) & 57 & B6 (landscape)\\
  31 & B7 (portrait) & 58 & B7 (landscape)\\
  32 & B8 (portrait) & 59 & B8 (landscape)\\
  33 & B9 (portrait) & 60 & B9 (landscape)\\
  34 & B10 (portrait) & 61 & B10 (landscape)\\
  35 & C0 (portrait) & 62 & C0 (landscape)\\
  36 & C1 (portrait) & 63 & C1 (landscape)\\
  37 & C2 (portrait) & 64 & C2 (landscape)\\
  38 & C3 (portrait) & 65 & C3 (landscape)\\
  39 & C4 (portrait) & 66 & C4 (landscape)\\
  40 & C5 (portrait) & 67 & C5 (landscape)\\
  41 & C6 (portrait) & 68 & C6 (landscape)\\
  42 & C7 (portrait) & 69 & C7 (landscape)\\
  43 & C8 (portrait) & 70 & C8 (landscape)\\
  44 & C9 (portrait) & 71 & C9 (landscape)\\
  45 & C10 (portrait) & 72 & C10 (landscape)
  \end{tabular}
}
{Additional Paper Size Identifiers (JDR v1.3 onwards)}

  \item The \meta{grid style} has the syntax:
  \begin{jdrversion}{1.0--1.5}
  \begin{syntaxline}
  \meta{unit} \meta{major} \meta{minor}
  \end{syntaxline}
  This is the same as the \meta{grid-specs}
  for the \hyperref[jdr:rectgrid]{rectangular grid} described below, 
  however the \meta{major} unit for versions below 1.6 is an \type{integer} not a
  \type{double}. The \meta{unit} is restricted to
  0 (\glslink{pt}{\TeX\ pt}), 1 (inches),
  2 (centimetres) or 3 (\glslink{bp}{PostScript points}).
  \end{jdrversion}
  \begin{jdrversion}{1.6 onwards}
  \begin{syntaxline}
  \meta{grid-id} \meta{grid-specs}
  \end{syntaxline}
  The \meta{grid-id} is a \type{byte} representing the grid style ID.
  Recognised IDs are listed in \Tableref{tab:jdrgridids}.
  \end{jdrversion}

\FloatTable{tab:jdrgridids}
{%
 \begin{tabular}{lll}
  \bfseries ID & \bfseries Grid & \bfseries From Version\\
  0 & Rectangular & 1.6\\
  1 & Radial & 1.6 \\
  2 & Isometric & 1.8\\
  3 & Tschichold & 1.8\\
  4 & Path-Based & 2.0
 \end{tabular}
}
{Grid Identifiers}

  The grid specification (1.6 onwards) is as follows

    \begin{enumerate}
    \item\label{jdr:rectgrid} Rectangular Grid. The \meta{grid-specs} are:
    \begin{syntaxline}
    \meta{unit} \meta{major} \meta{minor}
    \end{syntaxline}
    where
     \begin{enumerate}
     \item \meta{unit} is the \type{unit-id} representing the grid unit.

       \item \meta{major} is a \type{double} representing the major
        grid division (in terms of the grid unit).

       \item \meta{minor} is an \type{integer} representing the grid subdivision.

     \end{enumerate}

     \item Radial Grid. The \meta{grid-specs} are:
    \begin{jdrversion}{1.6--2.0}
    \begin{syntaxline}
    \meta{unit} \meta{major} \meta{minor} \meta{spokes}
    \end{syntaxline}
    \end{jdrversion}
    \begin{jdrversion}{2.1 onwards}
    \begin{syntaxline}
    \meta{unit} \meta{major} \meta{minor} \meta{spokes} \meta{page-dependent}
    \end{syntaxline}
    \end{jdrversion}
    where:
      \begin{enumerate}
       \item \meta{unit} is the \type{unit-id}.

       \item \meta{major} is a \type{double} representing the major grid division.

       \item \meta{minor} is an \type{integer} representing the grid subdivision.

       \item \meta{spokes} is an \type{integer} representing the number of spokes.

       \item \meta{page-dependent} is a \type{boolean} setting
       introduced in version 2.1. A value of true indicates that the
       radial grid depends on the paper (that is, the grid is
       \manmsg{centred} on the paper, with the top left of the paper
       bounds coinciding with the underlying rectangular grid origin). 
       A value of false indicates that the radial grid is \manmsg{centred} 
       on the underlying rectangular origin.
      \end{enumerate}

     \item Isometric Grid. The \meta{grid-specs} are:
    \begin{syntaxline}
    \meta{unit} \meta{major} \meta{minor}
    \end{syntaxline}
    where
      \begin{enumerate}
       \item \meta{unit} is the \type{unit-id} representing the grid unit.

       \item \meta{major} is a \type{double} representing the major
        grid division (in terms of the grid unit). This is the
length of each side of the equilateral triangles that form the grid.

       \item \meta{minor} is an \type{integer} representing the grid subdivision.
      \end{enumerate}
 
    \item A Tschichold grid. The
     \meta{grid-specs} are the same as for the 
     \hyperref[jdr:rectgrid]{rectangular grid}.

    \item A path-based grid. The \meta{grid-specs} are:
     \begin{syntaxline}
     \meta{unit} \meta{major} \meta{minor} \meta{segment-spec}+
     \end{syntaxline}
     where \meta{unit}, \meta{major} and \meta{minor} are as above. The
     \meta{segment-spec} elements define the path used by the grid.
     (Note that the grid-path syntax is much simpler than the
     \gls{path} object syntax, as there's no associated paint or
     style etc.) Each \meta{segment-spec} has the syntax
     \begin{syntaxline}
     \meta{segment-type} [\meta{coords}]
     \end{syntaxline}
    The \meta{segment-type} is an \type{integer} representing the
     segment type. The path must start with a move segment. The
     \meta{segment-type} may only be one of the following values:
     \begin{description}
      \item[-1] End of path. The \meta{coords} element should be
       omitted. This must always be the last \meta{segment spec}.
       No further \meta{segment spec} elements are
       permitted after this.
      \item[0] A move. The \meta{coords} must have the syntax
      \begin{syntaxline}
       \meta{x} \meta{y}
      \end{syntaxline}
      which describe the co-ordinates to move to. These are both a
      \type{double}.
      \item[1] A line. The \meta{coords} are the same as for
      a move.
      \item[2] A quadratic \gls{Bezier-curve}. The \meta{coords} must have
       the syntax
      \begin{syntaxline}
       \meta{cx} \meta{cy} \meta{x} \meta{y}
      \end{syntaxline}
      where the curvature control is given by (\meta{cx}, \meta{cy})
      and the end point is given by (\meta{x}, \meta{y}). Each
      co-ordinate is a \type{double}.
      \item[3] A cubic \gls{Bezier-curve}. The \meta{coords} must have
       the syntax
      \begin{syntaxline}
       \meta{c1x} \meta{c1y} \meta{c2x} \meta{c2y} \meta{x} \meta{y}
      \end{syntaxline}
      where the curvature controls are given by (\meta{c1x},
      \meta{c1y}) and (\meta{c2x}, \meta{c2y})
      and the end point is given by (\meta{x}, \meta{y}). Each
      co-ordinate is a \type{double}.
      \item[4] A line segment that closes the path or sub-path.
      The \meta{coords} element should be omitted.
     \end{description}

     The co-ordinate units must match the grid unit.

    \end{enumerate}

    \item \Gls{controlpt} setting.
  \begin{jdrversion}{1.8 onwards}
  \begin{syntaxline}
  \meta{point size} \meta{scale flag}
  \end{syntaxline}
  As from JDR version 1.8, the \meta{point size} is also saved as a
  \type{length}, followed by a \type{boolean} value \meta{scale flag}
  indicating whether the \gls{controlpt} scaling is enabled.
  \end{jdrversion}

  \end{enumerate}% end of settings info

\item\label{jdr:imagetex}\TeX\ settings.
\begin{jdrversion}{2.1 onwards}
\begin{syntaxline}
\meta{normalsize} \meta{preamble} \meta{mid-preamble}
\meta{late-preamble} \meta{document body} \meta{magic comments} \meta{class name}
\meta{absolute pages flag}
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.9--2.0}
\begin{syntaxline}
\meta{normalsize} \meta{preamble} \meta{mid-preamble}
\meta{late-preamble} \meta{class name}
\meta{absolute pages flag}
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.8}
\begin{syntaxline}
\meta{normalsize} \meta{preamble} \meta{class name}
\meta{absolute pages flag}
\end{syntaxline}
\end{jdrversion}
For version 1.8 onwards, the \LaTeX\ \gls{normal-font-size} value is always
saved at this point, regardless of the
\hyperref[jdr:settings-id]{\meta{settings-id}}.  In addition, from
version 1.8, preamble text, document class and absolute pages
setting are now saved. Version 1.8 only stores the \gls{early-preamble}
text.  As from version 1.9, the \gls{mid-preamble} and
\gls{late-preamble} text are also stored. As from version 2.1, 
the \gls{document-body} and \glspl{magic-comment} are also stored.
\begin{enumerate}
\item The normal size value \meta{normalsize} is stored as an \type{integer}.

\item The preamble text \meta{preamble} is stored as a \type{string}
and may be empty or null. Similarly for the \meta{mid-preamble}
and \meta{late-preamble}, for version 1.9 onwards, and for the
\meta{document body} and \meta{magic comments}, for version 2.1 onwards.

\item If the default document class setting is enabled, \meta{class
name} is saved as an empty or null \type{string} otherwise the user
specified \meta{class name} is saved.

\item The \meta{absolute pages flag} is saved as a \type{boolean} value,
where true indicates \sty{flowfram}'s \optval{pages}{absolute}
option and false indicates \sty{flowfram}'s
\optval{pages}{relative} option.
\end{enumerate}

\item\label{jdr:object} The \glspl{object} that constitute the
image are now stored.  When saving to a file, an outer grouping is
implied that is not evident whilst using \FlowframTk. This means that
there should always be a single group structure saved to file which
contains all the \glspl{object} that
constitute the picture. Each \gls{object} is then recursively
stored. For example, if an image contains a \gls{path}, a
\gls{group} and a \gls{textarea}, in the
\gls{JDR}/\gls{AJR} file these three objects will be stored as a single
group structure containing the three objects. If in \FlowframTk\ you
explicitly \gls{group} all the objects, then in the
\gls{JDR} file, the \hyperref[jdr:object]{outermost implicit group} will contain
only one \gls{object} which will be this \gls{group}. It's an error
for the top-level object to be anything other than a \gls{group}.

Each \gls{object} is saved as \meta{object data} which has the following format:
\begin{syntaxline}
\begin{jdrversion}{1.0 \& 1.1}
\meta{id-char} \meta{object-specs} \meta{fflag} [\meta{flowframe-specs}]
\end{jdrversion}
\begin{jdrversion}{1.2--2.0}
\meta{id-char} \meta{object-specs} \meta{fflag} [\meta{flowframe-specs}]
\meta{description}
\end{jdrversion}
\begin{jdrversion}{2.1 onwards}
\meta{id-char} \meta{object-specs} \meta{fflag} [\meta{flowframe-specs}]
\meta{description} \meta{tag}
\end{jdrversion}
\end{syntaxline}
where \meta{id-char} is a \type{char} determining the object type.
Valid object type identifiers are listed in
\Tableref{tab:jdrobjecttypes}.

\FloatTable{tab:jdrobjecttypes}
{%
  \begin{tabular}{lll}
  \bfseries ID &  \bfseries Object & \bfseries From Version\\
  \code{G} & \hyperref[jdr:group]{Group} & 1.0\\
  \code{P} & \hyperref[jdr:path]{Path} & 1.0\\
  \code{T} & \hyperref[jdr:textarea]{Text Area} & 1.0\\
  \code{I} & \hyperref[jdr:bitmap]{Bitmap} & 1.0\\
  \code{X} & \hyperref[jdr:textpath]{Text Path} & 1.5\\
  \code{S} & \hyperref[jdr:symmetric]{Symmetric Shape} & 1.6\\
  \code{R} & \hyperref[jdr:rotational]{Rotational Pattern} & 1.6\\
  \code{C} & \hyperref[jdr:scaled]{Scaled Pattern} & 1.6\\
  \code{L} & \hyperref[jdr:spiral]{Spiral Pattern} & 1.6
  \end{tabular}
}
{Object Type Identifiers}

The object specifications \meta{object-specs} vary according to the
object type and are described \hyperref[jdr:objectspecs]{below}.
\meta{fflag} is a \type{boolean} value indicating whether or not
this object has \gls{flowframe} data associated with it. If true, then the
\gls{flowframe} specifications \meta{flowframe-specs} should follow
(\hyperref[jdr:flowframe]{see below}), otherwise
\meta{flowframe-specs} should be omitted. Note that JDR version 1.2
and above contains the \type{string} \meta{description}, which was
omitted in earlier versions, and version 2.1 and above contains the
\type{string} tag.

Note that the \dialog{tag} dialog box (see
\sectionref{sec:objecttag}) restricts allowed characters in the tag,
but \FlowframTk\ doesn't enforce this when loading a \gls{JDR}
or \gls{AJR} file.

Recall from \hyperref[jdr:object]{above} that the image is stored with an implied outer grouping. The
\meta{flowframe-specs} for this implicit group represents the image
\gls+{typeblock} and the \meta{description} represents the image description.
The \meta{tag} is also included for version 2.1 and above which
represents the image's tag, but \FlowframTk\ currently doesn't
provide a function to set a tag for the complete image.

\end{numbered}

\plabel[Object Specs]{jdr:objectspecs}The \meta{object-specs} are as follows:

\begin{numbered}
\item\label{jdr:group} Group data, \code{G}, has the
\meta{object-specs} stored as:
\begin{syntaxline}
\meta{n} \meta{object data}+
\end{syntaxline}
where \meta{n} is an \type{integer} indicating the number of
\glspl{object} within the
\gls{group}. There should then follow \meta{n} lots of
\meta{object data}, where \meta{object data} is the data for each
\gls{object} within the group, and is
as \hyperref[jdr:object]{described above}.

\item\label{jdr:path} Path data, \code{P}, has the
\meta{object-specs} stored as follows:
\begin{syntaxline}
\begin{jdrversion}{1.0--1.2}
\meta{line paint} \meta{fill paint} \meta{line style}
\code{O}\textbar\code{C}
\meta{n} \meta{segment data}+
\end{jdrversion}
\begin{jdrversion}{1.3--1.5}
\meta{line paint} \meta{fill paint} \meta{line style} \meta{path specs}
\end{jdrversion}
\begin{jdrversion}{1.6}
\meta{path style} \meta{path specs}
\end{jdrversion}
\begin{jdrversion}{1.7 onwards}
\meta{path style} \meta{path specs}\meta{anchor info}
\end{jdrversion}
\end{syntaxline}
where \meta{line paint} and \meta{fill paint} are \type{paint}
specifications and \meta{line style}
is the line style data (\hyperref[jdr:linestyle]{see below}).

The \meta{path specs} are
\begin{syntaxline}
\code{O}\textbar\code{C} \meta{n} \meta{start point} \meta{segment data}+
\end{syntaxline}
where the \type{char} value \code{O} or \code{C} indicates whether the path is
open (\code{O}) or closed (\code{C}), \meta{n} is an \type{integer}
indicating the number of segments that constitute the path. This
should be followed by \meta{n} lots of \meta{segment data}
(\hyperref[jdr:segment]{described below}).

Version 1.3 removed the redundancy present in earlier versions
but requires that the starting point \meta{start point}
follows the number of segments (\meta{n}). The starting point
is stored as two \type{double} numbers. For versions below 1.8,
these values are always in terms of the PostScript point \gls{bp}.
As from version 1.8, they are in terms of the storage unit, as
\hyperref[jdr:storageunit]{described above}.

Version 1.7 added anchor information (\meta{anchor info}). This comes
after the above path specifications. Control points are
indexed from 0 and include curvature control points. For example, a
path that consists of a line segment followed by a \gls{Bezier-curve} segment
has 5 control points: index 0 is the point at the start of the path
(the start of the line segment), index 1 is the point at the join
between the line segment and \gls{Bezier-curve} segment, indices 2 and 3 are
the two curvature control points and index 4 is the end point. The
anchor information is the list of \type{integer} indices for which the anchor is
\emph{on}. This list must be in ascending order of index and is
terminated by $-1$. Only control points occurring between a
continuous join may be anchored.

For example, in the ASCII \gls{AJR} version
\begin{verbatim}
3 6 9 -1
\end{verbatim}
indicates that control points 3, 6 and 9 have the anchor setting on.
If no controls are anchored, the $-1$ is still required.

  \begin{enumerate}
  \item\label{jdr:pathstyle} Version 1.6 onwards stores the \meta{path style}
  specification as
  \begin{syntaxline}
  \meta{id} \meta{specs}
  \end{syntaxline}
  where \meta{id} is a \type{byte}
  indicating the path style. This may be 0 (basic stroke) or 1
  (\gls{textpath} stroke).

    \begin{enumerate}
    \item The basic stroke \meta{specs} are:
    \begin{syntaxline}
    \meta{line paint} \meta{fill paint} \meta{line style}
    \end{syntaxline}
    where \meta{line style} is described \hyperref[jdr:linestyle]{below}.

    \item The \gls*{textpath} stroke \meta{specs} are:
    \begin{syntaxline}
    \meta{line paint} \meta{text-path style}
    \end{syntaxline}
    where \meta{text-path style} is described
    \hyperref[jdr:textpathstroke]{below}.

    A path should only have a \gls*{textpath} stroke if it is the
    base path for a \hyperref[jdr:composite]{composite shape}.
    \end{enumerate}

  \item\label{jdr:linestyle}
  The \meta{line style} data has changed from file version 1.0 to 1.1 to
  take into account the inclusion of mid point markers,
  and is stored as follows:
  \begin{syntaxline}
  \begin{jdrversion}{1.0}
  \meta{linewidth} \meta{dash} \meta{cap} \meta{join} [\meta{mitre-limit}] \meta{winding} \meta{start arrow} \meta{end arrow}
  \end{jdrversion}
  \begin{jdrversion}{1.1 and above}
  \meta{linewidth} \meta{dash} \meta{cap} \meta{join} [\meta{mitre-limit}] \meta{winding} \meta{start arrow} \meta{mid marker} \meta{end arrow}
  \end{jdrversion}
  \end{syntaxline}
  where:
    \begin{enumerate}
    \item \meta{linewidth} the line width stored as a \type{float}
    (below version 1.8) in PostScript points (\gls*{bp}). For version
    1.8 onwards, the line width is stored as a \type{length}.

    \item \meta{dash} is the dash pattern. This is stored as
    a \type{float-array}, optionally followed by the \type{float} offset.
    The array may be empty or null to indicate a solid line, otherwise
    it should have an even number of elements representing
    \meta{dash} \meta{gap} pairs. The offset is only saved for a
    non-empty, non-null array.

    The unit of measurement (not saved in
    the dash pattern specs) is \gls{bp} for versions below 1.8 and the
    \hyperref[jdr:storageunit]{storage unit} for version 1.8 onwards.

    \item \meta{cap} is the \pathattr{cap-style}, stored as a \type{byte}. It may
    only have one of the following values: 0
    (\pathattr{cap-style.butt}), 1 (\pathattr{cap-style.round}) or 2
    (\pathattr{cap-style.square}).

    \item \meta{join} is the \pathattr{join-style}, stored as a \type{byte}.
    It may only have one of the following values: 0
    (\pathattr{join-style.mitre}), 1 (\pathattr{join-style.round})
    or 2 (\pathattr{join-style.bevel}).

    \item \meta{mitre-limit} is the \pathattr{join-style.mitre-limit}
    and should only be stored if the join style is a
    \pathattr{join-style.mitre}. For versions below 1.8, 
    the \pathattr{join-style.mitre-limit} is stored as a \type{float}, otherwise
    it's stored as a \type{length}.

    \item \meta{winding} is the winding rule, stored as a \type{byte}.
    It may only have one of the following values: 0 (Even-Odd) or
    1 (Non Zero).

    \item \meta{start arrow} and \meta{end arrow} are the starting and
    ending marker styles. The \meta{mid marker} is the style for the
    mid-point markers.  Each marker type (start/mid/end) has the same
    format, but the file format varies as follows:
    \begin{jdrversion}{1.0}
    \begin{syntaxline}
    \meta{id} [\meta{size} \meta{is double} \meta{is reversed}]
    \end{syntaxline}
    where \meta{id} is a \type{byte} identifying the arrow type. This may
    be one of: 0 (none), 1 (pointed), 2 (triangle), 3 (circle),
    4 (diamond), 5 (square), 6 (bar) or 7 (single). \meta{size} is
    \type{float} representing the arrow size.
    (Some arrows only have a fixed size, but a size must still be
    present.) \meta{is double} is a \type{boolean} value indicating whether the
    arrow head is a double arrow (\meta{true}) or a single arrow
    (\meta{false}). \meta{is reversed} is a \type{boolean} value indicating
    whether the arrow head has been reversed. The values
    \meta{size}\meta{is double}\meta{is reversed} are omitted if
    \meta{id} equals 0 (no arrow head).
    \end{jdrversion}
    \begin{jdrversion}{1.1--1.3}
    \begin{syntaxline}
    \meta{id} [\meta{marker data}]
    \end{syntaxline}
    \end{jdrversion}
    where \meta{id} is a \type{byte} identifying the marker type.
    If \meta{id} is 0, then \meta{marker data} should be omitted,
    otherwise it should be present. Valid \meta{id} values are listed
    in \tableref{tab:jdrarrowid}.

    The \meta{marker data} is stored as follows:
    \begin{syntaxline}
    \meta{size} \meta{repeat} \meta{is reversed} \meta{orient data}
\meta{\manmsg{colour} data} \meta{overlay} \meta{composite data}
    \end{syntaxline}
    where:
      \begin{itemize}
      \item \meta{size} is a \type{float} representing the marker size
      (some markers will ignore this attribute, but it must still be
      present in the file.)

      \item \meta{repeat} is a \type{byte} identifying the repeat factor
      (a value of 1 indicates a single marker, a value of 2 indicates
      a double marker, a value of 3 indicates a triple marker.)

      \item \meta{is reversed} is a \type{boolean} value indicating whether
      or not the marker has been reversed.

      \item \meta{orient data} is the marker orientation data. This has
      the form \meta{auto-orient} [\meta{angle}] where \meta{auto-orient}
      is a \type{boolean} value indicating whether the marker should be
      oriented along the path. If \meta{auto-orient} is true, \meta{angle}
      should be omitted, otherwise \meta{angle} should be a \type{float}
      representing the orientation angle (in Radians).

      \item \meta{\manmsg{colour} data} is the marker \type{paint} where
      a transparent value indicates the \manmsg{colour} should be derived from
      the path to which the marker is attached, and there is no provision
      for gradient paint markers.

      \item \meta{overlay} is a \type{boolean} value indicating whether
      to overlay composite markers.

      \item \meta{composite data} is the data for composite markers.
      This has the same format as the \meta{marker data}. If the
      \meta{composite data} has a marker id of 0, then the marker
      is not a composite marker. Although the format allows for nested
      composite markers, \FlowframTk's marker settings dialog boxes do not
      allow for it.
      \end{itemize}

\FloatTable{tab:jdrarrowid}
{%
    \begin{tabular}{llll}
    0 & No marker &
    11 & Box Filled\\
    1 & Pointed &
    12 & Box Open\\
    2 & Triangle &
    13 & Cross \\
    3 & Circle &
    14 & Plus\\
    4 & Diamond &
    15 & Star\\
    5 & Square bracket &
    16 & Triangle Up Filled\\
    6 & Bar &
  17 & Triangle Up Open\\
  7 & Single &
  18 & Triangle Down Filled\\
  8 & Round bracket &
  19 & Triangle Down Open\\
  9 & Dot Filled &
  20 & Rhombus Filled \\
  10 & Dot Open &
  21 & Rhombus Open
  \end{tabular}
}
{Marker IDs (Version 1.0 Onwards)}

\FloatTable{tab:jdrarrowid1.4}
{%
  \begin{tabular}{llllll}
  22 & Pentagon Filled & 41 & Half Cusp Down & 60 & Open Semicircle\\
  23 & Pentagon Open & 42 & Alt Single & 61 & Filled Semicircle \\
  24 & Hexagon Filled & 43 & Alt Single Open & 62 & Open 5 Pointed star\\
  25 & Hexagon Open & 44 & Triangle Open & 63 & Filled 5 Pointed star\\
  26 & Octagon Filled & 45 & Circle Open & 64 & Asterisk\\
  27 & Octagon Open & 46 & Diamond Open & 65 & Scissors Down Filled\\
  28 & Pointed 60 & 47 & Brace & 66 & Scissors Up Filled\\
  29 & Pointed 45 & 48 & Rectangle Cap & 67 & Scissors Down Open\\
  30 & Hooks & 49 & Chevron Cap & 68 & Scissors Up Open\\
  31 & Hook up & 50 & Fast Cap & 69 & Heart Right Filled\\
  32 & Hook Down & 51 & Round Cap & 70 & Heart Right Open\\
  33 & Half Pointed Up & 52 & Triangle Cap & 71 & Heart Filled\\
  34 & Half Pointed Down & 53 & Inverted Triangle Cap & 72 & Heart Open\\
  35 & Half Pointed 60 Up & 54 & Inverted Chevron Cap & 73 & Snowflake\\
  36 & Half Pointed 60 Down & 55 & Inverted Fast Cap & 74 & Star Chevron Open\\
  37 & Half Pointed 45 Up & 56 & Alt Bar & 75 & Star Chevron Filled\\
  38 & Half Pointed 45 Down & 57 & Alt Round & 76 & Star 6 Filled\\
  39 & Cusp & 58 & Alt Square & 77 & Star 6 Open\\
  40 & Half Cusp Up & 59 & Alt Brace & 78 & Equilateral Filled\\
   & & & & 79 & Equilateral Open
  \end{tabular}
}
{Additional Marker IDs (Version 1.4 Onwards)}

\FloatTable{tab:jdrarrowid1.6}
{%
  \begin{tabular}{llll}
  80 & Ball Cap & 85 & Forward Triple Leaf Cap \\
  81 & Leaf Cap & 86 & Back Triple Leaf Cap \\
  82 & Double Leaf Cap & 87 & Forward Double Leaf Cap \\
  83 & Triple Leaf Cap & 88 & Back Double Leaf Cap \\
  84 & Club Cap & 89 & Cutout Bulge Cap
  \end{tabular}
}
{Additional Marker IDs (Version 1.6 Onwards)}


  For version 1.4 onwards the markers are stored as
  \begin{syntaxline}
  \meta{id}[\meta{marker data}]
  \end{syntaxline}
  where \meta{id} is a \type{byte} identifying the marker type.
  If \meta{id} is 0, then \meta{marker data} should be omitted,
  otherwise it should be present. Valid \meta{id} values are listed
  in \tableref{tab:jdrarrowid} and \tableref{tab:jdrarrowid1.4}.
  Additional markers listed in \tableref{tab:jdrarrowid1.6} are also
  available for version 1.6 onwards.

  The \meta{marker data} is stored as follows:
  \begin{syntaxline}
  \meta{size} \meta{repeat} \meta{is reversed} \meta{orient data}
  \meta{\manmsg{colour} data} \meta{overlay}
  [\meta{user offset flag} [\meta{user offset}]
  \meta{repeat offset flag} [\meta{repeat offset}]]
  \meta{composite data}
  \end{syntaxline}
  where:
  \meta{user offset flag} [\meta{user offset}]
  \meta{repeat offset flag} [\meta{repeat offset}]
  are only specified if the \meta{overlay} is false.
  Additionally,
  \meta{user offset} and \meta{repeat offset} are only
  specified if \meta{user offset flag} or \meta{repeat offset flag}
  are true, respectively.

    \begin{itemize}
    \item \meta{size} is a \type{float} (\gls*{bp} unit implied) for
    versions below 1.8 and is a \type{length} for version 1.8 onwards.

    \item \meta{repeat} is a \type{byte} identifying the repeat factor
    (a value of 1 indicates a single marker, a value of 2 indicates
    a double marker, a value of 3 indicates a triple marker.)

    \item \meta{is reversed} is a \type{boolean} value indicating whether
    or not the marker has been reversed.

    \item \meta{orient data} is the marker orientation data. This is as
    for versions 1.1--1.3 except that for version 1.8 onwards the
    orientation \meta{angle} (if required) is stored as an \type{angle}.

    \item \meta{\manmsg{colour} data} is the marker \type{paint} is as for
    versions 1.1--1.3.

    \item \meta{overlay} is a \type{boolean} value indicating whether
    to overlay composite markers.

    If the \meta{overlay} is false:
      \begin{itemize}
      \item \meta{user offset flag} is a \type{boolean} value indicating
      whether the marker offset is specified by the user (true) or
      determined automatically (false).

      \item \meta{user offset} indicates the marker
      offset from the vertex. For versions below 1.8 this is stored as a
      \type{float} (\gls*{bp} unit implied) otherwise it's stored as a \type{length}. This is only
      present if \meta{user offset flag} is true.

      \item \meta{repeat offset flag} is a \type{boolean} indicating whether the
      repeat offset (i.e. gap between repeat markers) is specified by
      the user (true) or determined automatically (false).

      \item \meta{repeat offset} indicates the
      gap between repeat markers. For versions below 1.8 this is stored as a
      \type{float} (\gls*{bp} unit implied) otherwise it's stored as a
      \type{length}. This is only
      present if \meta{repeat offset flag} is true.
      \end{itemize}

    \item \meta{composite data} is the data for composite markers.
    This has the same format as the \meta{marker data}. If the
    \meta{composite data} has a marker id of 0, then the marker
    is not a composite marker. Although the format allows for nested
    composite markers, \FlowframTk's marker settings dialog boxes do not
    allow for it.
    \end{itemize}
  \end{enumerate}% end of line style

  \item\label{jdr:segment} Each path segment \meta{segment data} is stored as:
  \begin{syntaxline}
  \meta{id} \meta{specs}
  \end{syntaxline}
  where \meta{id} is a \type{char} representing the segment type.
  Valid identifiers are listed in \tableref{tab:jdrsegments}. 
  For versions below 1.8, the co-ordinates are
  always \gls{bp}. As from version 1.8, the co-ordinate unit is as
  specified by the storage unit \hyperref[jdr:storageunit]{described
  above}.

\FloatTable{tab:jdrsegments}
{%
  \begin{tabular}{ll}
  \bfseries Identifier & \bfseries Description\\
  \code{M} & \gls+{move-to}\\
  \code{L} & line\\
  \code{B} & cubic \gls+{Bezier-curve}\\
  \code{Z} & \gls+{closing-move} (2.1 onwards)
  \end{tabular}
}
{Path Segment Identifiers}

    \begin{enumerate}
    \item\label{jdr:bezier} \gls{Bezier-curve} segments are stored as follows:
    \begin{jdrversion}{1.0--1.2}
    \meta{c0x} \meta{c0y} \meta{c1x} \meta{c1y} \meta{c2x} \meta{c2y}
    \meta{c3x} \meta{c3y}
    \end{jdrversion}
    \begin{jdrversion}{1.3 onwards}
    \meta{c1x} \meta{c1y} \meta{c2x} \meta{c2y} \meta{c3x} \meta{c3y}
    \end{jdrversion} 
    where \meta{c0x} and \meta{c0y} are the $x$ and $y$ 
    co-ordinates of the starting point, \meta{c1x} and \meta{c1y} are the
    $x$ and $y$ co-ordinates of the first curvature control
    point, \meta{c2x} and \meta{c2y} are the $x$ and
    $y$ co-ordinates of the second curvature control point, and
    \meta{c3x} and \meta{c3y} are the $x$ and $y$ co-ordinates
    of the end point.  Each value is stored as a \type{double}. The unit of
    measurement is \gls{bp} for versions below 1.8, otherwise it's the storage
    unit as \hyperref[jdr:storageunit]{described above}.
    
    \item\label{jdr:line}
    Line and move to (gap) segments are stored as follows:
    \begin{jdrversion}{1.0--1.2}
    \meta{x0} \meta{y0} \meta{x1} \meta{y1}
    \end{jdrversion}
    \begin{jdrversion}{1.3 onwards}
    \meta{x1} \meta{y1}
    \end{jdrversion}
    where \meta{x0} and \meta{y0} are the $x$ and
    $y$ co-ordinates of the starting point and
    \meta{x1} and \meta{y1} are the $x$ and
    $y$ co-ordinates of the end point. Each value is stored as
    a \type{double}. The unit of
    measurement is \gls{bp} for versions below 1.8, otherwise it's the
    storage unit as \hyperref[jdr:storageunit]{described above}.

    \item\label{jdr:closingmove}
    The \gls+{closing-move} segment combines two actions in one. It closes
    the sub path immediately before it and moves to the start of the
    next sub-path. This is different from the closing path boolean
    that determines whether or not to join the path start and end
    points.
    \begin{jdrversion}{2.1 onwards}
    \meta{x1} \meta{y1}
    \end{jdrversion}
    The \meta{x1} and \meta{y1} are as for the line and move
    segments.
    \end{enumerate}% end of segment info

  \end{enumerate}% end of path info

\item\label{jdr:textarea}%
\Gls{textarea} (\code{T}) data is stored as follows:
\begin{jdrversion}{1.0--1.7}
\begin{syntaxline}
\meta{font-specs} \meta{transform}
\meta{latex-flag} [\meta{latex-specs}] \meta{text paint} \meta{text}
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.8 onwards}
\meta{outline-flag} [\meta{fill paint}]
\meta{font-specs} \meta{transform}
\meta{latex-flag} [\meta{latex-specs}] \meta{text paint} \meta{text}
\end{jdrversion}

  \begin{enumerate}
  \item\label{jdr:outline} \meta{outline-flag} is a \type{boolean}
  value that indicates whether or not the text should be rendered as
  an \textattr{outline}. If true, \meta{fill paint} follows, which is the
  \type{paint} used to fill the interior. A transparent \type{paint}
  indicates the interior shouldn't be filled.

  \item\label{jdr:fontspecs} \meta{font-specs} has the syntax:
  \begin{syntaxline}
  \meta{family} \meta{shape} \meta{weight} \meta{size}
  \end{syntaxline}
  The \meta{family} must be a non-empty, non-null \type{string}
  indicating the name of the font (as used by \FlowframTk, not
  when exported to a \LaTeX\ file, so it's a system font rather than a
  \TeX\ font).

  The \meta{shape} is a \type{byte} indicating the font shape (0 for
  upright, 1 for emphasized, 2 for italic, 3 for slanted and 4 for
  smallcaps).  Version 1.6 and below only permitted 0 or 1 for the shape.
  Although the file format allows five different shape styles,
  \code{java.awt.Font} only supports plain or italic, so when
  rendering on the \gls{canvas}, \FlowframTk\ treats emphasized,
  italic and slanted as \code{Font.ITALIC} and the other styles as
  \code{Font.PLAIN}. The \widget{font.shape.italic} option
  in the font style dialogs actually sets the shape to type~1 (emphasized) rather
  than type~2.

  The \meta{weight} is a \type{byte} indicating the font weight (0 for medium,
  1 for bold).

  For versions below 1.8 the font size is a non-negative
  \type{integer}, otherwise it's stored as a non-negative
  \type{length}.

  \item \meta{transform} is a \type{transform-matrix} indicating the
  text transformation relative to the top left corner of the
  \gls{canvas}.

  \item\label{jdr:latexspecs} The \meta{latex-flag} is a \type{boolean} value that indicates
  whether the \LaTeX-related attributes (\meta{latex specs}) are saved.
  If true, the syntax for \meta{latex specs} is
  \begin{jdrversion}{below 1.8}
  \begin{syntaxline}
  \meta{latex font specs} \meta{h-align} \meta{v-align} \meta{latex text}
  \end{syntaxline}
  \end{jdrversion}
  \begin{jdrversion}{1.8 onwards}
  \begin{syntaxline}
  \meta{latex font specs} \meta{h-align} \meta{v-align} \meta{latex text}
  \meta{left delim} \meta{right delim}
  \end{syntaxline}
  \end{jdrversion}
  The \meta{latex font specs} are the \LaTeX\ font declarations: \meta{family},
  \meta{weight}, \meta{shape} and \meta{size}. Each attribute is
  stored as a \type{string}.

  The \meta{h-align} element represents the horizontal alignment and
  is stored as a \type{byte} that may be one of: 0 (left), 1
  (\manmsg{centre}) or 2 (right).

  The \meta{v-align} element represents the vertical alignment and
  is stored as a \type{byte} that may be one of: 0 (top), 1
  (middle), 2 (baseline) or 3 (bottom).

  The \LaTeX\ alternative text \meta{latex text} is a \type{string}.
  If empty or null, the \LaTeX\ alternative text should be considered equivalent
  to \meta{text}.
  \end{enumerate}% end of text info

\item\label{jdr:bitmap} Bitmap (\texttt{I}) information is stored as follows:
\begin{syntaxline}
\meta{filename} \meta{latex-flag} [\meta{latex-bitmap-specs}]
\meta{transformation}
\end{syntaxline}
where:
  \begin{enumerate}
  \item \meta{filename} is a non-empty, non-null \type{string}
  containing the file name. This may be a path relative to the
  \gls{JDR}\slash\gls{AJR} file for version 1.8 onwards.

  \item If the \type{boolean} value \meta{latex-flag} is true, it must
  be followed by \meta{latex-bitmap-specs}

  \item\label{jdr:latexbitmap}
  \meta{latex-bitmaps-specs} has the following format:
  \begin{syntaxline}
  \meta{lfilename}\meta{imgcmd}
  \end{syntaxline}
  where \meta{lfilename} is a \type{string} containing the \LaTeX\
  pathname for the bitmap. A null or empty value indicates it should
  be determined from \meta{filename} (replacing the pathname
  separator with a \gls{forwardslash} if necessary). The image command is stored
  in the \type{string} \meta{imgcmd} and may be empty or null.

  \item \meta{transformation} is a \type{transform-matrix}. The origin
  is the bottom left corner of the \gls{bitmap}.
  \end{enumerate}% end of bitmap info

\item \label{jdr:composite}Composite Shapes

As from version 1.6, all \glspl{compositeshape} except
for \glspl{symmetricshape} (that is, 
\hyperref[jdr:textpath]{\code{X}},
\hyperref[jdr:rotational]{\code{R}},
\hyperref[jdr:scaled]{\code{C}} and 
\hyperref[jdr:spiral]{\code{L}}) have \meta{object-specs} in
the form:
\begin{syntaxline}
\meta{modifier specs} \meta{underlying shape specs}
\end{syntaxline}
For \glspl{symmetricshape} (\hyperref[jdr:symmetric]{\code{S}}) the syntax is:
\begin{syntaxline}
\meta{underlying shape specs} \meta{modifier specs}
\end{syntaxline}

The \meta{underlying shape specs} is the specification for the
underlying shape in the form:
\begin{syntaxline}
\meta{id-char} \meta{object-specs}
\end{syntaxline}
where \meta{id-char} is the object type identifier (see
\tableref{tab:jdrobjecttypes}), but the type is limited to shapes, so the 
\gls*{textarea} (\hyperref[jdr:textarea]{\code{T}}), 
\gls*{bitmap} (\hyperref[jdr:bitmap]{\code{B}}) and
\gls*{group} (\hyperref[jdr:group]{\code{G}}) IDs aren't permitted here.

The \gls{underlying-shape} may be another \gls{compositeshape}.
\emph{\Inlineglspluraldef{underlying-shape.descendent}} 
refers to the \gls{compositeshape}['s]
\gls{underlying-shape} and any descendent of that underlying shape if it
is also a \gls*{compositeshape}. The
\emph{\inlineglstextdef{underlying-shape.base}} is the
maximal \gls{underlying-shape.descendent} and must be a 
\gls*{path} (\hyperref[jdr:path]{\code{P}}),
in which case \meta{id-char} \meta{object-specs} will be
\code{P} \meta{path style} \meta{path specs} \meta{anchor info}
(\meta{anchor info} is omitted below version 1.7).

Although the \glspl{underlying-shape.descendent} may be another
\gls*{compositeshape}, they can't share the same type as either
their \gls{underlying-shape-ancestor} or
\glsfirstplural{underlying-shape.descendent}. For example, a
\gls{textpath} may have a \gls{pattern} as its \gls{underlying-shape}, but
a pattern can't have another pattern as its \gls{underlying-shape}.

The \meta{modifier specs} are as follows:

  \begin{enumerate}% start of composite shapes
  \item\label{jdr:textpath}%
  \Glspl{textpath} (\code{X}) are not available for versions below 1.5.

  For this type of \gls{compositeshape}, the \meta{modifier specs} are only
  present from version 1.8 and relate to the outline option
  \meta{outline-flag} [\meta{fill paint}], which is
  the same as for \glspl*{textarea} (\hyperref[jdr:textarea]{\code{T}}). So the
  \meta{object-specs} are:
  \begin{jdrversion}{1.8 onwards}
  \begin{syntaxline}
  \meta{outline-flag} [\meta{fill paint}] \meta{underlying shape specs}
  \end{syntaxline}
  \end{jdrversion}
  \begin{jdrversion}{1.6--1.7}
  \begin{syntaxline}
  \meta{underlying shape specs}
  \end{syntaxline}
  \end{jdrversion}

  For version 1.5 the \meta{object-specs} are:
  \begin{jdrversion}{1.5}
  \begin{syntaxline}
  \meta{text paint} \meta{line style} \meta{path specs}
  \end{syntaxline}
  For version 1.5, the \meta{line style} and \meta{path specs} are as described
  for paths (\hyperref[jdr:path]{\code{P}}). The base path must have the
  text-path stroke (id 1) \hyperref[jdr:pathstyle]{\meta{path style}}.
  \end{jdrversion}

    \begin{enumerate}% text-path info

    \item\label{jdr:textpathstroke} The \meta{text-path style} is
    stored as:
    \begin{syntaxline}
    \meta{font specs} \meta{transform} \meta{latex-flag}
    [\meta{latex specs}] \meta{text}
    \end{syntaxline}
    where:
      \begin{enumerate}
      \item \meta{font specs} are the same as for
      \hyperref[jdr:textarea]{text areas}.

      \item \meta{transform} is a \type{transform-matrix} indicating the
      text transformation relative to the underlying shape (see
      \sectionref{sec:textpath}).

      \item The \meta{latex-flag} is a \type{boolean} value that indicates
      whether the \LaTeX-related attributes (\meta{latex specs}) are saved.
      If true, the syntax for \meta{latex specs} is
      \begin{jdrversion}{below 1.8}
      \begin{syntaxline}
      \meta{latex font specs} \meta{h-align} \meta{v-align} \meta{latex text}
      \end{syntaxline}
      \end{jdrversion}
      \begin{jdrversion}{1.8 onwards}
      \begin{syntaxline}
      \meta{latex font specs} \meta{h-align} \meta{v-align} \meta{latex text}
      \meta{left delim} \meta{right delim}
      \end{syntaxline}
      \end{jdrversion}
      This is the same as for \hyperref[jdr:textarea]{text areas} but
      additionally includes the delimiters used by the
      \sty{pgf} package's text decoration function for version 1.8
      onwards.
\begin{jdrversion}{1.8--2.0}
Both \meta{left delim} and \meta{right delim} are stored as a
\type{char}.
\end{jdrversion}
\begin{jdrversion}{2.1 onwards}
Both \meta{left delim} and \meta{right delim} are stored as a
\type{integer} that corresponds to the character's codepoint.
\end{jdrversion}
      \end{enumerate}% end of text-path font specs

    \item The \meta{text} is stored as a \type{string} and shouldn't be
    empty or null.
    \end{enumerate}% end of text-path info

  \item\label{jdr:symmetric}%
  \Glspl{symmetricshape} (\code{S}) are not available for versions
  below 1.6. For newer versions, the \meta{modifier specs} are:
  \begin{syntaxline}
  \meta{join anchored} [\meta{join segment}]
  \meta{symmetry x0} \meta{symmetry y0} \meta{symmetry x1} \meta{symmetry y1}
  \meta{closed} [\meta{close anchored} [\meta{closing segment}]]
  \end{syntaxline}
  where:
  \begin{enumerate}
  \item The \type{boolean} value \meta{join anchored} indicates
   whether or not the join between the original shape and its
   reflection is anchored.

  \item\label{jdr:joinsegment}%
  If the join isn't anchored, \meta{join segment} is the
  information about the joining segment. This is omitted if
  \meta{join anchored} is true. The syntax for the join segment is:
  \begin{syntaxline}
  \meta{segment-id} [\meta{segment specs}]
  \end{syntaxline}
  where the \meta{segment-id} is a \type{char} indicating the
  segment type. This may be one of \code{m} (gap), \code{l}
  (line) or \code{c} (\gls{Bezier-curve}).
    \begin{enumerate}
    \item The \meta{segment specs} for both the gap (\code{m}) and
    line (\code{l}) segments is omitted.

    \item The \meta{segment specs} for the \gls{Bezier-curve} is:
    \begin{syntaxline}
    \meta{cx} \meta{cy}
    \end{syntaxline}
    where \meta{cx} and \meta{cy} are the $x$ and
    $y$ \glspl{co-ordinate} of the curvature
    control, respectively, and are each stored as a \type{double}
    (in terms of the PostScript point \gls{bp} for versions below
    1.8 and in terms of the storage unit otherwise).

    \end{enumerate}

  \item The \glspl{co-ordinate} for the line of symmetry
  \meta{symmetry x0} \meta{symmetry y0} \meta{symmetry x1} and
  \meta{symmetry y1} are each stored as a \type{double} and are in
  terms of the PostScript point (\gls{bp}) for versions below 1.8
  otherwise are in terms of the storage unit.

  \item The \type{boolean} value \meta{closed} indicates if the
  shape is closed.

  \item If the shape is closed, the \meta{boolean} \meta{close anchor}
  indicates whether or not the starting control is anchored to the
  line of symmetry (true indicates the anchor setting is on).
  If the shape isn't closed, this value is omitted.

  \item If the \meta{close anchor} is false, the \meta{closing
  segment} is the information about the segment used to close the
  shape. This has the same syntax as for the
  \hyperref[jdr:joinsegment]{\meta{join segment}}. The \meta{closing segment}
  data is omitted if \meta{close anchor} is true.
  \end{enumerate}

  \item\label{jdr:rotational}%
  \Glspl{rotationalpattern} (\code{R}) are not available for versions below 1.6.
  For newer versions, the \meta{modifier specs} are:
  \begin{syntaxline}
  \meta{shape-specs} \meta{anchor-x} \meta{anchor-y} \meta{angle}
  \meta{replicas} \meta{mode} \meta{show}
  \end{syntaxline}
  where:
  \begin{enumerate}
  \item \meta{shape-specs} are the \hyperref[jdr:composite]{underlying-shape's
    specifications}.

  \item \meta{anchor-x} is a \type{double} representing the
    $x$ \gls{co-ordinate} of the anchor point (in terms of the PostScript point
    \gls*{bp} for versions below 1.8, otherwise in terms of the
    storage unit).

  \item \meta{anchor-y} is a \type{double} representing the
    $y$ \gls{co-ordinate} of the anchor point (in terms of the PostScript point
    \gls*{bp} for versions below 1.8, otherwise in terms of the
    storage unit).

  \item \meta{angle} is the angle of rotation and is stored as a
  \type{double} (in radians) for versions below 1.8, otherwise is
  stored as an \type{angle}.

  \item \meta{replicas} is an \type{integer} representing the number
    of replicas.

  \item \meta{mode} is a \type{boolean} variable, true if single-path mode.

  \item \meta{show} is a \type{boolean} variable, true if the underlying
    path is visible.
  \end{enumerate}% end of rotational pattern specs

  \item\label{jdr:scaled}%
  \Glspl{scaledpattern} (\code{C}) are not available for versions below 1.6.
  For newer versions, the specifications are:
  \begin{syntaxline}
  \meta{shape-specs} \meta{anchor-x} \meta{anchor-y} \meta{adjust-x}
  \meta{adjust-y} \meta{scale-x} \meta{scale-y} \meta{replicas} \meta{mode}
  \meta{show}
  \end{syntaxline}
  where \meta{shape-specs}, \meta{anchor-x}, \meta{anchor-y},
  \meta{replicas}, \meta{mode} and \meta{show} are as for the
  \hyperref[jdr:rotational]{rotational pattern}. Additionally:
    \begin{enumerate}
    \item \meta{adjust-x} is a \type{double} representing the
    $x$ \gls{co-ordinate} of the adjust control point (in terms of the
    PostScript point \gls{bp} for versions below 1.8, otherwise in terms
    of the storage unit).

    \item \meta{adjust-y} is a \type{double} representing the
    $y$ \gls{co-ordinate} of the adjust control point (in terms of the
    PostScript point \gls{bp} for versions below 1.8, otherwise in terms
    of the storage unit).

    \item \meta{scale-x} is a \type{double} representing the
     $x$-scale factor.

    \item \meta{scale-y} is a \type{double} representing the
     $y$-scale factor.
    \end{enumerate}% end of scaled pattern info

  \item\label{jdr:spiral}%
  \Glspl{spiralpattern} (\code{L}) are not available for versions below 1.6.
  For newer versions, the specifications are:
  \begin{syntaxline}
  \meta{shape-specs} \meta{anchor-x} \meta{anchor-y} \meta{adjust-x}
  \meta{adjust-y} \meta{angle} \meta{distance} \meta{replicas} \meta{mode}
  \meta{show}
  \end{syntaxline}
  where \meta{shape-specs}, \meta{anchor-x}, \meta{anchor-y},
  \meta{adjust-x}, \meta{adjust-y}, \meta{replicas}, \meta{mode} and
  \meta{show} are as for \hyperref[jdr:scaled]{scaled patterns}. Additionally:
    \begin{enumerate}
    \item \meta{angle} is the spiral angle
    parameter and is stored as a \type{double} (in radians) for
    versions below 1.8, otherwise is stored as an \type{angle}.

    \item \meta{distance} is a 64-bit double representing the spiral
      distance parameter.
    \end{enumerate}% end of spiral pattern info
  \end{enumerate}% end of composite shape info
\end{numbered}% end of object info

\plabel[Flowframe Data]{jdr:flowframe}\Gls{flowframe} data is stored as
follows:
\begin{jdrversion}{1.0--1.1}
\begin{syntaxline}
\meta{type} [\meta{border} \meta{label} \meta{pages}]
\meta{top} \meta{bottom} \meta{left} \meta{right}
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.2}
\begin{syntaxline}
\meta{type} [\meta{border} \meta{label} \meta{pages}]
\meta{top} \meta{bottom} \meta{left} \meta{right}
[\meta{shape}]
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.3--1.7}
\begin{syntaxline}
\meta{type} [\meta{border} \meta{label} \meta{pages}]
\meta{top} \meta{bottom} \meta{left} \meta{right}
[\meta{shape} \meta{v-align}]
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{1.8--2.0}
\begin{syntaxline}
\meta{type} [\meta{border} \meta{label} \meta{pages}]
\meta{top} \meta{bottom} \meta{left} \meta{right}
[\meta{shape} \meta{v-align} \meta{contents}] \meta{even-x-shift}
[\meta{even-y-shift}]
\end{syntaxline}
\end{jdrversion}
\begin{jdrversion}{2.1 onwards}
\begin{syntaxline}
\meta{type} [\meta{border} \meta{label} \meta{pages}]
\meta{top} \meta{bottom} \meta{left} \meta{right}
[\meta{shape} \meta{v-align} \meta{contents} \meta{clear-flag} [\meta{style}] ]
[\meta{flow-margin-pos}]
\meta{even-x-shift} [\meta{even-y-shift} \meta{text-rgb-flag} [\meta{text-rgb}]]
\end{syntaxline}
\end{jdrversion}
where:
\begin{numbered}
\item The frame \meta{type} is stored as a \type{byte}. This may only
take one of the following values: 0 (static), 1 (flow), 2 (dynamic)
and 3 (\gls+{typeblock}). There should only be one \gls{typeblock} and this
should belong to the \hyperref[jdr:object]{outermost implicit group}.

\item If \meta{type} is not equal to 3 (that is, it's not the \gls{typeblock}), the following
information should also be saved:
  \begin{enumerate}
  \item a \type{boolean} value (\meta{border})
  indicating whether or not the frame should have a border;
  \item the identification label (\meta{label}) stored as a
  \type{string};
  \item the page list (\meta{pages}) should be stored as a
  \type{string}.
  \end{enumerate}

\item The margins \meta{top} \meta{bottom} \meta{left} and
\meta{right} are each stored as a \type{float} (in terms of the
PostScript point \gls{bp}) for versions below 1.8 and are stored
as a \type{double} (in terms of the storage unit) otherwise.

\item (Version 1.2 onwards.) If the frame type
is either 0 (static frame) or 2 (dynamic frame) \meta{shape}
is a \type{byte} indicating the paragraph shape. This may be one of:
0 (standard shape), 1 (use \gls{parshape}) or 2 (use \gls{shapepar}).
This value should be omitted for other frame types.

\item (Version 1.3 onwards.) If the frame type is
either 0 (static frame) or 2 (dynamic frame) \meta{v-align} is a
\type{byte} that represents the vertical alignment. This may be one
of: 0 (top), 1 (\manmsg{centre}) or 2 (bottom).
This value should be omitted for other frame types.

\item (Version 1.8 onwards.)  If the frame type is
either 0 (static frame) or 2 (dynamic frame) \meta{contents} is a
\type{string} with the frame's contents. This may be an empty or
null \type{string}.
This value should be omitted for other frame types.

\item (Version 2.1 onwards.) The \meta{clear-flag} is a
\type{boolean} that's only present for static or dynamic frames.
This value should be omitted for other frame types.

\item (Version 2.1 onwards.) The \meta{style} is a
\type{string} that's only present for dynamic frames. (The string
may be empty or consist of \LaTeX\ font
changing commands where the last may be a text-block command.)
This value should be omitted for other frame types.

\item (Version 2.1 onwards.) The \meta{flow-margin-pos} is a \type{byte}
that may be one of the values: 0 (outer), 1 (inner), 2 (left) or 3
(right). This indicates the position of the marginpar and is only
present for type 1 (flow frame).
This value should be omitted for other frame types.

\item (Version 1.8 onwards.) The horizontal even page shift
\meta{even-x-shift} is stored as a \type{double}.

\item (Version 1.8 onwards.) The vertical even page shift
\meta{even-y-shift} is stored as a \type{double}. This value is
omitted for the \gls{typeblock} (type~3).

\item (Version 2.1 onwards.) The \meta{text-rgb-flag} is a
\type{boolean} indicating whether or not the \meta{text-rgb} data is
present. If the flag is false, the text \manmsg{colour} is the default
for the document. If the flag is true, the \meta{text-rgb} data must
follow, which is an integer representation of an RGB
\manmsg{colour} specification.  (Bits 24--31 are alpha, 16--23 are red,
8--15 are green, 0--7 are blue.) Note that although this includes
the alpha channel, this isn't supported as a pen \manmsg{colour} in
\LaTeX, so the alpha component will be omitted when exported to a class, package or
\LaTeX\ document.

\end{numbered}% end of flowframe info

\chapter{Help Windows}
\label{sec:helpwindows}

\menudef{menu.help.about}

The \menu{help.about} menu item shows the \inlineglsdef{about.title}
dialog with version details.

\menudef{menu.help.license}

The \menu{help.license} menu item shows the \inlineglsdef{license.title}
dialog (see \sectionref{sec:licence}).

\input{helpinterface}

\chapter{Multilingual Support}\label{sec:multilingualsupport}

All the language dependent information is stored in the
\filefmt{lib/resources} subdirectory of the installation directory.
If you want all the menus, tooltips
etc in another language, you will need to translate the
dictionary file (found in \filefmt{lib/resources/dictionaries/}). 
These are in XML format. Only the element content (not the key)
should be changed. Parameters are denoted \code{\marg{0}},
\code{\marg{1}}, etc. Any literal brace needs to be delimited with
a straight single quote. A literal straight single quote should be
doubled.

The \code{key} attribute of each \code{entry} element has a specific
format. The prefix indicates the entry type. For example,
\qtt{menu.} indicates a menu or menu item, \qtt{index.} indicates an
index entry for the manual, and \qtt{manual.} indicates a
non-indexed entry for the manual.  The suffix may also be
significant. For example, \qtt{.title} indicates a dialog or panel
title, and \qtt{.text}, \qtt{.plural}, \qtt{.description},
\qtt{.symbol}, \qtt{.initvalue}, \qtt{.mnemonic}, \qtt{.keystroke},
\qtt{.tooltip}, and \qtt{.iconimage} all correspond to glossary
entry fields. In the case of \qtt{.mnemonic}, \qtt{.keystroke} and
\qtt{.tooltip}, they are also used by \FlowframTk\ for the widget's
mnemonic, accelerator and tooltip text.  The tag in between the
prefix and suffix has the indexing hierarchy denoted with a dot.

There are three keys (\code{about.translator},
\code{about.translator\_info} and \code{about.translator\_url})
which can be used to identify yourself as the translator. If
the \code{about.translator} value is set, the information will be
displayed in the \menu{help.about} dialog box.

The dictionary file should be named
\metafilefmt{flowframtk-}{locale}{.xml}
where \meta{locale} is the locale identifier.
\FlowframTk\ will search for a match on the language first
and load that if found, but will also search for a closer match to
the default locale and load that, if found. For example,
if the default locale is \qt{en-US}, then first
\filefmt{flowframtk-en.xml} will be loaded. As there isn't a file
for \qt{en-US} no further file is loaded.
However, if the default locale is \qt{en-GB}, then first
\filefmt{flowframtk-en.xml} will be loaded, but after that
\filefmt{flowframtk-en-GB.xml} will be loaded and any entries in
that will override an existing entry with the same key.
If there's no match on \meta{locale}, then 
\filefmt{flowframtk-en.xml} will be used.

Elements that are common to both \FlowframTk\ and JDRView 
are in \metafilefmt{jdrcommon-}{locale}{.xml}. This is loaded before
\metafilefmt{flowframtk-}{locale}{.xml}.

The easiest way to create the XML file is to copy an existing
resource file, for example \filefmt{flowframtk-en.xml}, and replace
all the content of the \code{entry} elements. Ensure that the file
is UTF-8. If you want to add your translations to \FlowframTk, you
can do so via a pull request in the \FlowframTk\ repository on
GitHub (\url{https://github.com/nlct/flowframtk}).

The \FlowframTk\ source code uses the \TeX\ Java Help Library
command line tools to convert the \LaTeX\ documentation source code
(\sectionref{sec:docsource}) into the \gls+{html} and XML files required by
the in-application help system (\sectionref{sec:helpwindows}). The
\TeX\ Java Help Library is also used by \FlowframTk\ to provide the
windows used by the in-application help system. All
language-sensitive text needed by the in-application help are
in the file \metafilefmt{texjavahelplib-}{locale}{.xml} which has
the same scheme as \metafilefmt{flowframtk-}{locale}{.xml}.
The \TeX\ Java Help Library dictionary files are always loaded first
so any entries with duplicate tags in \metafilefmt{flowframtk-}{locale}{.xml}
will override the ones in  \metafilefmt{flowframtk-}{locale}{.xml}.
If you want to add translations for the \TeX\ Java Help Library,
you can do so via a pull request in the \TeX\ Java Help Library
repository (\url{https://github.com/nlct/texjavahelp}).

\seealsorefs{
  sec:languages,
  sec:docsource
}

\chapter{Source Code}\label{sec:sourcecode}

The source code is available in the \FlowframTk\ GitHub repository
(\url{https://github.com/nlct/flowframtk}).
The creation of the HTML and XML helpset files is integral to the 
build process.
Requirements:
\begin{itemize}
\item The \TeX\ Java Help Library (\filefmt{texjavahelplib.jar})
available from \url{https://github.com/nlct/texjavahelp}.
This should be placed in the \filefmt{lib} sub-directory.
It needs to be on the Java class path as it's used by both the
localisation support and the in-application help (\sectionref{sec:helpwindows}).
 
\item The Java Development Kit to compile the Java source code.

\item The \TeX\ Java Help command line tools.

\item A \TeX\ installation to build the documentation.
This installation should include \styfmt{glossaries},
\styfmt{glossaries-extra} and \appfmt{bib2gls}.
\end{itemize}

I've only compiled and tested the source under Linux using GNU Make.
I can't guarantee that it will work on other systems.

\begin{enumerate}
\item Compile the Java source code (\sectionref{sec:javasource}).

\item Use \appfmt{tjhxml2bib} (one of the \TeX\ Java Help command
line tools) to convert the applicable XML dictionary files to 
a \appfmt{bib2gls} file. This ensures that the manual uses the
correct text for the menus and widgets etc, and has the correct
hierarchical structure. For example, the sequence
\menu{help.manual} is created with
\verb|\menu{help.manual}|.

\item Compile the PDF from the documentation source
(\sectionref{sec:docsource}). Don't delete any of the temporary
files created in the document build process. They're needed in the
next step. Note that some of the labels (created with \csfmt{label}
in the document source) are referenced in the Java code when
creating context-sensitive help buttons, such as those in dialog
boxes. These labels should not be changed. (The labels are also used
to determine the HTML file basenames.)
The documentation requires the \styfmt{texjavahelp} package which is
part of the \TeX\ Java Help system.

\item Use \appfmt{texjavahelpmk} (another \TeX\ Java Help command
line tool) to convert the \LaTeX\ source to the HTML and XML files
that are required by the in-application help.
This uses the \TeX\ Parser Library to parse the source code and 
associated files to create the helpset files. These consist of an
HTML file for each sectional unit, an XML file for the document
structure (used in the navigation tree on the side of the help
window and obtained from the table of contents), 
an XML file containing all indexed terms (using
information in the files created by \appfmt{bib2gls}), and
an XML file containing the search data. This is created as
\appfmt{texjavahelpmk} writes the HTML content, which is done via a
buffer that detects paragraphs and word boundaries before writing
the content to the destination HTML file.

Note that since the \TeX\ Parser Library isn't a \TeX\ engine, it
only has limited support for classes and packages. The
\appfmt{texjavahelpmk} tool provides support for the commands and
environments defined in the \styfmt{texjavahelp} package but
the \code{JEditorPane} used by the help windows only has limited
HTML and CSS support so some effects can't be replicated in the
helpset files.

\end{enumerate}

\section{Java Source}\label{sec:javasource}

The source code is contained in subdirectories of
\filefmt{src/java}.

\begin{deflist}
\itemtitle{\filefmt{src/java/jdr/}}
\begin{itemdesc}
This contains the source code for \filefmt{jdr.jar}. This deals with
all the information that constitutes an image as well as methods to
save and load images. The import code for other file formats is
still experimental.
\end{itemdesc}

\itemtitle{\filefmt{src/java/jdrresources/}}
\begin{itemdesc}
This contains the source code for \filefmt{jdrresources.jar}. This
deals with common application resources used by both \FlowframTk\
and JDRView.
\end{itemdesc}

\itemtitle{\filefmt{src/java/flowframtk/}}
\begin{itemdesc}
This contains the source code for \filefmt{flowframtk.jar}. This
has the main file and deals with most of the \gls{gui} parts of 
\FlowframTk\ (that are not provided by \filefmt{jdrresources}).
\end{itemdesc}

\itemtitle{\filefmt{src/java/jdrview/}}
\begin{itemdesc}
This contains the source code for \filefmt{jdrview.jar}. This has
the main file and deals with the \gls{gui} parts of JDRView
(that are not provided by \filefmt{jdrresources}).
\end{itemdesc}

\itemtitle{\filefmt{src/java/jdrinfo/}}
\begin{itemdesc}
This contains the source code for \filefmt{jdrinfo.jar}. I wrote this
command line application to detect the file format version numbers for my sample 
\gls{JDR}/\gls{AJR} files.
\end{itemdesc}

\itemtitle{\filefmt{flowframtk/src/*2*}}
\begin{itemdesc}
These directories contain the source code for the command line
converters that together form jdrutils. I plan to combine them all
into a single application.
\end{itemdesc}

\end{deflist}

\section{Document Source}\label{sec:docsource}

The documentation source (in \filefmt{src/doc/}) is written in
\LaTeX\ but requires additional tools to create all the necessary
files. To reduce duplication, shared images are in
\filefmt{src/doc/sharedimages} (if they are independent of the
localisation settings) or
\metafilefmt{src/doc/}{lang}{-sharedimages} if they are shared by
multiple regional dialects with the same root language.
For example, \filefmt{en-sharedimages} has the images that look the
same regardless of whether \code{en} or \code{en-GB} has been
selected as the language. The source code for the documentation is
in the \metafilefmt{src/doc/}{lang}{/} (for example,
\filefmt{src/doc/en/}).

You will need \filefmt{texjavahelp.sty} on your \TeX\ path. This is
provided by the \TeX\ Java Help system. You will also need the
command line tools provided by the \TeX\ Java Help system.

The \filefmt{version.tex} file needs to be created. For example
\begin{compactcodebox}
\cmd{versiondate}\marg{\thedocversion}\marg{\thedocdate}
\end{compactcodebox}
The accompanying \filefmt{Makefile} does this automatically by
searching the \filefmt{JDRResources.java} file for the relevant
information.

The \metafilefmt{flowframtk-props-}{locale}{.bib} file needs to be
created with \appfmt{tjhxml2bib}. This is a \appfmt{bib2gls} file
that's created from all the applicable dictionary XML files.
For example, \filefmt{flowframtk-props-en-GB.bib} is created using
(no line breaks):
\begin{terminal}
tjhxml2bib  \longargfmt{copy-overwrite-xml} \meta{dictdir}/flowframtk-en.xml \meta{dictdir}/flowframtk-en-GB.xml \meta{dictdir}/jdrcommon-en.xml \meta{dictdir}/jdrcommon-en-GB.xml \shortargfmt{o} flowframtk-props-en-GB.bib
\end{terminal}
where \meta{dictdir} is the path to the XML files.
This will work out the hierarchical structure and entry type based
on the tag attribute for each entry element.

The files \filefmt{flowframtk-en.tex} and
\filefmt{flowframtk-en-GB.tex} correspond to the regionless
English and British English documents. They setup the
locale-specific information and then input
\filefmt{flowframtk-main.tex} which has the rest of the document
preamble and the document environment.

The file \filefmt{helpinterface.tex} is copied over from the \TeX\
Java Help system and is input in \sectionref{sec:helpwindows}.
It's shared by other applications that use the \TeX\ Java Help
library.

The document build requires \LuaLaTeX, \BibTeX, and Bib2Gls.
If you have Arara installed, there are Arara directives at the
start, so you can simply do, for example:
\begin{terminal}
arara flowframtk-en.tex
\end{terminal}
Otherwise you will need to run the following:
\begin{terminal}
lualatex flowframtk-en
bib2gls --group --no-warn-unknown-entry-types flowframtk-en
bibtex flowframtk-en
lualatex flowframtk-en
lualatex flowframtk-en
\end{terminal}
(You may need to repeat some steps on the very first run to ensure
everything is up-to-date.) Don't delete any of the temporary files
created in this step as they are needed in the next step.

The HTML and XML files used by the helpset are created from the
\LaTeX\ document source and the temporary files created during the
document build. Each sectional unit in the document source should be
followed by a label. For example:
\begin{compactcodebox}
\cmd{section}\marg{Document Source}\cmd{label}\marg{sec:docsource}
\end{compactcodebox}
The label may be referenced in the Java code for context-sensitive
help, such as \dgls{help} buttons in dialogs. The
\filefmt{navigation.xml} file has the mappings from each label
to the corresponding HTML file. The basename for the HTML file
is derived from the label. Any leading \qtt{sec:} is stripped
and the remainder is the basename (for example, this section has the
label \code{sec:docsource} so the corresponding HTML is
called \filefmt{docsource.html}).
It's therefore important not to change any labels that are
referenced in the Java code and the label should be appropriate 
as a filename.

These HTML and XML files are created with \appfmt{texjavahelpmk},
a command line tool provided with \TeX\ Java Help. For example:
\begin{terminal}
texjavahelpmk flowframtk-en.tex \meta{targetdir}/flowframtk/en
\end{terminal}
where \meta{targetdir} is the directory containing the helpsets
(in the \filefmt{resources/helpsets} subdirectory of the
\filefmt{lib} directory).

\begin{information}
The \appfmt{texjavahelpmk} tool can take a while to run.
The \TeX\ Parser Library is not a \TeX\ engine and was originally
designed just to parse fragments or short passages (as it does with
\appfmt{bib2gls}). It's not particularly efficient for large
documents and \appfmt{texjavahelpmk} is additionally creating the
search database while it's creating the HTML content.
\end{information}

\chapter{Troubleshooting}\label{sec:troubleshooting}

\begin{enumerate}
\item My settings aren't remembered.

Check which option is selected in the
\widget{initsettings.title} tab of the
\widget{config.title} dialog. This should be set to
\widget{initsettings.last} if you want the settings
remembered from the last time you quit the application. Also check
the \widget{jdr.on_load} option in the \widget{jdr.title} tab.
If this is set to \widget{jdr.on_load.all} then any settings
stored in an image that you load will override the current settings.

\item Sometimes the canvas doesn't get correctly redrawn after I've
loaded an image from a file.

This is a known bug. Use \accelerator{menu.debug.revalidate} to force a redraw.

\item Sometimes lines don't show up.

If you have a thin line and the magnification is small or you
have low resolution, the line may be too thin to show up on your
display. Try either using a thicker line style or increasing the
magnification.

\item When I try clicking on the canvas to add a new point, nothing
happens.

Make sure that you are actually clicking and not dragging. (Some
touch sensitive mouse pads can mistake a click for a move or drag.)
Make sure that you have selected the correct tool.

\item I tried to select and drag a point, but another point moved.

When you select the new point, make sure it's highlighted before you
try dragging it. The click to select operation is separate to the
drag operation.

\item I tried changing the line/text style but nothing
happened.

Remember to use the \menu{edit.path} and \menu{edit.textarea}
submenus to change the styles for existing objects,
and use \menu{settings.styles} for all subsequent new
objects.

\item I tried to create a package based on the \sty{flowfram}
package, but it didn't define some (or all) of my frames.

Remember to identify each \gls{object} as a flow frame,
a dynamic frame or a static frame. Any \gls{object}
that hasn't been thus identified will not be written to
the sty file.

\item When I exported to a package or class, the \sty{flowfram}
package complained the option \qt{hide} or \qt{hidethis} isn't available.

Upgrade to at least version 1.16 of the \sty{flowfram}
package.

\item When I exported to a package or class, the \sty{flowfram}
package complained that I couldn't use \gls{Shapepar}.

Upgrade to at least version 1.16 of the \sty{flowfram}
package.

\item I got an error that \gls{Shapepar} isn't defined.

Upgrade to the latest version of the \sty{shapepar} package.

\item I get an error when I try to \LaTeX\ a \env{pgfpicture} environment created by \FlowframTk.

Remember to include the \sty{pgf} package. \FlowframTk\ was
tested using version 3.0 of the \sty{pgf} package.
It may not work with earlier versions.

\end{enumerate}

\section{Known Bugs}\label{sec:knownbugs}

If for some reason you are unable to access the save dialog box, you
can do an emergency save by pressing
\accelerator{menu.debug.dumpall}. This will save all
currently open images to a subdirectory in the
\gls{config_dir} (This works for most, but not all windows used by \FlowframTk.)

\begin{enumerate}
\item Occasionally bits of the screen don't get repainted.
Use \accelerator{menu.debug.revalidate} to force a redraw.

\item Occasionally the message window doesn't automatically close
when there are no new warning messages.

\item Occasionally the \code{java.awt.*} or \code{javax.swing.*}
classes throw a NullPointerException.

\end{enumerate}

\chapter{\MFUsentencecase{\glsentrytext{index.licence}}}
\label{sec:licence}

\glsadd{index.licence}%
\FlowframTk\ is licensed under the terms of the 
\href{https://www.gnu.org/licenses/gpl-3.0.html}{GNU General
Public License version 3 (GPLv3)}.
\FlowframTk\ depends on the following third party library whose
jar file is in the \filefmt{lib} directory:
\begin{itemize}
   \item TeX Java Help \filefmt{texjavahelplib.jar}
   (GPL, \url{https://github.com/nlct/texjavahelp}).
\end{itemize}

\bibliographystyle{plain}
\bibliography{flowframtkrefs}

\listentrydescendents
 [title={Summary of \apptext{flowframtk} Switches}]
 {app.flowframtk}

\printmain
\printindex 

\end{document} 

